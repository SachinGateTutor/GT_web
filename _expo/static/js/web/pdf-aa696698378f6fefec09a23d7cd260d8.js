__d(function(global,require,_$$_IMPORT_DEFAULT,_$$_IMPORT_ALL,module,exports,_dependencyMap){var _classPrivateFieldLooseBase=require(_dependencyMap[0]),_classPrivateFieldLooseKey=require(_dependencyMap[1]),root,factory;
/**
   * @licstart The following is the entire license notice for the
   * JavaScript code in this page
   *
   * Copyright 2022 Mozilla Foundation
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   * @licend The above is the entire license notice for the
   * JavaScript code in this page
   */
root=globalThis,factory=()=>(()=>{"use strict";var __webpack_modules__=[,(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VerbosityLevel=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.UNSUPPORTED_FEATURES=t.TextRenderingMode=t.StreamType=t.RenderingIntentFlag=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.PageActionEventType=t.OPS=t.MissingPDFException=t.LINE_FACTOR=t.LINE_DESCENT_FACTOR=t.InvalidPDFException=t.ImageKind=t.IDENTITY_MATRIX=t.FormatError=t.FontType=t.FeatureTest=t.FONT_IDENTITY_MATRIX=t.DocumentActionEventType=t.CMapCompressionType=t.BaseException=t.AnnotationType=t.AnnotationStateModelType=t.AnnotationReviewState=t.AnnotationReplyType=t.AnnotationMode=t.AnnotationMarkedState=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationEditorType=t.AnnotationEditorPrefix=t.AnnotationEditorParamsType=t.AnnotationBorderStyleType=t.AnnotationActionEventType=t.AbortException=void 0,t.arrayByteLength=h,t.arraysToBytes=function(e){const t=e.length;if(1===t&&e[0]instanceof Uint8Array)return e[0];let s=0;for(let i=0;i<t;i++)s+=h(e[i]);let i=0;const a=new Uint8Array(s);for(let s=0;s<t;s++){let t=e[s];t instanceof Uint8Array||(t="string"==typeof t?d(t):new Uint8Array(t));const r=t.byteLength;a.set(t,i),i+=r}return a},t.assert=function(e,t){e||n(t)},t.bytesToString=function(e){"object"==typeof e&&null!==e&&void 0!==e.length||n("Invalid argument for bytesToString");const t=e.length,s=8192;if(t<s)return String.fromCharCode.apply(null,e);const i=[];for(let a=0;a<t;a+=s){const r=Math.min(a+s,t),n=e.subarray(a,r);i.push(String.fromCharCode.apply(null,n))}return i.join("")},t.createPromiseCapability=function(){const e=Object.create(null);let t=!1;return Object.defineProperty(e,"settled",{get:()=>t}),e.promise=new Promise(function(s,i){e.resolve=function(e){t=!0,s(e)},e.reject=function(e){t=!0,i(e)}}),e},t.createValidAbsoluteUrl=function(e,t=null,s=null){if(!e)return null;try{if(s&&"string"==typeof e){if(s.addDefaultProtocol&&e.startsWith("www.")){const t=e.match(/\./g);t&&t.length>=2&&(e=`http://${e}`)}if(s.tryConvertEncoding)try{e=_(e)}catch(e){}}const i=t?new URL(e,t):new URL(e);if(o(i))return i}catch(e){}return null},t.escapeString=function(e){return e.replace(/([()\\\n\r])/g,e=>"\n"===e?"\\n":"\r"===e?"\\r":`\\${e}`)},t.getModificationDate=function(e=new Date){return[e.getUTCFullYear().toString(),(e.getUTCMonth()+1).toString().padStart(2,"0"),e.getUTCDate().toString().padStart(2,"0"),e.getUTCHours().toString().padStart(2,"0"),e.getUTCMinutes().toString().padStart(2,"0"),e.getUTCSeconds().toString().padStart(2,"0")].join("")},t.getVerbosityLevel=function(){return a},t.info=function(e){a>=i.INFOS&&console.log(`Info: ${e}`)},t.isArrayBuffer=function(e){return"object"==typeof e&&null!==e&&void 0!==e.byteLength},t.isArrayEqual=function(e,t){if(e.length!==t.length)return!1;for(let s=0,i=e.length;s<i;s++)if(e[s]!==t[s])return!1;return!0},t.isAscii=function(e){return/^[\x00-\x7F]*$/.test(e)},t.objectFromMap=function(e){const t=Object.create(null);for(const[s,i]of e)t[s]=i;return t},t.objectSize=function(e){return Object.keys(e).length},t.setVerbosityLevel=function(e){Number.isInteger(e)&&(a=e)},t.shadow=l,t.string32=function(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)},t.stringToBytes=d,t.stringToPDFString=function(e){if(e[0]>="\xef"){let t;if("\xfe"===e[0]&&"\xff"===e[1]?t="utf-16be":"\xff"===e[0]&&"\xfe"===e[1]?t="utf-16le":"\xef"===e[0]&&"\xbb"===e[1]&&"\xbf"===e[2]&&(t="utf-8"),t)try{const s=new TextDecoder(t,{fatal:!0}),i=d(e);return s.decode(i)}catch(e){r(`stringToPDFString: "${e}".`)}}const t=[];for(let s=0,i=e.length;s<i;s++){const i=m[e.charCodeAt(s)];t.push(i?String.fromCharCode(i):e.charAt(s))}return t.join("")},t.stringToUTF16BEString=function(e){const t=["\xfe\xff"];for(let s=0,i=e.length;s<i;s++){const i=e.charCodeAt(s);t.push(String.fromCharCode(i>>8&255),String.fromCharCode(255&i))}return t.join("")},t.stringToUTF8String=_,t.unreachable=n,t.utf8StringToString=function(e){return unescape(encodeURIComponent(e))},t.warn=r,s(2),t.IDENTITY_MATRIX=[1,0,0,1,0,0],t.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],t.LINE_FACTOR=1.35,t.LINE_DESCENT_FACTOR=.35,t.RenderingIntentFlag={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},t.AnnotationMode={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},t.AnnotationEditorPrefix="pdfjs_internal_editor_",t.AnnotationEditorType={DISABLE:-1,NONE:0,FREETEXT:3,INK:15},t.AnnotationEditorParamsType={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13},t.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},t.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},t.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},t.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},t.AnnotationStateModelType={MARKED:"Marked",REVIEW:"Review"},t.AnnotationMarkedState={MARKED:"Marked",UNMARKED:"Unmarked"},t.AnnotationReviewState={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"},t.AnnotationReplyType={GROUP:"Group",REPLY:"R"},t.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},t.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},t.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},t.AnnotationActionEventType={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"},t.DocumentActionEventType={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"},t.PageActionEventType={O:"PageOpen",C:"PageClose"},t.StreamType={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"},t.FontType={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};const i={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=i,t.CMapCompressionType={NONE:0,BINARY:1,STREAM:2},t.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},t.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"},t.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let a=i.WARNINGS;function r(e){a>=i.WARNINGS&&console.log(`Warning: ${e}`)}function n(e){throw new Error(e)}function o(e){if(!e)return!1;switch(e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function l(e,t,s){return Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!1}),s}const c=(function(){function e(t,s){this.constructor===e&&n("Cannot initialize BaseException."),this.message=t,this.name=s}return e.prototype=new Error,e.constructor=e,e})();function d(e){"string"!=typeof e&&n("Invalid argument for stringToBytes");const t=e.length,s=new Uint8Array(t);for(let i=0;i<t;++i)s[i]=255&e.charCodeAt(i);return s}function h(e){return void 0!==e.length?e.length:void 0!==e.byteLength?e.byteLength:void n("Invalid argument for arrayByteLength")}function u(){const e=new Uint8Array(4);return e[0]=1,1===new Uint32Array(e.buffer,0,1)[0]}function p(){try{return new Function(""),!0}catch(e){return!1}}t.BaseException=c,t.PasswordException=class extends c{constructor(e,t){super(e,"PasswordException"),this.code=t}},t.UnknownErrorException=class extends c{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}},t.InvalidPDFException=class extends c{constructor(e){super(e,"InvalidPDFException")}},t.MissingPDFException=class extends c{constructor(e){super(e,"MissingPDFException")}},t.UnexpectedResponseException=class extends c{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}},t.FormatError=class extends c{constructor(e){super(e,"FormatError")}},t.AbortException=class extends c{constructor(e){super(e,"AbortException")}},t.FeatureTest=class{static get isLittleEndian(){return l(this,"isLittleEndian",u())}static get isEvalSupported(){return l(this,"isEvalSupported",p())}static get isOffscreenCanvasSupported(){return l(this,"isOffscreenCanvasSupported","undefined"!=typeof OffscreenCanvas)}};const g=[...Array(256).keys()].map(e=>e.toString(16).padStart(2,"0"));class f{static makeHexColor(e,t,s){return`#${g[e]}${g[t]}${g[s]}`}static scaleMinMax(e,t){let s;e[0]?(e[0]<0&&(s=t[0],t[0]=t[1],t[1]=s),t[0]*=e[0],t[1]*=e[0],e[3]<0&&(s=t[2],t[2]=t[3],t[3]=s),t[2]*=e[3],t[3]*=e[3]):(s=t[0],t[0]=t[2],t[2]=s,s=t[1],t[1]=t[3],t[3]=s,e[1]<0&&(s=t[2],t[2]=t[3],t[3]=s),t[2]*=e[1],t[3]*=e[1],e[2]<0&&(s=t[0],t[0]=t[1],t[1]=s),t[0]*=e[2],t[1]*=e[2]),t[0]+=e[4],t[1]+=e[4],t[2]+=e[5],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]}static applyInverseTransform(e,t){const s=t[0]*t[3]-t[1]*t[2];return[(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/s,(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/s]}static getAxialAlignedBoundingBox(e,t){const s=f.applyTransform(e,t),i=f.applyTransform(e.slice(2,4),t),a=f.applyTransform([e[0],e[3]],t),r=f.applyTransform([e[2],e[1]],t);return[Math.min(s[0],i[0],a[0],r[0]),Math.min(s[1],i[1],a[1],r[1]),Math.max(s[0],i[0],a[0],r[0]),Math.max(s[1],i[1],a[1],r[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static apply3dTransform(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2],e[3]*t[0]+e[4]*t[1]+e[5]*t[2],e[6]*t[0]+e[7]*t[1]+e[8]*t[2]]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],s=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],a=e[2]*t[0]+e[3]*t[2],r=e[2]*t[1]+e[3]*t[3],n=(s+r)/2,o=Math.sqrt((s+r)**2-4*(s*r-a*i))/2,l=n+o||1,c=n-o||1;return[Math.sqrt(l),Math.sqrt(c)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const s=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(s>i)return null;const a=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),r=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return a>r?null:[s,a,i,r]}static bezierBoundingBox(e,t,s,i,a,r,n,o){const l=[],c=[[],[]];let d,h,u,p,g,f,m,_;for(let c=0;c<2;++c)if(0===c?(h=6*e-12*s+6*a,d=-3*e+9*s-9*a+3*n,u=3*s-3*e):(h=6*t-12*i+6*r,d=-3*t+9*i-9*r+3*o,u=3*i-3*t),Math.abs(d)<1e-12){if(Math.abs(h)<1e-12)continue;p=-u/h,0<p&&p<1&&l.push(p)}else m=h*h-4*u*d,_=Math.sqrt(m),m<0||(g=(-h+_)/(2*d),0<g&&g<1&&l.push(g),f=(-h-_)/(2*d),0<f&&f<1&&l.push(f));let v,b=l.length;const y=b;for(;b--;)p=l[b],v=1-p,c[0][b]=v*v*v*e+3*v*v*p*s+3*v*p*p*a+p*p*p*n,c[1][b]=v*v*v*t+3*v*v*p*i+3*v*p*p*r+p*p*p*o;return c[0][y]=e,c[1][y]=t,c[0][y+1]=n,c[1][y+1]=o,c[0].length=c[1].length=y+2,[Math.min(...c[0]),Math.min(...c[1]),Math.max(...c[0]),Math.max(...c[1])]}}t.Util=f;const m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function _(e){return decodeURIComponent(escape(e))}},(e,t,s)=>{s(3)},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isNodeJS=void 0;const s=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type);t.isNodeJS=s},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(5),_display_utils=__w_pdfjs_require__(8),_font_loader=__w_pdfjs_require__(11),_canvas=__w_pdfjs_require__(12),_worker_options=__w_pdfjs_require__(15),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(16),_metadata=__w_pdfjs_require__(17),_optional_content_config=__w_pdfjs_require__(18),_transport_stream=__w_pdfjs_require__(19),_xfa_text=__w_pdfjs_require__(20);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory,createPDFNetworkStream;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:e,NodeCMapReaderFactory:t,NodeStandardFontDataFactory:s}=__w_pdfjs_require__(21);exports.DefaultCanvasFactory=DefaultCanvasFactory=e,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=t,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=s}function setPDFNetworkStreamFactory(e){createPDFNetworkStream=e}function getDocument(e){const t=new PDFDocumentLoadingTask;let s;if("string"==typeof e||e instanceof URL)s={url:e};else if((0,_util.isArrayBuffer)(e))s={data:e};else if(e instanceof PDFDataRangeTransport)s={range:e};else{if("object"!=typeof e)throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!e.url&&!e.data&&!e.range)throw new Error("Invalid parameter object: need either .data, .range or .url");s=e}const i=Object.create(null);let a=null,r=null;for(const e in s){const t=s[e];switch(e){case"url":if("undefined"!=typeof window)try{i[e]=new URL(t,window.location).href;continue}catch(e){(0,_util.warn)(`Cannot create valid URL: "${e}".`)}else if("string"==typeof t||t instanceof URL){i[e]=t.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":a=t;continue;case"worker":r=t;continue;case"data":if(_is_node.isNodeJS&&"undefined"!=typeof Buffer&&t instanceof Buffer)i[e]=new Uint8Array(t);else{if(t instanceof Uint8Array)break;if("string"==typeof t)i[e]=(0,_util.stringToBytes)(t);else if("object"!=typeof t||null===t||isNaN(t.length)){if(!(0,_util.isArrayBuffer)(t))throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.");i[e]=new Uint8Array(t)}else i[e]=new Uint8Array(t)}continue}i[e]=t}if(i.CMapReaderFactory=i.CMapReaderFactory||DefaultCMapReaderFactory,i.StandardFontDataFactory=i.StandardFontDataFactory||DefaultStandardFontDataFactory,i.ignoreErrors=!0!==i.stopAtErrors,i.fontExtraProperties=!0===i.fontExtraProperties,i.pdfBug=!0===i.pdfBug,i.enableXfa=!0===i.enableXfa,(!Number.isInteger(i.rangeChunkSize)||i.rangeChunkSize<1)&&(i.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),("string"!=typeof i.docBaseUrl||(0,_display_utils.isDataScheme)(i.docBaseUrl))&&(i.docBaseUrl=null),(!Number.isInteger(i.maxImageSize)||i.maxImageSize<-1)&&(i.maxImageSize=-1),"string"!=typeof i.cMapUrl&&(i.cMapUrl=null),"string"!=typeof i.standardFontDataUrl&&(i.standardFontDataUrl=null),"boolean"!=typeof i.useWorkerFetch&&(i.useWorkerFetch=i.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&i.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),"boolean"!=typeof i.isEvalSupported&&(i.isEvalSupported=!0),"boolean"!=typeof i.disableFontFace&&(i.disableFontFace=_is_node.isNodeJS),"boolean"!=typeof i.useSystemFonts&&(i.useSystemFonts=!_is_node.isNodeJS&&!i.disableFontFace),"object"==typeof i.ownerDocument&&null!==i.ownerDocument||(i.ownerDocument=globalThis.document),"boolean"!=typeof i.disableRange&&(i.disableRange=!1),"boolean"!=typeof i.disableStream&&(i.disableStream=!1),"boolean"!=typeof i.disableAutoFetch&&(i.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(i.verbosity),!r){const e={verbosity:i.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};r=e.port?PDFWorker.fromPort(e):new PDFWorker(e),t._worker=r}const n=t.docId;return r.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");const e=_fetchDocument(r,i,a,n),s=new Promise(function(e){let t;a?t=new _transport_stream.PDFDataTransportStream({length:i.length,initialData:i.initialData,progressiveDone:i.progressiveDone,contentDispositionFilename:i.contentDispositionFilename,disableRange:i.disableRange,disableStream:i.disableStream},a):i.data||(t=createPDFNetworkStream({url:i.url,length:i.length,httpHeaders:i.httpHeaders,withCredentials:i.withCredentials,rangeChunkSize:i.rangeChunkSize,disableRange:i.disableRange,disableStream:i.disableStream})),e(t)});return Promise.all([e,s]).then(function([e,s]){if(t.destroyed)throw new Error("Loading aborted");const a=new _message_handler.MessageHandler(n,e,r.port),o=new WorkerTransport(a,t,s,i);t._transport=o,a.send("Ready",null)})}).catch(t._capability.reject),t}async function _fetchDocument(e,t,s,i){if(e.destroyed)throw new Error("Worker was destroyed");s&&(t.length=s.length,t.initialData=s.initialData,t.progressiveDone=s.progressiveDone,t.contentDispositionFilename=s.contentDispositionFilename);const a=await e.messageHandler.sendWithPromise("GetDocRequest",{docId:i,apiVersion:'2.16.105',source:{data:t.data,url:t.url,password:t.password,disableAutoFetch:t.disableAutoFetch,rangeChunkSize:t.rangeChunkSize,length:t.length},maxImageSize:t.maxImageSize,disableFontFace:t.disableFontFace,docBaseUrl:t.docBaseUrl,ignoreErrors:t.ignoreErrors,isEvalSupported:t.isEvalSupported,fontExtraProperties:t.fontExtraProperties,enableXfa:t.enableXfa,useSystemFonts:t.useSystemFonts,cMapUrl:t.useWorkerFetch?t.cMapUrl:null,standardFontDataUrl:t.useWorkerFetch?t.standardFontDataUrl:null});if(t.data&&(t.data=null),e.destroyed)throw new Error("Worker was destroyed");return a}class PDFDocumentLoadingTask{static#e=0;constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+PDFDocumentLoadingTask.#e++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0,await(this._transport?.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(e,t,s=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=s,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const s of this._rangeListeners)s(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const s of this._progressListeners)s(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,t){this._pdfInfo=e,this._transport=t,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:async()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),this.stats||{streamTypes:{},fontTypes:{}})})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get stats(){return this._transport.stats}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(e,t,s,i,a=!1){this._pageIndex=e,this._pageInfo=t,this._ownerDocument=i,this._transport=s,this._stats=a?new _display_utils.StatTimer:null,this._pdfBug=a,this.commonObjs=s.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:s=0,offsetY:i=0,dontFlip:a=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:a})}getAnnotations({intent:e="display"}={}){const t=this._transport.getRenderingIntent(e);let s=this._annotationPromises.get(t.cacheKey);return s||(s=this._transport.getAnnotations(this._pageIndex,t.renderingIntent),this._annotationPromises.set(t.cacheKey,s),s=s.then(e=>{for(const t of e)void 0!==t.titleObj&&Object.defineProperty(t,"title",{get:()=>((0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),t.titleObj.str)}),void 0!==t.contentsObj&&Object.defineProperty(t,"contents",{get:()=>((0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),t.contentsObj.str)});return e})),s}getJSActions(){return this._jsActionsPromise||=this._transport.getPageJSActions(this._pageIndex)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:s="display",annotationMode:i=_util.AnnotationMode.ENABLE,transform:a=null,imageLayer:r=null,canvasFactory:n=null,background:o=null,optionalContentConfigPromise:l=null,annotationCanvasMap:c=null,pageColors:d=null,printAnnotationStorage:h=null}){void 0!==arguments[0]?.renderInteractiveForms&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),!0===arguments[0].renderInteractiveForms&&i===_util.AnnotationMode.ENABLE&&(i=_util.AnnotationMode.ENABLE_FORMS)),void 0!==arguments[0]?.includeAnnotationStorage&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),!0===arguments[0].includeAnnotationStorage&&i===_util.AnnotationMode.ENABLE&&(i=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const u=this._transport.getRenderingIntent(s,i,h);this.pendingCleanup=!1,l||(l=this._transport.getOptionalContentConfig());let p=this._intentStates.get(u.cacheKey);p||(p=Object.create(null),this._intentStates.set(u.cacheKey,p)),p.streamReaderCancelTimeout&&(clearTimeout(p.streamReaderCancelTimeout),p.streamReaderCancelTimeout=null);const g=n||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),f=!!(u.renderingIntent&_util.RenderingIntentFlag.PRINT);p.displayReadyCapability||(p.displayReadyCapability=(0,_util.createPromiseCapability)(),p.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(u));const m=e=>{p.renderTasks.delete(_),(this.cleanupAfterRender||f)&&(this.pendingCleanup=!0),this._tryCleanup(),e?(_.capability.reject(e),this._abortOperatorList({intentState:p,reason:e instanceof Error?e:new Error(e)})):_.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},_=new InternalRenderTask({callback:m,params:{canvasContext:e,viewport:t,transform:a,imageLayer:r,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:p.operatorList,pageIndex:this._pageIndex,canvasFactory:g,useRequestAnimationFrame:!f,pdfBug:this._pdfBug,pageColors:d});(p.renderTasks||=new Set).add(_);const v=_.task;return Promise.all([p.displayReadyCapability.promise,l]).then(([e,t])=>{this.pendingCleanup?m():(this._stats&&this._stats.time("Rendering"),_.initializeGraphics({transparency:e,optionalContentConfig:t}),_.operatorListChanged())}).catch(m),v}getOperatorList({intent:e="display",annotationMode:t=_util.AnnotationMode.ENABLE,printAnnotationStorage:s=null}={}){const i=this._transport.getRenderingIntent(e,t,s,!0);let a,r=this._intentStates.get(i.cacheKey);return r||(r=Object.create(null),this._intentStates.set(i.cacheKey,r)),r.opListReadCapability||(a=Object.create(null),a.operatorListChanged=function(){r.operatorList.lastChunk&&(r.opListReadCapability.resolve(r.operatorList),r.renderTasks.delete(a))},r.opListReadCapability=(0,_util.createPromiseCapability)(),(r.renderTasks||=new Set).add(a),r.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(i)),r.opListReadCapability.promise}streamTextContent({disableCombineTextItems:e=!1,includeMarkedContent:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:!0!==e,includeMarkedContent:!0===t},{highWaterMark:100,size:e=>e.items.length})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(e=>_xfa_text.XfaText.textContent(e));const t=this.streamTextContent(e);return new Promise(function(e,s){const i=t.getReader(),a={items:[],styles:Object.create(null)};!(function t(){i.read().then(function({value:s,done:i}){i?e(a):(Object.assign(a.styles,s.styles),a.items.push(...s.items),t())},s)})()})}getStructTree(){return this._structTreePromise||=this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const s of t.renderTasks)e.push(s.completed),s.cancel();this.objs.clear();for(const e of this._bitmaps)e.close();return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(e)}cleanup(e=!1){return this.pendingCleanup=!0,this._tryCleanup(e)}_tryCleanup(e=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,e&&this._stats&&(this._stats=new _display_utils.StatTimer);for(const e of this._bitmaps)e.close();return this._bitmaps.clear(),this.pendingCleanup=!1,!0}_startRenderPage(e,t){const s=this._intentStates.get(t);s&&(this._stats&&this._stats.timeEnd("Page Request"),s.displayReadyCapability&&s.displayReadyCapability.resolve(e))}_renderPageChunk(e,t){for(let s=0,i=e.length;s<i;s++)t.operatorList.fnArray.push(e.fnArray[s]),t.operatorList.argsArray.push(e.argsArray[s]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const e of t.renderTasks)e.operatorListChanged();e.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageMap:s}){const i=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:s}).getReader(),a=this._intentStates.get(t);a.streamReader=i;const r=()=>{i.read().then(({value:e,done:t})=>{t?a.streamReader=null:this._transport.destroyed||(this._renderPageChunk(e,a),r())},e=>{if(a.streamReader=null,!this._transport.destroyed){if(a.operatorList){a.operatorList.lastChunk=!0;for(const e of a.renderTasks)e.operatorListChanged();this._tryCleanup()}if(a.displayReadyCapability)a.displayReadyCapability.reject(e);else{if(!a.opListReadCapability)throw e;a.opListReadCapability.reject(e)}}})};r()}_abortOperatorList({intentState:e,reason:t,force:s=!1}){if(e.streamReader){if(!s){if(e.renderTasks.size>0)return;if(t instanceof _display_utils.RenderingCancelledException)return void(e.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:e,reason:t,force:!0}),e.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT))}if(e.streamReader.cancel(new _util.AbortException(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[t,s]of this._intentStates)if(s===e){this._intentStates.delete(t);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve()}postMessage(e,t){const s={data:structuredClone(e,t)};this._deferred.then(()=>{for(const e of this._listeners)e.call(this,s)})}addEventListener(e,t){this._listeners.push(t)}removeEventListener(e,t){const s=this._listeners.indexOf(t);this._listeners.splice(s,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};if(exports.PDFWorkerUtil=PDFWorkerUtil,_is_node.isNodeJS&&"function"==typeof require)PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if("object"==typeof document){const e=document?.currentScript?.src;e&&(PDFWorkerUtil.fallbackWorkerSrc=e.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(e,t){let s;try{if(s=new URL(e),!s.origin||"null"===s.origin)return!1}catch(e){return!1}const i=new URL(t,s);return s.origin===i.origin},PDFWorkerUtil.createCDNWrapper=function(e){const t=`importScripts("${e}");`;return URL.createObjectURL(new Blob([t]))};class PDFWorker{static#t=new WeakMap;constructor({name:e=null,port:t=null,verbosity:s=(0,_util.getVerbosityLevel)()}={}){if(t&&PDFWorker.#t.has(t))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=e,this.destroyed=!1,this.verbosity=s,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,t)return PDFWorker.#t.set(t,this),void this._initializeFromPort(t);this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new _message_handler.MessageHandler("main","worker",e),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:e}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,e)||(e=PDFWorkerUtil.createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e),s=new _message_handler.MessageHandler("main","worker",t),i=()=>{t.removeEventListener("error",a),s.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},a=()=>{this._webWorker||i()};t.addEventListener("error",a),s.on("test",e=>{t.removeEventListener("error",a),this.destroyed?i():e?(this._messageHandler=s,this._port=t,this._webWorker=t,this._readyCapability.resolve(),s.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),s.destroy(),t.terminate())}),s.on("ready",e=>{if(t.removeEventListener("error",a),this.destroyed)i();else try{r()}catch(e){this._setupFakeWorker()}});const r=()=>{const e=new Uint8Array;s.send("test",e,[e.buffer])};return void r()}catch(e){(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(e=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const t=new LoopbackPort;this._port=t;const s="fake"+PDFWorkerUtil.fakeWorkerId++,i=new _message_handler.MessageHandler(s+"_worker",s,t);e.setup(i,t);const a=new _message_handler.MessageHandler(s,s+"_worker",t);this._messageHandler=a,this._readyCapability.resolve(),a.send("configure",{verbosity:this.verbosity})}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#t.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.#t.has(e.port)?this.#t.get(e.port):new PDFWorker(e)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(null!==PDFWorkerUtil.fallbackWorkerSrc)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch(e){return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&"function"==typeof require){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{#s=null;#i=new Map;#a=new Map;#r=null;constructor(e,t,s,i){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:t.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this._params=i,i.useWorkerFetch||(this.CMapReaderFactory=new i.CMapReaderFactory({baseUrl:i.cMapUrl,isCompressed:i.cMapPacked}),this.StandardFontDataFactory=new i.StandardFontDataFactory({baseUrl:i.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=s,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get stats(){return this.#s}getRenderingIntent(e,t=_util.AnnotationMode.ENABLE,s=null,i=!1){let a=_util.RenderingIntentFlag.DISPLAY,r=null;switch(e){case"any":a=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":a=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${e}`)}switch(t){case _util.AnnotationMode.DISABLE:a+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:a+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:a+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,r=(a&_util.RenderingIntentFlag.PRINT&&s instanceof _annotation_storage.PrintAnnotationStorage?s:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${t}`)}return i&&(a+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:a,cacheKey:`${a}_${_annotation_storage.AnnotationStorage.getHash(r)}`,annotationStorageMap:r}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const t of this.#i.values())e.push(t._destroy());this.#i.clear(),this.#a.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#r=null,this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(e,t)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=e=>{this._lastProgress={loaded:e.loaded,total:e.total}},t.onPull=()=>{this._fullReader.read().then(function({value:e,done:s}){s?t.close():((0,_util.assert)((0,_util.isArrayBuffer)(e),"GetReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(e),1,[e]))}).catch(e=>{t.error(e)})},t.onCancel=e=>{this._fullReader.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}}),e.on("ReaderHeadersReady",e=>{const s=(0,_util.createPromiseCapability)(),i=this._fullReader;return i.headersReady.then(()=>{i.isStreamingSupported&&i.isRangeSupported||(this._lastProgress&&t.onProgress?.(this._lastProgress),i.onProgress=e=>{t.onProgress?.({loaded:e.loaded,total:e.total})}),s.resolve({isStreamingSupported:i.isStreamingSupported,isRangeSupported:i.isRangeSupported,contentLength:i.contentLength})},s.reject),s.promise}),e.on("GetRangeReader",(e,t)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const s=this._networkStream.getRangeReader(e.begin,e.end);s?(t.onPull=()=>{s.read().then(function({value:e,done:s}){s?t.close():((0,_util.assert)((0,_util.isArrayBuffer)(e),"GetRangeReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(e),1,[e]))}).catch(e=>{t.error(e)})},t.onCancel=e=>{s.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}):t.close()}),e.on("GetDoc",({pdfInfo:e})=>{this._numPages=e.numPages,this._htmlForXfa=e.htmlForXfa,delete e.htmlForXfa,t._capability.resolve(new PDFDocumentProxy(e,this))}),e.on("DocException",function(e){let s;switch(e.name){case"PasswordException":s=new _util.PasswordException(e.message,e.code);break;case"InvalidPDFException":s=new _util.InvalidPDFException(e.message);break;case"MissingPDFException":s=new _util.MissingPDFException(e.message);break;case"UnexpectedResponseException":s=new _util.UnexpectedResponseException(e.message,e.status);break;case"UnknownErrorException":s=new _util.UnknownErrorException(e.message,e.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}t._capability.reject(s)}),e.on("PasswordRequest",e=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),t.onPassword){const s=e=>{e instanceof Error?this._passwordCapability.reject(e):this._passwordCapability.resolve({password:e})};try{t.onPassword(s,e.code)}catch(e){this._passwordCapability.reject(e)}}else this._passwordCapability.reject(new _util.PasswordException(e.message,e.code));return this._passwordCapability.promise}),e.on("DataLoaded",e=>{t.onProgress?.({loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)}),e.on("StartRenderPage",e=>{this.destroyed||this.#i.get(e.pageIndex)._startRenderPage(e.transparency,e.cacheKey)}),e.on("commonobj",([t,s,i])=>{if(!this.destroyed&&!this.commonObjs.has(t))switch(s){case"Font":const a=this._params;if("error"in i){const e=i.error;(0,_util.warn)(`Error during font loading: ${e}`),this.commonObjs.resolve(t,e);break}let r=null;a.pdfBug&&globalThis.FontInspector?.enabled&&(r={registerFont(e,t){globalThis.FontInspector.fontAdded(e,t)}});const n=new _font_loader.FontFaceObject(i,{isEvalSupported:a.isEvalSupported,disableFontFace:a.disableFontFace,ignoreErrors:a.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:r});this.fontLoader.bind(n).catch(s=>e.sendWithPromise("FontFallback",{id:t})).finally(()=>{!a.fontExtraProperties&&n.data&&(n.data=null),this.commonObjs.resolve(t,n)});break;case"FontPath":case"Image":this.commonObjs.resolve(t,i);break;default:throw new Error(`Got unknown common object type ${s}`)}}),e.on("obj",([e,t,s,i])=>{if(this.destroyed)return;const a=this.#i.get(t);if(!a.objs.has(e))switch(s){case"Image":a.objs.resolve(e,i);const t=8e6;if(i){let e;if(i.bitmap){const{bitmap:t,width:s,height:r}=i;e=s*r*4,a._bitmaps.add(t)}else e=i.data?.length||0;e>t&&(a.cleanupAfterRender=!0)}break;case"Pattern":a.objs.resolve(e,i);break;default:throw new Error(`Got unknown object type ${s}`)}}),e.on("DocProgress",e=>{this.destroyed||t.onProgress?.({loaded:e.loaded,total:e.total})}),e.on("DocStats",e=>{this.destroyed||(this.#s=Object.freeze({streamTypes:Object.freeze(e.streamTypes),fontTypes:Object.freeze(e.fontTypes)}))}),e.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),e.on("FetchBuiltInCMap",e=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(e):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",e=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(e):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:e}){this.destroyed||this.loadingTask.onUnsupportedFeature?.(e)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,s=this.#a.get(t);if(s)return s;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(e=>{if(this.destroyed)throw new Error("Transport destroyed");const s=new PDFPageProxy(t,e,this,this._params.ownerDocument,this._params.pdfBug);return this.#i.set(t,s),s});return this.#a.set(t,i),i}getPageIndex(e){return"object"!=typeof e||null===e||!Number.isInteger(e.num)||e.num<0||!Number.isInteger(e.gen)||e.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen})}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}saveDocument(){return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:this._fullReader?.filename??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||=this.messageHandler.sendWithPromise("GetFieldObjects",null)}hasJSActions(){return this._hasJSActionsPromise||=this.messageHandler.sendWithPromise("HasJSActions",null)}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return"string"!=typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(e=>new _optional_content_config.OptionalContentConfig(e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return this.#r||=this.messageHandler.sendWithPromise("GetMetadata",null).then(e=>({info:e[0],metadata:e[1]?new _metadata.Metadata(e[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}))}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(const e of this.#i.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#r=null,this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const e=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e.disableAutoFetch,enableXfa:e.enableXfa})}}var _objs=_classPrivateFieldLooseKey("objs"),_ensureObj=_classPrivateFieldLooseKey("ensureObj");class PDFObjects{constructor(){Object.defineProperty(this,_ensureObj,{value:_ensureObj2}),Object.defineProperty(this,_objs,{writable:!0,value:Object.create(null)})}get(e,t=null){if(t){const s=_classPrivateFieldLooseBase(this,_ensureObj)[_ensureObj](e);return s.capability.promise.then(()=>t(s.data)),null}const s=_classPrivateFieldLooseBase(this,_objs)[_objs][e];if(!s?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return s.data}has(e){const t=_classPrivateFieldLooseBase(this,_objs)[_objs][e];return t?.capability.settled||!1}resolve(e,t=null){const s=_classPrivateFieldLooseBase(this,_ensureObj)[_ensureObj](e);s.data=t,s.capability.resolve()}clear(){_classPrivateFieldLooseBase(this,_objs)[_objs]=Object.create(null)}}function _ensureObj2(e){const t=_classPrivateFieldLooseBase(this,_objs)[_objs][e];return t||(_classPrivateFieldLooseBase(this,_objs)[_objs][e]={capability:(0,_util.createPromiseCapability)(),data:null})}class RenderTask{#n=null;constructor(e){this.#n=e,this.onContinue=null}get promise(){return this.#n.capability.promise}cancel(){this.#n.cancel()}get separateAnnots(){const{separateAnnots:e}=this.#n.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#n;return e.form||e.canvas&&t?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#o=new WeakSet;constructor({callback:e,params:t,objs:s,commonObjs:i,annotationCanvasMap:a,operatorList:r,pageIndex:n,canvasFactory:o,useRequestAnimationFrame:l=!1,pdfBug:c=!1,pageColors:d=null}){this.callback=e,this.params=t,this.objs=s,this.commonObjs=i,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=r,this._pageIndex=n,this.canvasFactory=o,this._pdfBug=c,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===l&&"undefined"!=typeof window,this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#o.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#o.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:s,viewport:i,transform:a,imageLayer:r,background:n}=this.params;this.gfx=new _canvas.CanvasGraphics(s,this.commonObjs,this.objs,this.canvasFactory,r,t,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:a,viewport:i,transparency:e,background:n}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(e=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&InternalRenderTask.#o.delete(this._canvas),this.callback(e||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&InternalRenderTask.#o.delete(this._canvas),this.callback())))}}const version='2.16.105';exports.version=version;const build='172ccdbe5';exports.build=build},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PrintAnnotationStorage=t.AnnotationStorage=void 0;var i=s(1),a=s(6),r=s(10),n=_classPrivateFieldLooseKey("setModified");class o{constructor(){Object.defineProperty(this,n,{value:l}),this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const s=this._storage.get(e);return void 0===s?t:Object.assign(t,s)}getRawValue(e){return this._storage.get(e)}remove(e){if(this._storage.delete(e),0===this._storage.size&&this.resetModified(),"function"==typeof this.onAnnotationEditor){for(const e of this._storage.values())if(e instanceof a.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(e,t){const s=this._storage.get(e);let i=!1;if(void 0!==s)for(const[e,a]of Object.entries(t))s[e]!==a&&(i=!0,s[e]=a);else i=!0,this._storage.set(e,t);i&&_classPrivateFieldLooseBase(this,n)[n](),t instanceof a.AnnotationEditor&&"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(t.constructor._type)}has(e){return this._storage.has(e)}getAll(){return this._storage.size>0?(0,i.objectFromMap)(this._storage):null}get size(){return this._storage.size}resetModified(){this._modified&&(this._modified=!1,"function"==typeof this.onResetModified&&this.onResetModified())}get print(){return new c(this)}get serializable(){if(0===this._storage.size)return null;const e=new Map;for(const[t,s]of this._storage){const i=s instanceof a.AnnotationEditor?s.serialize():s;i&&e.set(t,i)}return e}static getHash(e){if(!e)return"";const t=new r.MurmurHash3_64;for(const[s,i]of e)t.update(`${s}:${JSON.stringify(i)}`);return t.hexdigest()}}function l(){this._modified||(this._modified=!0,"function"==typeof this.onSetModified&&this.onSetModified())}t.AnnotationStorage=o;class c extends o{#l=null;constructor(e){super(),this.#l=structuredClone(e.serializable)}get print(){(0,i.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#l}}t.PrintAnnotationStorage=c},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditor=void 0;var i=s(7),a=s(1);class r{#c=this.focusin.bind(this);#d=this.focusout.bind(this);#h=!1;#u=!1;#p=!1;#g=r._zIndex++;static _colorManager=new i.ColorManager;static _zIndex=1;constructor(e){this.constructor===r&&(0,a.unreachable)("Cannot initialize AnnotationEditor."),this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null;const[t,s]=this.parent.viewportBaseDimensions;this.x=e.x/t,this.y=e.y/s,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,a.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#g}focusin(e){this.#h?this.#h=!1:this.parent.setSelected(this)}focusout(e){if(!this.isAttachedToDOM)return;const t=e.relatedTarget;t?.closest(`#${this.id}`)||(e.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.parent.addToAnnotationStorage(this)}dragstart(e){const t=this.parent.div.getBoundingClientRect();this.startX=e.clientX-t.x,this.startY=e.clientY-t.y,e.dataTransfer.setData("text/plain",this.id),e.dataTransfer.effectAllowed="move"}setAt(e,t,s,i){const[a,r]=this.parent.viewportBaseDimensions;[s,i]=this.screenToPageTranslation(s,i),this.x=(e+s)/a,this.y=(t+i)/r,this.div.style.left=100*this.x+"%",this.div.style.top=100*this.y+"%"}translate(e,t){const[s,i]=this.parent.viewportBaseDimensions;[e,t]=this.screenToPageTranslation(e,t),this.x+=e/s,this.y+=t/i,this.div.style.left=100*this.x+"%",this.div.style.top=100*this.y+"%"}screenToPageTranslation(e,t){const{rotation:s}=this.parent.viewport;switch(s){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}setDims(e,t){const[s,i]=this.parent.viewportBaseDimensions;this.div.style.width=100*e/s+"%",this.div.style.height=100*t/i+"%"}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#c),this.div.addEventListener("focusout",this.#d);const[e,t]=this.getInitialTranslation();return this.translate(e,t),(0,i.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(e){const t=i.KeyboardManager.platform.isMac;0!==e.button||e.ctrlKey&&t?e.preventDefault():(e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this),this.#h=!0)}getRect(e,t){const[s,i]=this.parent.viewportBaseDimensions,[a,r]=this.parent.pageDimensions,n=a*e/s,o=r*t/i,l=this.x*a,c=this.y*r,d=this.width*a,h=this.height*r;switch(this.rotation){case 0:return[l+n,r-c-o-h,l+n+d,r-c-o];case 90:return[l+o,r-c+n,l+o+h,r-c+n+d];case 180:return[l-n-d,r-c+o,l-n,r-c+o+h];case 270:return[l-o-h,r-c-n-d,l-o,r-c-n];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[s,i,a,r]=e,n=a-s,o=r-i;switch(this.rotation){case 0:return[s,t-r,n,o];case 90:return[s,t-i,o,n];case 180:return[a,t-i,n,o];case 270:return[a,t-r,o,n];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#p=!0}disableEditMode(){this.#p=!1}isInEditMode(){return this.#p}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#c)}serialize(){(0,a.unreachable)("An editor must be serializable")}static deserialize(e,t){const s=new this.prototype.constructor({parent:t,id:t.getNextId()});s.rotation=e.rotation;const[i,a]=t.pageDimensions,[r,n,o,l]=s.getRectInCurrentCoords(e.rect,a);return s.x=r/i,s.y=n/a,s.width=o/i,s.height=l/a,s}remove(){this.div.removeEventListener("focusin",this.#c),this.div.removeEventListener("focusout",this.#d),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){this.div?.classList.add("selectedEditor")}unselect(){this.div?.classList.remove("selectedEditor")}updateParams(e,t){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return this.#u}set isEditing(e){this.#u=e,e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}}t.AnnotationEditor=r},(e,t,s)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardManager=t.CommandManager=t.ColorManager=t.AnnotationEditorUIManager=void 0,t.bindEvents=function(e,t,s){for(const i of s)t.addEventListener(i,e[i].bind(e))},t.opacityToHex=function(e){return Math.round(Math.min(255,Math.max(1,255*e))).toString(16).padStart(2,"0")};var a=s(1),r=s(8);class n{#f=0;getId(){return`${a.AnnotationEditorPrefix}${this.#f++}`}}class o{#m=[];#_=!1;#v;#b=-1;constructor(e=128){this.#v=e}add({cmd:e,undo:t,mustExec:s,type:i=NaN,overwriteIfSameType:a=!1,keepUndo:r=!1}){if(s&&e(),this.#_)return;const n={cmd:e,undo:t,type:i};if(-1===this.#b)return this.#m.length>0&&(this.#m.length=0),this.#b=0,void this.#m.push(n);if(a&&this.#m[this.#b].type===i)return r&&(n.undo=this.#m[this.#b].undo),void(this.#m[this.#b]=n);const o=this.#b+1;o===this.#v?this.#m.splice(0,1):(this.#b=o,o<this.#m.length&&this.#m.splice(o)),this.#m.push(n)}undo(){-1!==this.#b&&(this.#_=!0,this.#m[this.#b].undo(),this.#_=!1,this.#b-=1)}redo(){this.#b<this.#m.length-1&&(this.#b+=1,this.#_=!0,this.#m[this.#b].cmd(),this.#_=!1)}hasSomethingToUndo(){return-1!==this.#b}hasSomethingToRedo(){return this.#b<this.#m.length-1}destroy(){this.#m=null}}t.CommandManager=o;var l=_classPrivateFieldLooseKey("serialize");class c{constructor(e){Object.defineProperty(this,l,{value:d}),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const t=c.platform.isMac;for(const[s,i]of e)for(const e of s){const s=e.startsWith("mac+");t&&s?(this.callbacks.set(e.slice(4),i),this.allKeys.add(e.split("+").at(-1))):t||s||(this.callbacks.set(e,i),this.allKeys.add(e.split("+").at(-1)))}}static get platform(){const e="undefined"!=typeof navigator?navigator.platform:"";return(0,a.shadow)(this,"platform",{isWin:e.includes("Win"),isMac:e.includes("Mac")})}exec(e,t){if(!this.allKeys.has(t.key))return;const s=this.callbacks.get(_classPrivateFieldLooseBase(this,l)[l](t));s&&(s.bind(e)(),t.stopPropagation(),t.preventDefault())}}function d(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}t.KeyboardManager=c;class h{#y=null;copy(e){e&&(Array.isArray(e)?this.#y=e.map(e=>e.serialize()):this.#y=[e.serialize()],this.#y=this.#y.filter(e=>!!e),0===this.#y.length&&(this.#y=null))}paste(){return this.#y}isEmpty(){return null===this.#y}destroy(){this.#y=null}}class u{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return(0,r.getColorValues)(e),(0,a.shadow)(this,"_colors",e)}convert(e){const t=(0,r.getRGB)(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[e,s]of this._colors)if(s.every((e,s)=>e===t[s]))return u._colorsMapping.get(e);return t}getHexCode(e){const t=this._colors.get(e);return t?a.Util.makeHexColor(...t):e}}t.ColorManager=u;var p=_classPrivateFieldLooseKey("activeEditor"),g=_classPrivateFieldLooseKey("allEditors"),f=_classPrivateFieldLooseKey("allLayers"),m=_classPrivateFieldLooseKey("clipboardManager"),_=_classPrivateFieldLooseKey("commandManager"),v=_classPrivateFieldLooseKey("currentPageIndex"),b=_classPrivateFieldLooseKey("editorTypes"),y=_classPrivateFieldLooseKey("eventBus"),A=_classPrivateFieldLooseKey("idManager"),P=_classPrivateFieldLooseKey("isEnabled"),S=_classPrivateFieldLooseKey("mode"),x=_classPrivateFieldLooseKey("selectedEditors"),F=_classPrivateFieldLooseKey("boundKeydown"),C=_classPrivateFieldLooseKey("boundOnEditingAction"),w=_classPrivateFieldLooseKey("boundOnPageChanging"),E=_classPrivateFieldLooseKey("previousStates"),L=_classPrivateFieldLooseKey("container"),T=_classPrivateFieldLooseKey("addKeyboardManager"),k=_classPrivateFieldLooseKey("removeKeyboardManager"),M=_classPrivateFieldLooseKey("dispatchUpdateStates"),R=_classPrivateFieldLooseKey("dispatchUpdateUI"),O=_classPrivateFieldLooseKey("enableAll"),D=_classPrivateFieldLooseKey("disableAll"),I=_classPrivateFieldLooseKey("addEditorToLayer"),B=_classPrivateFieldLooseKey("isEmpty"),N=_classPrivateFieldLooseKey("selectEditors");class j{constructor(e,t){Object.defineProperty(this,N,{value:X}),Object.defineProperty(this,B,{value:V}),Object.defineProperty(this,I,{value:z}),Object.defineProperty(this,D,{value:H}),Object.defineProperty(this,O,{value:G}),Object.defineProperty(this,R,{value:K}),Object.defineProperty(this,M,{value:W}),Object.defineProperty(this,k,{value:q}),Object.defineProperty(this,T,{value:U}),Object.defineProperty(this,p,{writable:!0,value:null}),Object.defineProperty(this,g,{writable:!0,value:new Map}),Object.defineProperty(this,f,{writable:!0,value:new Map}),Object.defineProperty(this,m,{writable:!0,value:new h}),Object.defineProperty(this,_,{writable:!0,value:new o}),Object.defineProperty(this,v,{writable:!0,value:0}),Object.defineProperty(this,b,{writable:!0,value:null}),Object.defineProperty(this,y,{writable:!0,value:null}),Object.defineProperty(this,A,{writable:!0,value:new n}),Object.defineProperty(this,P,{writable:!0,value:!1}),Object.defineProperty(this,S,{writable:!0,value:a.AnnotationEditorType.NONE}),Object.defineProperty(this,x,{writable:!0,value:new Set}),Object.defineProperty(this,F,{writable:!0,value:this.keydown.bind(this)}),Object.defineProperty(this,C,{writable:!0,value:this.onEditingAction.bind(this)}),Object.defineProperty(this,w,{writable:!0,value:this.onPageChanging.bind(this)}),Object.defineProperty(this,E,{writable:!0,value:{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1}}),Object.defineProperty(this,L,{writable:!0,value:null}),_classPrivateFieldLooseBase(this,L)[L]=e,_classPrivateFieldLooseBase(this,y)[y]=t,_classPrivateFieldLooseBase(this,y)[y]._on("editingaction",_classPrivateFieldLooseBase(this,C)[C]),_classPrivateFieldLooseBase(this,y)[y]._on("pagechanging",_classPrivateFieldLooseBase(this,w)[w])}destroy(){_classPrivateFieldLooseBase(this,k)[k](),_classPrivateFieldLooseBase(this,y)[y]._off("editingaction",_classPrivateFieldLooseBase(this,C)[C]),_classPrivateFieldLooseBase(this,y)[y]._off("pagechanging",_classPrivateFieldLooseBase(this,w)[w]);for(const e of _classPrivateFieldLooseBase(this,f)[f].values())e.destroy();_classPrivateFieldLooseBase(this,f)[f].clear(),_classPrivateFieldLooseBase(this,g)[g].clear(),_classPrivateFieldLooseBase(this,p)[p]=null,_classPrivateFieldLooseBase(this,x)[x].clear(),_classPrivateFieldLooseBase(this,m)[m].destroy(),_classPrivateFieldLooseBase(this,_)[_].destroy()}onPageChanging({pageNumber:e}){_classPrivateFieldLooseBase(this,v)[v]=e-1}focusMainContainer(){_classPrivateFieldLooseBase(this,L)[L].focus()}keydown(e){this.getActive()?.shouldGetKeyboardEvents()||j._keyboardManager.exec(this,e)}onEditingAction(e){["undo","redo","cut","copy","paste","delete","selectAll"].includes(e.name)&&this[e.name]()}setEditingState(e){e?(_classPrivateFieldLooseBase(this,T)[T](),_classPrivateFieldLooseBase(this,M)[M]({isEditing:_classPrivateFieldLooseBase(this,S)[S]!==a.AnnotationEditorType.NONE,isEmpty:_classPrivateFieldLooseBase(this,B)[B](),hasSomethingToUndo:_classPrivateFieldLooseBase(this,_)[_].hasSomethingToUndo(),hasSomethingToRedo:_classPrivateFieldLooseBase(this,_)[_].hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:_classPrivateFieldLooseBase(this,m)[m].isEmpty()})):(_classPrivateFieldLooseBase(this,k)[k](),_classPrivateFieldLooseBase(this,M)[M]({isEditing:!1}))}registerEditorTypes(e){_classPrivateFieldLooseBase(this,b)[b]=e;for(const e of _classPrivateFieldLooseBase(this,b)[b])_classPrivateFieldLooseBase(this,R)[R](e.defaultPropertiesToUpdate)}getId(){return _classPrivateFieldLooseBase(this,A)[A].getId()}addLayer(e){_classPrivateFieldLooseBase(this,f)[f].set(e.pageIndex,e),_classPrivateFieldLooseBase(this,P)[P]?e.enable():e.disable()}removeLayer(e){_classPrivateFieldLooseBase(this,f)[f].delete(e.pageIndex)}updateMode(e){if(_classPrivateFieldLooseBase(this,S)[S]=e,e===a.AnnotationEditorType.NONE)this.setEditingState(!1),_classPrivateFieldLooseBase(this,D)[D]();else{this.setEditingState(!0),_classPrivateFieldLooseBase(this,O)[O]();for(const t of _classPrivateFieldLooseBase(this,f)[f].values())t.updateMode(e)}}updateToolbar(e){e!==_classPrivateFieldLooseBase(this,S)[S]&&_classPrivateFieldLooseBase(this,y)[y].dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){for(const s of _classPrivateFieldLooseBase(this,x)[x])s.updateParams(e,t);for(const s of _classPrivateFieldLooseBase(this,b)[b])s.updateDefaultParams(e,t)}getEditors(e){const t=[];for(const s of _classPrivateFieldLooseBase(this,g)[g].values())s.pageIndex===e&&t.push(s);return t}getEditor(e){return _classPrivateFieldLooseBase(this,g)[g].get(e)}addEditor(e){_classPrivateFieldLooseBase(this,g)[g].set(e.id,e)}removeEditor(e){_classPrivateFieldLooseBase(this,g)[g].delete(e.id),this.unselect(e)}setActiveEditor(e){_classPrivateFieldLooseBase(this,p)[p]!==e&&(_classPrivateFieldLooseBase(this,p)[p]=e,e&&_classPrivateFieldLooseBase(this,R)[R](e.propertiesToUpdate))}toggleSelected(e){if(_classPrivateFieldLooseBase(this,x)[x].has(e))return _classPrivateFieldLooseBase(this,x)[x].delete(e),e.unselect(),void _classPrivateFieldLooseBase(this,M)[M]({hasSelectedEditor:this.hasSelection});_classPrivateFieldLooseBase(this,x)[x].add(e),e.select(),_classPrivateFieldLooseBase(this,R)[R](e.propertiesToUpdate),_classPrivateFieldLooseBase(this,M)[M]({hasSelectedEditor:!0})}setSelected(e){for(const t of _classPrivateFieldLooseBase(this,x)[x])t!==e&&t.unselect();_classPrivateFieldLooseBase(this,x)[x].clear(),_classPrivateFieldLooseBase(this,x)[x].add(e),e.select(),_classPrivateFieldLooseBase(this,R)[R](e.propertiesToUpdate),_classPrivateFieldLooseBase(this,M)[M]({hasSelectedEditor:!0})}isSelected(e){return _classPrivateFieldLooseBase(this,x)[x].has(e)}unselect(e){e.unselect(),_classPrivateFieldLooseBase(this,x)[x].delete(e),_classPrivateFieldLooseBase(this,M)[M]({hasSelectedEditor:this.hasSelection})}get hasSelection(){return 0!==_classPrivateFieldLooseBase(this,x)[x].size}undo(){_classPrivateFieldLooseBase(this,_)[_].undo(),_classPrivateFieldLooseBase(this,M)[M]({hasSomethingToUndo:_classPrivateFieldLooseBase(this,_)[_].hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:_classPrivateFieldLooseBase(this,B)[B]()})}redo(){_classPrivateFieldLooseBase(this,_)[_].redo(),_classPrivateFieldLooseBase(this,M)[M]({hasSomethingToUndo:!0,hasSomethingToRedo:_classPrivateFieldLooseBase(this,_)[_].hasSomethingToRedo(),isEmpty:_classPrivateFieldLooseBase(this,B)[B]()})}addCommands(e){_classPrivateFieldLooseBase(this,_)[_].add(e),_classPrivateFieldLooseBase(this,M)[M]({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:_classPrivateFieldLooseBase(this,B)[B]()})}delete(){if(_classPrivateFieldLooseBase(this,p)[p]&&_classPrivateFieldLooseBase(this,p)[p].commitOrRemove(),!this.hasSelection)return;const e=[..._classPrivateFieldLooseBase(this,x)[x]];this.addCommands({cmd:()=>{for(const t of e)t.remove()},undo:()=>{for(const t of e)_classPrivateFieldLooseBase(this,I)[I](t)},mustExec:!0})}copy(){if(_classPrivateFieldLooseBase(this,p)[p]&&_classPrivateFieldLooseBase(this,p)[p].commitOrRemove(),this.hasSelection){const e=[];for(const t of _classPrivateFieldLooseBase(this,x)[x])t.isEmpty()||e.push(t);if(0===e.length)return;_classPrivateFieldLooseBase(this,m)[m].copy(e),_classPrivateFieldLooseBase(this,M)[M]({hasEmptyClipboard:!1})}}cut(){this.copy(),this.delete()}paste(){if(_classPrivateFieldLooseBase(this,m)[m].isEmpty())return;this.unselectAll();const e=_classPrivateFieldLooseBase(this,f)[f].get(_classPrivateFieldLooseBase(this,v)[v]),t=_classPrivateFieldLooseBase(this,m)[m].paste().map(t=>e.deserialize(t));this.addCommands({cmd:()=>{for(const e of t)_classPrivateFieldLooseBase(this,I)[I](e);_classPrivateFieldLooseBase(this,N)[N](t)},undo:()=>{for(const e of t)e.remove()},mustExec:!0})}selectAll(){for(const e of _classPrivateFieldLooseBase(this,x)[x])e.commit();_classPrivateFieldLooseBase(this,N)[N](_classPrivateFieldLooseBase(this,g)[g].values())}unselectAll(){if(_classPrivateFieldLooseBase(this,p)[p])_classPrivateFieldLooseBase(this,p)[p].commitOrRemove();else if(0!==_classPrivateFieldLooseBase(this,N)[N].size){for(const e of _classPrivateFieldLooseBase(this,x)[x])e.unselect();_classPrivateFieldLooseBase(this,x)[x].clear(),_classPrivateFieldLooseBase(this,M)[M]({hasSelectedEditor:!1})}}isActive(e){return _classPrivateFieldLooseBase(this,p)[p]===e}getActive(){return _classPrivateFieldLooseBase(this,p)[p]}getMode(){return _classPrivateFieldLooseBase(this,S)[S]}}function U(){_classPrivateFieldLooseBase(this,L)[L].addEventListener("keydown",_classPrivateFieldLooseBase(this,F)[F])}function q(){_classPrivateFieldLooseBase(this,L)[L].removeEventListener("keydown",_classPrivateFieldLooseBase(this,F)[F])}function W(e){Object.entries(e).some(([e,t])=>_classPrivateFieldLooseBase(this,E)[E][e]!==t)&&_classPrivateFieldLooseBase(this,y)[y].dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(_classPrivateFieldLooseBase(this,E)[E],e)})}function K(e){_classPrivateFieldLooseBase(this,y)[y].dispatch("annotationeditorparamschanged",{source:this,details:e})}function G(){if(!_classPrivateFieldLooseBase(this,P)[P]){_classPrivateFieldLooseBase(this,P)[P]=!0;for(const e of _classPrivateFieldLooseBase(this,f)[f].values())e.enable()}}function H(){if(this.unselectAll(),_classPrivateFieldLooseBase(this,P)[P]){_classPrivateFieldLooseBase(this,P)[P]=!1;for(const e of _classPrivateFieldLooseBase(this,f)[f].values())e.disable()}}function z(e){const t=_classPrivateFieldLooseBase(this,f)[f].get(e.pageIndex);t?t.addOrRebuild(e):this.addEditor(e)}function V(){if(0===_classPrivateFieldLooseBase(this,g)[g].size)return!0;if(1===_classPrivateFieldLooseBase(this,g)[g].size)for(const e of _classPrivateFieldLooseBase(this,g)[g].values())return e.isEmpty();return!1}function X(e){_classPrivateFieldLooseBase(this,x)[x].clear();for(const t of e)t.isEmpty()||(_classPrivateFieldLooseBase(this,x)[x].add(t),t.select());_classPrivateFieldLooseBase(this,M)[M]({hasSelectedEditor:!0})}i=j,j._keyboardManager=new c([[["ctrl+a","mac+meta+a"],i.prototype.selectAll],[["ctrl+c","mac+meta+c"],i.prototype.copy],[["ctrl+v","mac+meta+v"],i.prototype.paste],[["ctrl+x","mac+meta+x"],i.prototype.cut],[["ctrl+z","mac+meta+z"],i.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],i.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],i.prototype.delete],[["Escape","mac+Escape"],i.prototype.unselectAll]]),t.AnnotationEditorUIManager=j},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StatTimer=t.RenderingCancelledException=t.PixelsPerInch=t.PageViewport=t.PDFDateString=t.DOMStandardFontDataFactory=t.DOMSVGFactory=t.DOMCanvasFactory=t.DOMCMapReaderFactory=t.AnnotationPrefix=void 0,t.deprecated=function(e){console.log("Deprecated API usage: "+e)},t.getColorValues=function(e){const t=document.createElement("span");t.style.visibility="hidden",document.body.append(t);for(const s of e.keys()){t.style.color=s;const i=window.getComputedStyle(t).color;e.set(s,m(i))}t.remove()},t.getCurrentTransform=function(e){const{a:t,b:s,c:i,d:a,e:r,f:n}=e.getTransform();return[t,s,i,a,r,n]},t.getCurrentTransformInverse=function(e){const{a:t,b:s,c:i,d:a,e:r,f:n}=e.getTransform().invertSelf();return[t,s,i,a,r,n]},t.getFilenameFromUrl=function(e){const t=e.indexOf("#"),s=e.indexOf("?"),i=Math.min(t>0?t:e.length,s>0?s:e.length);return e.substring(e.lastIndexOf("/",i)+1,i)},t.getPdfFilenameFromUrl=function(e,t="document.pdf"){if("string"!=typeof e)return t;if(p(e))return(0,a.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const s=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,i=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(e);let r=s.exec(i[1])||s.exec(i[2])||s.exec(i[3]);if(r&&(r=r[0],r.includes("%")))try{r=s.exec(decodeURIComponent(r))[0]}catch(e){}return r||t},t.getRGB=m,t.getXfaPageViewport=function(e,{scale:t=1,rotation:s=0}){const{width:i,height:a}=e.attributes.style,r=[0,0,parseInt(i),parseInt(a)];return new h({viewBox:r,scale:t,rotation:s})},t.isDataScheme=p,t.isPdfFile=function(e){return"string"==typeof e&&/\.pdf$/i.test(e)},t.isValidFetchUrl=g,t.loadScript=function(e,t=!1){return new Promise((s,i)=>{const a=document.createElement("script");a.src=e,a.onload=function(e){t&&a.remove(),s(e)},a.onerror=function(){i(new Error(`Cannot load script at: ${a.src}`))},(document.head||document.documentElement).append(a)})};var i=s(9),a=s(1);t.AnnotationPrefix="pdfjs_internal_id_";class r{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}t.PixelsPerInch=r;class n extends i.BaseCanvasFactory{constructor({ownerDocument:e=globalThis.document}={}){super(),this._document=e}_createCanvas(e,t){const s=this._document.createElement("canvas");return s.width=e,s.height=t,s}}async function o(e,t=!1){if(g(e,document.baseURI)){const s=await fetch(e);if(!s.ok)throw new Error(s.statusText);return t?new Uint8Array(await s.arrayBuffer()):(0,a.stringToBytes)(await s.text())}return new Promise((s,i)=>{const r=new XMLHttpRequest;r.open("GET",e,!0),t&&(r.responseType="arraybuffer"),r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(200===r.status||0===r.status){let e;if(t&&r.response?e=new Uint8Array(r.response):!t&&r.responseText&&(e=(0,a.stringToBytes)(r.responseText)),e)return void s(e)}i(new Error(r.statusText))}},r.send(null)})}t.DOMCanvasFactory=n;class l extends i.BaseCMapReaderFactory{_fetchData(e,t){return o(e,this.isCompressed).then(e=>({cMapData:e,compressionType:t}))}}t.DOMCMapReaderFactory=l;class c extends i.BaseStandardFontDataFactory{_fetchData(e){return o(e,!0)}}t.DOMStandardFontDataFactory=c;class d extends i.BaseSVGFactory{_createSVG(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}}t.DOMSVGFactory=d;class h{constructor({viewBox:e,scale:t,rotation:s,offsetX:i=0,offsetY:a=0,dontFlip:r=!1}){this.viewBox=e,this.scale=t,this.rotation=s,this.offsetX=i,this.offsetY=a;const n=(e[2]+e[0])/2,o=(e[3]+e[1])/2;let l,c,d,h,u,p,g,f;switch((s%=360)<0&&(s+=360),s){case 180:l=-1,c=0,d=0,h=1;break;case 90:l=0,c=1,d=1,h=0;break;case 270:l=0,c=-1,d=-1,h=0;break;case 0:l=1,c=0,d=0,h=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}r&&(d=-d,h=-h),0===l?(u=Math.abs(o-e[1])*t+i,p=Math.abs(n-e[0])*t+a,g=Math.abs(e[3]-e[1])*t,f=Math.abs(e[2]-e[0])*t):(u=Math.abs(n-e[0])*t+i,p=Math.abs(o-e[1])*t+a,g=Math.abs(e[2]-e[0])*t,f=Math.abs(e[3]-e[1])*t),this.transform=[l*t,c*t,d*t,h*t,u-l*t*n-d*t*o,p-c*t*n-h*t*o],this.width=g,this.height=f}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:s=this.offsetX,offsetY:i=this.offsetY,dontFlip:a=!1}={}){return new h({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:s,offsetY:i,dontFlip:a})}convertToViewportPoint(e,t){return a.Util.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=a.Util.applyTransform([e[0],e[1]],this.transform),s=a.Util.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],s[0],s[1]]}convertToPdfPoint(e,t){return a.Util.applyInverseTransform([e,t],this.transform)}}t.PageViewport=h;class u extends a.BaseException{constructor(e,t){super(e,"RenderingCancelledException"),this.type=t}}function p(e){const t=e.length;let s=0;for(;s<t&&""===e[s].trim();)s++;return"data:"===e.substring(s,s+5).toLowerCase()}function g(e,t){try{const{protocol:s}=t?new URL(e,t):new URL(e);return"http:"===s||"https:"===s}catch(e){return!1}}let f;function m(e){if(e.startsWith("#")){const t=parseInt(e.slice(1),16);return[(16711680&t)>>16,(65280&t)>>8,255&t]}return e.startsWith("rgb(")?e.slice(4,-1).split(",").map(e=>parseInt(e)):e.startsWith("rgba(")?e.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):((0,a.warn)(`Not a valid color format: "${e}"`),[0,0,0])}t.RenderingCancelledException=u,t.StatTimer=class{constructor(){this.started=Object.create(null),this.times=[]}time(e){e in this.started&&(0,a.warn)(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||(0,a.warn)(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const e of this.times){const s=e.name;s.length>t&&(t=s.length)}for(const s of this.times){const i=s.end-s.start;e.push(`${s.name.padEnd(t)} ${i}ms\n`)}return e.join("")}},t.PDFDateString=class{static toDateObject(e){if(!e||"string"!=typeof e)return null;f||(f=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=f.exec(e);if(!t)return null;const s=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let a=parseInt(t[3],10);a=a>=1&&a<=31?a:1;let r=parseInt(t[4],10);r=r>=0&&r<=23?r:0;let n=parseInt(t[5],10);n=n>=0&&n<=59?n:0;let o=parseInt(t[6],10);o=o>=0&&o<=59?o:0;const l=t[7]||"Z";let c=parseInt(t[8],10);c=c>=0&&c<=23?c:0;let d=parseInt(t[9],10)||0;return d=d>=0&&d<=59?d:0,"-"===l?(r+=c,n+=d):"+"===l&&(r-=c,n-=d),new Date(Date.UTC(s,i,a,r,n,o))}}},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseStandardFontDataFactory=t.BaseSVGFactory=t.BaseCanvasFactory=t.BaseCMapReaderFactory=void 0;var i=s(1);class a{constructor(){this.constructor===a&&(0,i.unreachable)("Cannot initialize BaseCanvasFactory.")}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const s=this._createCanvas(e,t);return{canvas:s,context:s.getContext("2d")}}reset(e,t,s){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||s<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=s}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){(0,i.unreachable)("Abstract method `_createCanvas` called.")}}t.BaseCanvasFactory=a;class r{constructor({baseUrl:e=null,isCompressed:t=!1}){this.constructor===r&&(0,i.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("The CMap \"baseUrl\" parameter must be specified, ensure that the \"cMapUrl\" and \"cMapPacked\" API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":""),s=this.isCompressed?i.CMapCompressionType.BINARY:i.CMapCompressionType.NONE;return this._fetchData(t,s).catch(e=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}_fetchData(e,t){(0,i.unreachable)("Abstract method `_fetchData` called.")}}t.BaseCMapReaderFactory=r;class n{constructor({baseUrl:e=null}){this.constructor===n&&(0,i.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("The standard font \"baseUrl\" parameter must be specified, ensure that the \"standardFontDataUrl\" API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetchData(t).catch(e=>{throw new Error(`Unable to load font data at: ${t}`)})}_fetchData(e){(0,i.unreachable)("Abstract method `_fetchData` called.")}}t.BaseStandardFontDataFactory=n;class o{constructor(){this.constructor===o&&(0,i.unreachable)("Cannot initialize BaseSVGFactory.")}create(e,t,s=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),s||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if("string"!=typeof e)throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){(0,i.unreachable)("Abstract method `_createSVG` called.")}}t.BaseSVGFactory=o},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MurmurHash3_64=void 0;var i=s(1);const a=3285377520,r=4294901760,n=65535;t.MurmurHash3_64=class{constructor(e){this.h1=e?4294967295&e:a,this.h2=e?4294967295&e:a}update(e){let t,s;if("string"==typeof e){t=new Uint8Array(2*e.length),s=0;for(let i=0,a=e.length;i<a;i++){const a=e.charCodeAt(i);a<=255?t[s++]=a:(t[s++]=a>>>8,t[s++]=255&a)}}else{if(!(0,i.isArrayBuffer)(e))throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");t=e.slice(),s=t.byteLength}const a=s>>2,o=s-4*a,l=new Uint32Array(t.buffer,0,a);let c=0,d=0,h=this.h1,u=this.h2;const p=3432918353,g=461845907,f=11601,m=13715;for(let e=0;e<a;e++)1&e?(c=l[e],c=c*p&r|c*f&n,c=c<<15|c>>>17,c=c*g&r|c*m&n,h^=c,h=h<<13|h>>>19,h=5*h+3864292196):(d=l[e],d=d*p&r|d*f&n,d=d<<15|d>>>17,d=d*g&r|d*m&n,u^=d,u=u<<13|u>>>19,u=5*u+3864292196);switch(c=0,o){case 3:c^=t[4*a+2]<<16;case 2:c^=t[4*a+1]<<8;case 1:c^=t[4*a],c=c*p&r|c*f&n,c=c<<15|c>>>17,c=c*g&r|c*m&n,1&a?h^=c:u^=c}this.h1=h,this.h2=u}hexdigest(){let e=this.h1,t=this.h2;e^=t>>>1,e=3981806797*e&r|36045*e&n,t=4283543511*t&r|(2950163797*(t<<16|e>>>16)&r)>>>16,e^=t>>>1,e=444984403*e&r|60499*e&n,t=3301882366*t&r|(3120437893*(t<<16|e>>>16)&r)>>>16,e^=t>>>1;const s=(e>>>0).toString(16),i=(t>>>0).toString(16);return s.padStart(8,"0")+i.padStart(8,"0")}}},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var i=s(1);class a{constructor({docId:e,onUnsupportedFeature:t,ownerDocument:s=globalThis.document,styleElement:r=null}){this.constructor===a&&(0,i.unreachable)("Cannot initialize BaseFontLoader."),this.docId=e,this._onUnsupportedFeature=t,this._document=s,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(e){this.nativeFontFaces.push(e),this._document.fonts.add(e)}insertRule(e){let t=this.styleElement;t||(t=this.styleElement=this._document.createElement("style"),t.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].append(t));const s=t.sheet;s.insertRule(e,s.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(e){if(e.attached||e.missingFile)return;if(e.attached=!0,this.isFontLoadingAPISupported){const t=e.createNativeFontFace();if(t){this.addNativeFontFace(t);try{await t.loaded}catch(s){throw this._onUnsupportedFeature({featureId:i.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,i.warn)(`Failed to load font '${t.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(s=>{const i=this._queueLoadingCallback(s);this._prepareFontLoadEvent([t],[e],i)})}}_queueLoadingCallback(e){(0,i.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return(0,i.shadow)(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){(0,i.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,i.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(e,t,s){(0,i.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let r;t.FontLoader=r,t.FontLoader=r=class extends a{constructor(e){super(e),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let e=!1;if("undefined"==typeof navigator)e=!0;else{const t=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);t?.[1]>=14&&(e=!0)}return(0,i.shadow)(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){const t=this.loadingContext,s={id:"pdfjs-font-loading-"+t.nextRequestId++,done:!1,complete:function(){for((0,i.assert)(!s.done,"completeRequest() cannot be called twice."),s.done=!0;t.requests.length>0&&t.requests[0].done;){const e=t.requests.shift();setTimeout(e.callback,0)}},callback:e};return t.requests.push(s),s}get _loadTestFont(){return(0,i.shadow)(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(e,t,s){function a(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function r(e,t,s,i){return e.substring(0,t)+i+e.substring(t+s)}let n,o;const l=this._document.createElement("canvas");l.width=1,l.height=1;const c=l.getContext("2d");let d=0;const h=`lt${Date.now()}${this.loadTestFontId++}`;let u=this._loadTestFont;u=r(u,976,h.length,h);const p=1482184792;let g=a(u,16);for(n=0,o=h.length-3;n<o;n+=4)g=g-p+a(h,n)|0;n<h.length&&(g=g-p+a(h+"XXX",n)|0),u=r(u,16,4,(0,i.string32)(g));const f=`@font-face {font-family:"${h}";src:url(data:font/opentype;base64,${btoa(u)});}`;this.insertRule(f);const m=[];for(const e of t)m.push(e.loadedName);m.push(h);const _=this._document.createElement("div");_.style.visibility="hidden",_.style.width=_.style.height="10px",_.style.position="absolute",_.style.top=_.style.left="0px";for(const e of m){const t=this._document.createElement("span");t.textContent="Hi",t.style.fontFamily=e,_.append(t)}this._document.body.append(_),(function e(t,s){if(d++,d>30)return(0,i.warn)("Load test font never loaded."),void s();c.font="30px "+t,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0?s():setTimeout(e.bind(null,t,s))})(h,()=>{_.remove(),s.complete()})}},t.FontFaceObject=class{constructor(e,{isEvalSupported:t=!0,disableFontFace:s=!1,ignoreErrors:i=!1,onUnsupportedFeature:a,fontRegistry:r=null}){this.compiledGlyphs=Object.create(null);for(const t in e)this[t]=e[t];this.isEvalSupported=!1!==t,this.disableFontFace=!0===s,this.ignoreErrors=!0===i,this._onUnsupportedFeature=a,this.fontRegistry=r}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(this.cssFontInfo){const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}else e=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=(0,i.bytesToString)(this.data),t=`url(data:${this.mimetype};base64,${btoa(e)});`;let s;if(this.cssFontInfo){let e=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(e+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),s=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${e}src:${t}}`}else s=`@font-face {font-family:"${this.loadedName}";src:${t}}`;return this.fontRegistry&&this.fontRegistry.registerFont(this,t),s}getPathGenerator(e,t){if(void 0!==this.compiledGlyphs[t])return this.compiledGlyphs[t];let s;try{s=e.get(this.loadedName+"_path_"+t)}catch(e){if(!this.ignoreErrors)throw e;return this._onUnsupportedFeature({featureId:i.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,i.warn)(`getPathGenerator - ignoring character: "${e}".`),this.compiledGlyphs[t]=function(e,t){}}if(this.isEvalSupported&&i.FeatureTest.isEvalSupported){const e=[];for(const t of s){const s=void 0!==t.args?t.args.join(","):"";e.push("c.",t.cmd,"(",s,");\n")}return this.compiledGlyphs[t]=new Function("c","size",e.join(""))}return this.compiledGlyphs[t]=function(e,t){for(const i of s)"scale"===i.cmd&&(i.args=[t,-t]),e[i.cmd].apply(e,i.args)}}}},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var i=s(8),a=s(1),r=s(13),n=s(14),o=s(3);const l=4096,c=o.isNodeJS&&"undefined"==typeof Path2D?-1:1e3,d=16;function h(e,t){if(e._removeMirroring)throw new Error("Context is already forwarding operations.");e.__originalSave=e.save,e.__originalRestore=e.restore,e.__originalRotate=e.rotate,e.__originalScale=e.scale,e.__originalTranslate=e.translate,e.__originalTransform=e.transform,e.__originalSetTransform=e.setTransform,e.__originalResetTransform=e.resetTransform,e.__originalClip=e.clip,e.__originalMoveTo=e.moveTo,e.__originalLineTo=e.lineTo,e.__originalBezierCurveTo=e.bezierCurveTo,e.__originalRect=e.rect,e.__originalClosePath=e.closePath,e.__originalBeginPath=e.beginPath,e._removeMirroring=()=>{e.save=e.__originalSave,e.restore=e.__originalRestore,e.rotate=e.__originalRotate,e.scale=e.__originalScale,e.translate=e.__originalTranslate,e.transform=e.__originalTransform,e.setTransform=e.__originalSetTransform,e.resetTransform=e.__originalResetTransform,e.clip=e.__originalClip,e.moveTo=e.__originalMoveTo,e.lineTo=e.__originalLineTo,e.bezierCurveTo=e.__originalBezierCurveTo,e.rect=e.__originalRect,e.closePath=e.__originalClosePath,e.beginPath=e.__originalBeginPath,delete e._removeMirroring},e.save=function(){t.save(),this.__originalSave()},e.restore=function(){t.restore(),this.__originalRestore()},e.translate=function(e,s){t.translate(e,s),this.__originalTranslate(e,s)},e.scale=function(e,s){t.scale(e,s),this.__originalScale(e,s)},e.transform=function(e,s,i,a,r,n){t.transform(e,s,i,a,r,n),this.__originalTransform(e,s,i,a,r,n)},e.setTransform=function(e,s,i,a,r,n){t.setTransform(e,s,i,a,r,n),this.__originalSetTransform(e,s,i,a,r,n)},e.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},e.rotate=function(e){t.rotate(e),this.__originalRotate(e)},e.clip=function(e){t.clip(e),this.__originalClip(e)},e.moveTo=function(e,s){t.moveTo(e,s),this.__originalMoveTo(e,s)},e.lineTo=function(e,s){t.lineTo(e,s),this.__originalLineTo(e,s)},e.bezierCurveTo=function(e,s,i,a,r,n){t.bezierCurveTo(e,s,i,a,r,n),this.__originalBezierCurveTo(e,s,i,a,r,n)},e.rect=function(e,s,i,a){t.rect(e,s,i,a),this.__originalRect(e,s,i,a)},e.closePath=function(){t.closePath(),this.__originalClosePath()},e.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class u{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,s){let i;return void 0!==this.cache[e]?(i=this.cache[e],this.canvasFactory.reset(i,t,s)):(i=this.canvasFactory.create(t,s),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function p(e,t,s,a,r,n,o,l,c,d){const[h,u,p,g,f,m]=(0,i.getCurrentTransform)(e);if(0===u&&0===p){const i=o*h+f,_=Math.round(i),v=l*g+m,b=Math.round(v),y=(o+c)*h+f,A=Math.abs(Math.round(y)-_)||1,P=(l+d)*g+m,S=Math.abs(Math.round(P)-b)||1;return e.setTransform(Math.sign(h),0,0,Math.sign(g),_,b),e.drawImage(t,s,a,r,n,0,0,A,S),e.setTransform(h,u,p,g,f,m),[A,S]}if(0===h&&0===g){const i=l*p+f,_=Math.round(i),v=o*u+m,b=Math.round(v),y=(l+d)*p+f,A=Math.abs(Math.round(y)-_)||1,P=(o+c)*u+m,S=Math.abs(Math.round(P)-b)||1;return e.setTransform(0,Math.sign(u),Math.sign(p),0,_,b),e.drawImage(t,s,a,r,n,0,0,S,A),e.setTransform(h,u,p,g,f,m),[S,A]}return e.drawImage(t,s,a,r,n,o,l,c,d),[Math.hypot(h,u)*c,Math.hypot(p,g)*d]}function g(e){const{width:t,height:s}=e;if(t>c||s>c)return null;const i=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),a=t+1;let r,n,o,l=new Uint8Array(a*(s+1));const d=t+7&-8;let h=new Uint8Array(d*s),u=0;for(const t of e.data){let e=128;for(;e>0;)h[u++]=t&e?0:255,e>>=1}let p=0;for(u=0,0!==h[u]&&(l[0]=1,++p),n=1;n<t;n++)h[u]!==h[u+1]&&(l[n]=h[u]?2:1,++p),u++;for(0!==h[u]&&(l[n]=2,++p),r=1;r<s;r++){u=r*d,o=r*a,h[u-d]!==h[u]&&(l[o]=h[u]?1:8,++p);let e=(h[u]?4:0)+(h[u-d]?8:0);for(n=1;n<t;n++)e=(e>>2)+(h[u+1]?4:0)+(h[u-d+1]?8:0),i[e]&&(l[o+n]=i[e],++p),u++;if(h[u-d]!==h[u]&&(l[o+n]=h[u]?2:4,++p),p>1e3)return null}for(u=d*(s-1),o=r*a,0!==h[u]&&(l[o]=8,++p),n=1;n<t;n++)h[u]!==h[u+1]&&(l[o+n]=h[u]?4:8,++p),u++;if(0!==h[u]&&(l[o+n]=4,++p),p>1e3)return null;const g=new Int32Array([0,a,-1,0,-a,0,0,0,1]),f=new Path2D;for(r=0;p&&r<=s;r++){let e=r*a;const s=e+t;for(;e<s&&!l[e];)e++;if(e===s)continue;f.moveTo(e%a,r);const i=e;let n=l[e];do{const t=g[n];do{e+=t}while(!l[e]);const s=l[e];5!==s&&10!==s?(n=s,l[e]=0):(n=s&51*n>>4,l[e]&=n>>2|n<<2),f.lineTo(e%a,e/a|0),l[e]||--p}while(i!==e);--r}return h=null,l=null,function(e){e.save(),e.scale(1/t,-1/s),e.translate(0,-s),e.fill(f),e.beginPath(),e.restore()}}class f{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=a.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=a.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,s){[t,s]=a.Util.applyTransform([t,s],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,s),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,s)}updateRectMinMax(e,t){const s=a.Util.applyTransform(t,e),i=a.Util.applyTransform(t.slice(2),e);this.minX=Math.min(this.minX,s[0],i[0]),this.minY=Math.min(this.minY,s[1],i[1]),this.maxX=Math.max(this.maxX,s[0],i[0]),this.maxY=Math.max(this.maxY,s[1],i[1])}updateScalingPathMinMax(e,t){a.Util.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.maxX=Math.max(this.maxX,t[1]),this.minY=Math.min(this.minY,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,s,i,r,n,o,l,c,d){const h=a.Util.bezierBoundingBox(t,s,i,r,n,o,l,c);if(d)return d[0]=Math.min(d[0],h[0],h[2]),d[1]=Math.max(d[1],h[0],h[2]),d[2]=Math.min(d[2],h[1],h[3]),void(d[3]=Math.max(d[3],h[1],h[3]));this.updateRectMinMax(e,h)}getPathBoundingBox(e=r.PathType.FILL,t=null){const s=[this.minX,this.minY,this.maxX,this.maxY];if(e===r.PathType.STROKE){t||(0,a.unreachable)("Stroke bounding box must include transform.");const e=a.Util.singularValueDecompose2dScale(t),i=e[0]*this.lineWidth/2,r=e[1]*this.lineWidth/2;s[0]-=i,s[1]-=r,s[2]+=i,s[3]+=r}return s}updateClipFromPath(){const e=a.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=r.PathType.FILL,t=null){return a.Util.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function m(e,t,s=null){if("undefined"!=typeof ImageData&&t instanceof ImageData)return void e.putImageData(t,0,0);const i=t.height,r=t.width,n=i%d,o=(i-n)/d,l=0===n?o:o+1,c=e.createImageData(r,d);let h,u=0;const p=t.data,g=c.data;let f,m,_,v,b,y,A,P;if(s)switch(s.length){case 1:b=s[0],y=s[0],A=s[0],P=s[0];break;case 4:b=s[0],y=s[1],A=s[2],P=s[3]}if(t.kind===a.ImageKind.GRAYSCALE_1BPP){const t=p.byteLength,s=new Uint32Array(g.buffer,0,g.byteLength>>2),i=s.length,v=r+7>>3;let b=4294967295,y=a.FeatureTest.isLittleEndian?4278190080:255;for(P&&255===P[0]&&0===P[255]&&([b,y]=[y,b]),f=0;f<l;f++){for(_=f<o?d:n,h=0,m=0;m<_;m++){const e=t-u;let i=0;const a=e>v?r:8*e-7,n=-8&a;let o=0,l=0;for(;i<n;i+=8)l=p[u++],s[h++]=128&l?b:y,s[h++]=64&l?b:y,s[h++]=32&l?b:y,s[h++]=16&l?b:y,s[h++]=8&l?b:y,s[h++]=4&l?b:y,s[h++]=2&l?b:y,s[h++]=1&l?b:y;for(;i<a;i++)0===o&&(l=p[u++],o=128),s[h++]=l&o?b:y,o>>=1}for(;h<i;)s[h++]=0;e.putImageData(c,0,f*d)}}else if(t.kind===a.ImageKind.RGBA_32BPP){const t=!!(b||y||A);for(m=0,v=r*d*4,f=0;f<o;f++){if(g.set(p.subarray(u,u+v)),u+=v,t)for(let e=0;e<v;e+=4)b&&(g[e+0]=b[g[e+0]]),y&&(g[e+1]=y[g[e+1]]),A&&(g[e+2]=A[g[e+2]]);e.putImageData(c,0,m),m+=d}if(f<l){if(v=r*n*4,g.set(p.subarray(u,u+v)),t)for(let e=0;e<v;e+=4)b&&(g[e+0]=b[g[e+0]]),y&&(g[e+1]=y[g[e+1]]),A&&(g[e+2]=A[g[e+2]]);e.putImageData(c,0,m)}}else{if(t.kind!==a.ImageKind.RGB_24BPP)throw new Error(`bad image kind: ${t.kind}`);{const t=!!(b||y||A);for(_=d,v=r*_,f=0;f<l;f++){for(f>=o&&(_=n,v=r*_),h=0,m=v;m--;)g[h++]=p[u++],g[h++]=p[u++],g[h++]=p[u++],g[h++]=255;if(t)for(let e=0;e<h;e+=4)b&&(g[e+0]=b[g[e+0]]),y&&(g[e+1]=y[g[e+1]]),A&&(g[e+2]=A[g[e+2]]);e.putImageData(c,0,f*d)}}}}function _(e,t){if(t.bitmap)return void e.drawImage(t.bitmap,0,0);const s=t.height,i=t.width,a=s%d,r=(s-a)/d,o=0===a?r:r+1,l=e.createImageData(i,d);let c=0;const h=t.data,u=l.data;for(let t=0;t<o;t++){const s=t<r?d:a;({srcPos:c}=(0,n.applyMaskImageData)({src:h,srcPos:c,dest:u,width:i,height:s})),e.putImageData(l,0,t*d)}}function v(e,t){const s=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let i=0,a=s.length;i<a;i++){const a=s[i];void 0!==e[a]&&(t[a]=e[a])}void 0!==e.setLineDash&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function b(e,t){e.strokeStyle=e.fillStyle=t||"#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",void 0!==e.setLineDash&&(e.setLineDash([]),e.lineDashOffset=0)}function y(e,t,s,i){const a=e.length;for(let r=3;r<a;r+=4){const a=e[r];if(0===a)e[r-3]=t,e[r-2]=s,e[r-1]=i;else if(a<255){const n=255-a;e[r-3]=e[r-3]*a+t*n>>8,e[r-2]=e[r-2]*a+s*n>>8,e[r-1]=e[r-1]*a+i*n>>8}}}function A(e,t,s){const i=e.length;for(let a=3;a<i;a+=4){const i=s?s[e[a]]:e[a];t[a]=t[a]*i*.00392156862745098|0}}function P(e,t,s){const i=e.length;for(let a=3;a<i;a+=4){const i=77*e[a-3]+152*e[a-2]+28*e[a-1];t[a]=s?t[a]*s[i>>8]>>8:t[a]*i>>16}}function S(e,t,s,i,a,r,n,o,l,c,d){const h=!!r,u=h?r[0]:0,p=h?r[1]:0,g=h?r[2]:0;let f;f="Luminosity"===a?P:A;const m=Math.min(i,Math.ceil(1048576/s));for(let a=0;a<i;a+=m){const r=Math.min(m,i-a),_=e.getImageData(o-c,a+(l-d),s,r),v=t.getImageData(o,a+l,s,r);h&&y(_.data,u,p,g),f(_.data,v.data,n),t.putImageData(v,o,a+l)}}function x(e,t,s,i){const a=i[0],r=i[1],n=i[2]-a,o=i[3]-r;0!==n&&0!==o&&(S(t.context,s,n,o,t.subtype,t.backdrop,t.transferMap,a,r,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(s.canvas,0,0),e.restore())}function F(e,t){const s=a.Util.singularValueDecompose2dScale(e);s[0]=Math.fround(s[0]),s[1]=Math.fround(s[1]);const r=Math.fround((globalThis.devicePixelRatio||1)*i.PixelsPerInch.PDF_TO_CSS_UNITS);return void 0!==t?t:s[0]<=r||s[1]<=r}const C=["butt","round","square"],w=["miter","round","bevel"],E={},L={};var T=_classPrivateFieldLooseKey("restoreInitialState");class k{constructor(e,t,s,i,a,r,n,o){Object.defineProperty(this,T,{value:M}),this.ctx=e,this.current=new f(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=s,this.canvasFactory=i,this.imageLayer=a,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=r,this.cachedCanvases=new u(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=n,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=o?.background||null,this.foregroundColor=o?.foreground||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return"string"==typeof e?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:s=!1,background:a=null}){const r=this.ctx.canvas.width,n=this.ctx.canvas.height,o=a||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const e=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const t=this.backgroundColor=this.ctx.fillStyle;let s=!0,a=o;if(this.ctx.fillStyle=o,a=this.ctx.fillStyle,s="string"==typeof a&&/^#[0-9A-Fa-f]{6}$/.test(a),"#000000"===e&&"#ffffff"===t||e===t||!s)this.foregroundColor=this.backgroundColor=null;else{const[s,r,n]=(0,i.getRGB)(a),o=e=>(e/=255)<=.03928?e/12.92:((e+.055)/1.055)**2.4,l=Math.round(.2126*o(s)+.7152*o(r)+.0722*o(n));this.selectColor=(s,i,a)=>{const r=.2126*o(s)+.7152*o(i)+.0722*o(a);return Math.round(r)===l?t:e}}}if(this.ctx.fillStyle=this.backgroundColor||o,this.ctx.fillRect(0,0,r,n),this.ctx.restore(),s){const e=this.cachedCanvases.getCanvas("transparent",r,n);this.compositeCtx=this.ctx,this.transparentCanvas=e.canvas,this.ctx=e.context,this.ctx.save(),this.ctx.transform(...(0,i.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),b(this.ctx,this.foregroundColor),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=(0,i.getCurrentTransform)(this.ctx),this.imageLayer&&((0,i.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}executeOperatorList(e,t,s,i){const r=e.argsArray,n=e.fnArray;let o=t||0;const l=r.length;if(l===o)return o;const c=l-o>10&&"function"==typeof s,d=c?Date.now()+15:0;let h=0;const u=this.commonObjs,p=this.objs;let g;for(;;){if(void 0!==i&&o===i.nextBreakPoint)return i.breakIt(o,s),o;if(g=n[o],g!==a.OPS.dependency)this[g].apply(this,r[o]);else for(const e of r[o]){const t=e.startsWith("g_")?u:p;if(!t.has(e))return t.get(e,s),o}if(o++,o===l)return o;if(c&&++h>10){if(Date.now()>d)return s(),o;h=0}}}endDrawing(){_classPrivateFieldLooseBase(this,T)[T](),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(e,t){const s=e.width,i=e.height;let a,r,n=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),l=s,c=i,d="prescale1";for(;n>2&&l>1||o>2&&c>1;){let t=l,s=c;n>2&&l>1&&(t=Math.ceil(l/2),n/=l/t),o>2&&c>1&&(s=Math.ceil(c/2),o/=c/s),a=this.cachedCanvases.getCanvas(d,t,s),r=a.context,r.clearRect(0,0,t,s),r.drawImage(e,0,0,l,c,0,0,t,s),e=a.canvas,l=t,c=s,d="prescale1"===d?"prescale2":"prescale1"}return{img:e,paintWidth:l,paintHeight:c}}_createMaskCanvas(e){const t=this.ctx,{width:s,height:n}=e,o=this.current.fillColor,l=this.current.patternFill,c=(0,i.getCurrentTransform)(t);let d,h,u,g;if((e.bitmap||e.data)&&e.count>1){const t=e.bitmap||e.data.buffer,s=c.slice(0,4);h=JSON.stringify(l?s:[s,o]),d=this._cachedBitmapsMap.get(t),d||(d=new Map,this._cachedBitmapsMap.set(t,d));const i=d.get(h);if(i&&!l)return{canvas:i,offsetX:Math.round(Math.min(c[0],c[2])+c[4]),offsetY:Math.round(Math.min(c[1],c[3])+c[5])};u=i}u||(g=this.cachedCanvases.getCanvas("maskCanvas",s,n),_(g.context,e));let f=a.Util.transform(c,[1/s,0,0,-1/n,0,0]);f=a.Util.transform(f,[1,0,0,1,0,-n]);const m=a.Util.applyTransform([0,0],f),v=a.Util.applyTransform([s,n],f),b=a.Util.normalizeRect([m[0],m[1],v[0],v[1]]),y=Math.round(b[2]-b[0])||1,A=Math.round(b[3]-b[1])||1,P=this.cachedCanvases.getCanvas("fillCanvas",y,A),S=P.context,x=Math.min(m[0],v[0]),C=Math.min(m[1],v[1]);S.translate(-x,-C),S.transform(...f),u||(u=this._scaleImage(g.canvas,(0,i.getCurrentTransformInverse)(S)),u=u.img,d&&l&&d.set(h,u)),S.imageSmoothingEnabled=F((0,i.getCurrentTransform)(S),e.interpolate),p(S,u,0,0,u.width,u.height,0,0,s,n),S.globalCompositeOperation="source-in";const w=a.Util.transform((0,i.getCurrentTransformInverse)(S),[1,0,0,1,-x,-C]);return S.fillStyle=l?o.getPattern(t,this,w,r.PathType.FILL):o,S.fillRect(0,0,s,n),d&&!l&&(this.cachedCanvases.delete("fillCanvas"),d.set(h,P.canvas)),{canvas:P.canvas,offsetX:Math.round(x),offsetY:Math.round(C)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=C[e]}setLineJoin(e){this.ctx.lineJoin=w[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const s=this.ctx;void 0!==s.setLineDash&&(s.setLineDash(e),s.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(let t=0,s=e.length;t<s;t++){const s=e[t],i=s[0],a=s[1];switch(i){case"LW":this.setLineWidth(a);break;case"LC":this.setLineCap(a);break;case"LJ":this.setLineJoin(a);break;case"ML":this.setMiterLimit(a);break;case"D":this.setDash(a[0],a[1]);break;case"RI":this.setRenderingIntent(a);break;case"FL":this.setFlatness(a);break;case"Font":this.setFont(a[0],a[1]);break;case"CA":this.current.strokeAlpha=s[1];break;case"ca":this.current.fillAlpha=s[1],this.ctx.globalAlpha=s[1];break;case"BM":this.ctx.globalCompositeOperation=a;break;case"SMask":this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=a}}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(s,e,t);this.suspendedCtx=this.ctx,this.ctx=a.context;const r=this.ctx;r.setTransform(...(0,i.getCurrentTransform)(this.suspendedCtx)),v(this.suspendedCtx,r),h(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),v(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask;x(this.suspendedCtx,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(v(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),v(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(e,t,s,i,a,r){this.ctx.transform(e,t,s,i,a,r),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(e,t,s){const r=this.ctx,n=this.current;let o,l,c=n.x,d=n.y;const h=(0,i.getCurrentTransform)(r),u=0===h[0]&&0===h[3]||0===h[1]&&0===h[2],p=u?s.slice(0):null;for(let s=0,i=0,g=e.length;s<g;s++)switch(0|e[s]){case a.OPS.rectangle:c=t[i++],d=t[i++];const e=t[i++],s=t[i++],g=c+e,f=d+s;r.moveTo(c,d),0===e||0===s?r.lineTo(g,f):(r.lineTo(g,d),r.lineTo(g,f),r.lineTo(c,f)),u||n.updateRectMinMax(h,[c,d,g,f]),r.closePath();break;case a.OPS.moveTo:c=t[i++],d=t[i++],r.moveTo(c,d),u||n.updatePathMinMax(h,c,d);break;case a.OPS.lineTo:c=t[i++],d=t[i++],r.lineTo(c,d),u||n.updatePathMinMax(h,c,d);break;case a.OPS.curveTo:o=c,l=d,c=t[i+4],d=t[i+5],r.bezierCurveTo(t[i],t[i+1],t[i+2],t[i+3],c,d),n.updateCurvePathMinMax(h,o,l,t[i],t[i+1],t[i+2],t[i+3],c,d,p),i+=6;break;case a.OPS.curveTo2:o=c,l=d,r.bezierCurveTo(c,d,t[i],t[i+1],t[i+2],t[i+3]),n.updateCurvePathMinMax(h,o,l,c,d,t[i],t[i+1],t[i+2],t[i+3],p),c=t[i+2],d=t[i+3],i+=4;break;case a.OPS.curveTo3:o=c,l=d,c=t[i+2],d=t[i+3],r.bezierCurveTo(t[i],t[i+1],c,d,c,d),n.updateCurvePathMinMax(h,o,l,t[i],t[i+1],c,d,c,d,p),i+=4;break;case a.OPS.closePath:r.closePath()}u&&n.updateScalingPathMinMax(h,p),n.setCurrentPoint(c,d)}closePath(){this.ctx.closePath()}stroke(e){e=void 0===e||e;const t=this.ctx,s=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"==typeof s&&s?.getPattern?(t.save(),t.strokeStyle=s.getPattern(t,this,(0,i.getCurrentTransformInverse)(t),r.PathType.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e){e=void 0===e||e;const t=this.ctx,s=this.current.fillColor;let a=!1;this.current.patternFill&&(t.save(),t.fillStyle=s.getPattern(t,this,(0,i.getCurrentTransformInverse)(t),r.PathType.FILL),a=!0);const n=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==n&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),a&&t.restore(),e&&this.consumePath(n)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=E}eoClip(){this.pendingClip=L}beginText(){this.current.textMatrix=a.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(void 0!==e){t.save(),t.beginPath();for(const s of e)t.setTransform(...s.transform),t.translate(s.x,s.y),s.addToPath(t,s.fontSize);t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}else t.beginPath()}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){const s=this.commonObjs.get(e),i=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=s.fontMatrix||a.FONT_IDENTITY_MATRIX,0!==i.fontMatrix[0]&&0!==i.fontMatrix[3]||(0,a.warn)("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=t,s.isType3Font)return;const r=s.loadedName||"sans-serif";let n="normal";s.black?n="900":s.bold&&(n="bold");const o=s.italic?"italic":"normal",l=`"${r}", ${s.fallbackName}`;let c=t;t<16?c=16:t>100&&(c=100),this.current.fontSizeScale=t/c,this.ctx.font=`${o} ${n} ${c}px ${l}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,s,i,a,r){this.current.textMatrix=[e,t,s,i,a,r],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,s,r){const n=this.ctx,o=this.current,l=o.font,c=o.textRenderingMode,d=o.fontSize/o.fontSizeScale,h=c&a.TextRenderingMode.FILL_STROKE_MASK,u=!!(c&a.TextRenderingMode.ADD_TO_PATH_FLAG),p=o.patternFill&&!l.missingFile;let g;(l.disableFontFace||u||p)&&(g=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||p?(n.save(),n.translate(t,s),n.beginPath(),g(n,d),r&&n.setTransform(...r),h!==a.TextRenderingMode.FILL&&h!==a.TextRenderingMode.FILL_STROKE||n.fill(),h!==a.TextRenderingMode.STROKE&&h!==a.TextRenderingMode.FILL_STROKE||n.stroke(),n.restore()):(h!==a.TextRenderingMode.FILL&&h!==a.TextRenderingMode.FILL_STROKE||n.fillText(e,t,s),h!==a.TextRenderingMode.STROKE&&h!==a.TextRenderingMode.FILL_STROKE||n.strokeText(e,t,s)),u&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,i.getCurrentTransform)(n),x:t,y:s,fontSize:d,addToPath:g})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let s=!1;for(let e=3;e<t.length;e+=4)if(t[e]>0&&t[e]<255){s=!0;break}return(0,a.shadow)(this,"isFontSubpixelAAEnabled",s)}showText(e){const t=this.current,s=t.font;if(s.isType3Font)return this.showType3Text(e);const n=t.fontSize;if(0===n)return;const o=this.ctx,l=t.fontSizeScale,c=t.charSpacing,d=t.wordSpacing,h=t.fontDirection,u=t.textHScale*h,p=e.length,g=s.vertical,f=g?1:-1,m=s.defaultVMetrics,_=n*t.fontMatrix[0],v=t.textRenderingMode===a.TextRenderingMode.FILL&&!s.disableFontFace&&!t.patternFill;let b;if(o.save(),o.transform(...t.textMatrix),o.translate(t.x,t.y+t.textRise),h>0?o.scale(u,-1):o.scale(u,1),t.patternFill){o.save();const e=t.fillColor.getPattern(o,this,(0,i.getCurrentTransformInverse)(o),r.PathType.FILL);b=(0,i.getCurrentTransform)(o),o.restore(),o.fillStyle=e}let y=t.lineWidth;const A=t.textMatrixScale;if(0===A||0===y){const e=t.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;e!==a.TextRenderingMode.STROKE&&e!==a.TextRenderingMode.FILL_STROKE||(y=this.getSinglePixelWidth())}else y/=A;1!==l&&(o.scale(l,l),y/=l),o.lineWidth=y;let P,S=0;for(P=0;P<p;++P){const t=e[P];if("number"==typeof t){S+=f*t*n/1e3;continue}let i=!1;const a=(t.isSpace?d:0)+c,r=t.fontChar,u=t.accent;let p,y,A,x=t.width;if(g){const e=t.vmetric||m,s=-(t.vmetric?e[1]:.5*x)*_,i=e[2]*_;x=e?-e[0]:x,p=s/l,y=(S+i)/l}else p=S/l,y=0;if(s.remeasure&&x>0){const e=1e3*o.measureText(r).width/n*l;if(x<e&&this.isFontSubpixelAAEnabled){const t=x/e;i=!0,o.save(),o.scale(t,1),p/=t}else x!==e&&(p+=(x-e)/2e3*n/l)}if(this.contentVisible&&(t.isInFont||s.missingFile))if(v&&!u)o.fillText(r,p,y);else if(this.paintChar(r,p,y,b),u){const e=p+n*u.offset.x/l,t=y-n*u.offset.y/l;this.paintChar(u.fontChar,e,t,b)}A=g?x*_-a*h:x*_+a*h,S+=A,i&&o.restore()}g?t.y-=S:t.x+=S*u,o.restore(),this.compose()}showType3Text(e){const t=this.ctx,s=this.current,i=s.font,r=s.fontSize,n=s.fontDirection,o=i.vertical?1:-1,l=s.charSpacing,c=s.wordSpacing,d=s.textHScale*n,h=s.fontMatrix||a.FONT_IDENTITY_MATRIX,u=e.length;let p,g,f,m;if(s.textRenderingMode!==a.TextRenderingMode.INVISIBLE&&0!==r){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...s.textMatrix),t.translate(s.x,s.y),t.scale(d,n),p=0;p<u;++p){if(g=e[p],"number"==typeof g){m=o*g*r/1e3,this.ctx.translate(m,0),s.x+=m*d;continue}const n=(g.isSpace?c:0)+l,u=i.charProcOperatorList[g.operatorListId];u?(this.contentVisible&&(this.processingType3=g,this.save(),t.scale(r,r),t.transform(...h),this.executeOperatorList(u),this.restore()),f=a.Util.applyTransform([g.width,0],h)[0]*r+n,t.translate(f,0),s.x+=f*d):(0,a.warn)(`Type3 character "${g.operatorListId}" is not available.`)}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,s,i,a,r){this.ctx.rect(s,i,a-s,r-i),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if("TilingPattern"===e[0]){const s=e[1],a=this.baseTransform||(0,i.getCurrentTransform)(this.ctx),n={createCanvasGraphics:e=>new k(e,this.commonObjs,this.objs,this.canvasFactory)};t=new r.TilingPattern(e,s,this.ctx,n,a)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,s){const i=this.selectColor?.(e,t,s)||a.Util.makeHexColor(e,t,s);this.ctx.strokeStyle=i,this.current.strokeColor=i}setFillRGBColor(e,t,s){const i=this.selectColor?.(e,t,s)||a.Util.makeHexColor(e,t,s);this.ctx.fillStyle=i,this.current.fillColor=i,this.current.patternFill=!1}_getPattern(e,t=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=(0,r.getShadingPattern)(this.objs.get(e)),this.cachedPatterns.set(e,s)),t&&(s.matrix=t),s}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const s=this._getPattern(e);t.fillStyle=s.getPattern(t,this,(0,i.getCurrentTransformInverse)(t),r.PathType.SHADING);const n=(0,i.getCurrentTransformInverse)(t);if(n){const e=t.canvas,s=e.width,i=e.height,r=a.Util.applyTransform([0,0],n),o=a.Util.applyTransform([0,i],n),l=a.Util.applyTransform([s,0],n),c=a.Util.applyTransform([s,i],n),d=Math.min(r[0],o[0],l[0],c[0]),h=Math.min(r[1],o[1],l[1],c[1]),u=Math.max(r[0],o[0],l[0],c[0]),p=Math.max(r[1],o[1],l[1],c[1]);this.ctx.fillRect(d,h,u-d,p-h)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,a.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,a.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(e)&&6===e.length&&this.transform(...e),this.baseTransform=(0,i.getCurrentTransform)(this.ctx),t)){const e=t[2]-t[0],s=t[3]-t[1];this.ctx.rect(t[0],t[1],e,s),this.current.updateRectMinMax((0,i.getCurrentTransform)(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||(0,a.info)("TODO: Support non-isolated groups."),e.knockout&&(0,a.warn)("Knockout groups not supported.");const s=(0,i.getCurrentTransform)(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let r=a.Util.getAxialAlignedBoundingBox(e.bbox,(0,i.getCurrentTransform)(t));const n=[0,0,t.canvas.width,t.canvas.height];r=a.Util.intersect(r,n)||[0,0,0,0];const o=Math.floor(r[0]),c=Math.floor(r[1]);let d=Math.max(Math.ceil(r[2])-o,1),h=Math.max(Math.ceil(r[3])-c,1),u=1,p=1;d>l&&(u=d/l,d=l),h>l&&(p=h/l,h=l),this.current.startNewPathAndClipBox([0,0,d,h]);let g="groupAt"+this.groupLevel;e.smask&&(g+="_smask_"+this.smaskCounter++%2);const f=this.cachedCanvases.getCanvas(g,d,h),m=f.context;m.scale(1/u,1/p),m.translate(-o,-c),m.transform(...s),e.smask?this.smaskStack.push({canvas:f.canvas,context:m,offsetX:o,offsetY:c,scaleX:u,scaleY:p,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(o,c),t.scale(u,p),t.save()),v(t,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const e=(0,i.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...e);const s=a.Util.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],e);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(s)}}beginAnnotation(e,t,s,r,n){if(_classPrivateFieldLooseBase(this,T)[T](),b(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(t)&&4===t.length){const r=t[2]-t[0],o=t[3]-t[1];if(n&&this.annotationCanvasMap){(s=s.slice())[4]-=t[0],s[5]-=t[1],(t=t.slice())[0]=t[1]=0,t[2]=r,t[3]=o;const[n,l]=a.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(this.ctx)),{viewportScale:c}=this,d=Math.ceil(r*this.outputScaleX*c),h=Math.ceil(o*this.outputScaleY*c);this.annotationCanvas=this.canvasFactory.create(d,h);const{canvas:u,context:p}=this.annotationCanvas;this.annotationCanvasMap.set(e,u),this.annotationCanvas.savedCtx=this.ctx,this.ctx=p,this.ctx.setTransform(n,0,0,-l,0,o*l),b(this.ctx,this.foregroundColor)}else b(this.ctx,this.foregroundColor),this.ctx.rect(t[0],t[1],r,o),this.ctx.clip(),this.endPath()}this.current=new f(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...s),this.transform(...r)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;(e=this.getObject(e.data,e)).count=t;const s=this.ctx,i=this.processingType3;if(i&&(void 0===i.compiled&&(i.compiled=g(e)),i.compiled))return void i.compiled(s);const a=this._createMaskCanvas(e),r=a.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(r,a.offsetX,a.offsetY),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,s=0,r=0,n,o){if(!this.contentVisible)return;e=this.getObject(e.data,e);const l=this.ctx;l.save();const c=(0,i.getCurrentTransform)(l);l.transform(t,s,r,n,0,0);const d=this._createMaskCanvas(e);l.setTransform(1,0,0,1,0,0);for(let e=0,i=o.length;e<i;e+=2){const i=a.Util.transform(c,[t,s,r,n,o[e],o[e+1]]),[h,u]=a.Util.applyTransform([0,0],i);l.drawImage(d.canvas,h,u)}l.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,s=this.current.fillColor,a=this.current.patternFill;for(const n of e){const{data:e,width:o,height:l,transform:c}=n,d=this.cachedCanvases.getCanvas("maskCanvas",o,l),h=d.context;h.save(),_(h,this.getObject(e,n)),h.globalCompositeOperation="source-in",h.fillStyle=a?s.getPattern(h,this,(0,i.getCurrentTransformInverse)(t),r.PathType.FILL):s,h.fillRect(0,0,o,l),h.restore(),t.save(),t.transform(...c),t.scale(1,-1),p(t,d.canvas,0,0,o,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);t?this.paintInlineImageXObject(t):(0,a.warn)("Dependent image isn't ready yet")}paintImageXObjectRepeat(e,t,s,i){if(!this.contentVisible)return;const r=this.getObject(e);if(!r)return void(0,a.warn)("Dependent image isn't ready yet");const n=r.width,o=r.height,l=[];for(let e=0,a=i.length;e<a;e+=2)l.push({transform:[t,0,0,s,i[e],i[e+1]],x:0,y:0,w:n,h:o});this.paintInlineImageXObjectGroup(r,l)}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,s=e.height,r=this.ctx;let n;if(this.save(),r.scale(1/t,-1/s),"function"==typeof HTMLElement&&e instanceof HTMLElement||!e.data)n=e;else{const i=this.cachedCanvases.getCanvas("inlineImage",t,s);m(i.context,e,this.current.transferMaps),n=i.canvas}const o=this._scaleImage(n,(0,i.getCurrentTransformInverse)(r));r.imageSmoothingEnabled=F((0,i.getCurrentTransform)(r),e.interpolate);const[l,c]=p(r,o.img,0,0,o.paintWidth,o.paintHeight,0,-s,t,s);if(this.imageLayer){const[t,r]=a.Util.applyTransform([0,-s],(0,i.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:e,left:t,top:r,width:l,height:c})}this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const s=this.ctx,r=e.width,n=e.height,o=this.cachedCanvases.getCanvas("inlineImage",r,n);m(o.context,e,this.current.transferMaps);for(const l of t){if(s.save(),s.transform(...l.transform),s.scale(1,-1),p(s,o.canvas,l.x,l.y,l.w,l.h,0,-1,1,1),this.imageLayer){const[t,s]=a.Util.applyTransform([l.x,l.y],(0,i.getCurrentTransform)(this.ctx));this.imageLayer.appendImage({imgData:e,left:t,top:s,width:r,height:n})}s.restore()}this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){"OC"===e?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const s=this.ctx;this.pendingClip&&(t||(this.pendingClip===L?s.clip("evenodd"):s.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),s.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=(0,i.getCurrentTransform)(this.ctx);if(0===e[1]&&0===e[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),s=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(s,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:e}=this.current,t=(0,i.getCurrentTransform)(this.ctx);let s,a;if(0===t[1]&&0===t[2]){const i=Math.abs(t[0]),r=Math.abs(t[3]);if(0===e)s=1/i,a=1/r;else{const t=i*e,n=r*e;s=t<1?1/t:1,a=n<1?1/n:1}}else{const i=Math.abs(t[0]*t[3]-t[2]*t[1]),r=Math.hypot(t[0],t[1]),n=Math.hypot(t[2],t[3]);if(0===e)s=n/i,a=r/i;else{const t=e*i;s=n>t?n/t:1,a=r>t?r/t:1}}this._cachedScaleForStroking=[s,a]}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:s}=this.current,[a,r]=this.getScaleForStroking();if(t.lineWidth=s||1,1===a&&1===r)return void t.stroke();let n,o,l;e&&(n=(0,i.getCurrentTransform)(t),o=t.getLineDash().slice(),l=t.lineDashOffset),t.scale(a,r);const c=Math.max(a,r);t.setLineDash(t.getLineDash().map(e=>e/c)),t.lineDashOffset/=c,t.stroke(),e&&(t.setTransform(...n),t.setLineDash(o),t.lineDashOffset=l)}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}function M(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}t.CanvasGraphics=k;for(const e in a.OPS)void 0!==k.prototype[e]&&(k.prototype[a.OPS[e]]=k.prototype[e])},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TilingPattern=t.PathType=void 0,t.getShadingPattern=function(e){switch(e[0]){case"RadialAxial":return new c(e);case"Mesh":return new u(e);case"Dummy":return new p}throw new Error(`Unknown IR type: ${e[0]}`)};var i=s(1),a=s(8),r=s(3);const n={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function o(e,t){if(!t||r.isNodeJS)return;const s=t[2]-t[0],i=t[3]-t[1],a=new Path2D;a.rect(t[0],t[1],s,i),e.clip(a)}t.PathType=n;class l{constructor(){this.constructor===l&&(0,i.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,i.unreachable)("Abstract method `getPattern` called.")}}class c extends l{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;"axial"===this._type?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const e of this._colorStops)t.addColorStop(e[0],e[1]);return t}getPattern(e,t,s,r){let l;if(r===n.STROKE||r===n.FILL){const n=t.current.getClippedPathBoundingBox(r,(0,a.getCurrentTransform)(e))||[0,0,0,0],c=Math.ceil(n[2]-n[0])||1,d=Math.ceil(n[3]-n[1])||1,h=t.cachedCanvases.getCanvas("pattern",c,d,!0),u=h.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-n[0],-n[1]),s=i.Util.transform(s,[1,0,0,1,n[0],n[1]]),u.transform(...t.baseTransform),this.matrix&&u.transform(...this.matrix),o(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),l=e.createPattern(h.canvas,"no-repeat");const p=new DOMMatrix(s);try{l.setTransform(p)}catch(e){(0,i.warn)(`RadialAxialShadingPattern.getPattern: "${e?.message}".`)}}else o(e,this._bbox),l=this._createGradient(e);return l}}function d(e,t,s,i,a,r,n,o){const l=t.coords,c=t.colors,d=e.data,h=4*e.width;let u;l[s+1]>l[i+1]&&(u=s,s=i,i=u,u=r,r=n,n=u),l[i+1]>l[a+1]&&(u=i,i=a,a=u,u=n,n=o,o=u),l[s+1]>l[i+1]&&(u=s,s=i,i=u,u=r,r=n,n=u);const p=(l[s]+t.offsetX)*t.scaleX,g=(l[s+1]+t.offsetY)*t.scaleY,f=(l[i]+t.offsetX)*t.scaleX,m=(l[i+1]+t.offsetY)*t.scaleY,_=(l[a]+t.offsetX)*t.scaleX,v=(l[a+1]+t.offsetY)*t.scaleY;if(g>=v)return;const b=c[r],y=c[r+1],A=c[r+2],P=c[n],S=c[n+1],x=c[n+2],F=c[o],C=c[o+1],w=c[o+2],E=Math.round(g),L=Math.round(v);let T,k,M,R,O,D,I,B;for(let e=E;e<=L;e++){if(e<m){let t;t=e<g?0:(g-e)/(g-m),T=p-(p-f)*t,k=b-(b-P)*t,M=y-(y-S)*t,R=A-(A-x)*t}else{let t;t=e>v?1:m===v?0:(m-e)/(m-v),T=f-(f-_)*t,k=P-(P-F)*t,M=S-(S-C)*t,R=x-(x-w)*t}let t;t=e<g?0:e>v?1:(g-e)/(g-v),O=p-(p-_)*t,D=b-(b-F)*t,I=y-(y-C)*t,B=A-(A-w)*t;const s=Math.round(Math.min(T,O)),i=Math.round(Math.max(T,O));let a=h*e+4*s;for(let e=s;e<=i;e++)t=(T-e)/(T-O),t<0?t=0:t>1&&(t=1),d[a++]=k-(k-D)*t|0,d[a++]=M-(M-I)*t|0,d[a++]=R-(R-B)*t|0,d[a++]=255}}function h(e,t,s){const i=t.coords,a=t.colors;let r,n;switch(t.type){case"lattice":const o=t.verticesPerRow,l=Math.floor(i.length/o)-1,c=o-1;for(r=0;r<l;r++){let t=r*o;for(let r=0;r<c;r++,t++)d(e,s,i[t],i[t+1],i[t+o],a[t],a[t+1],a[t+o]),d(e,s,i[t+o+1],i[t+1],i[t+o],a[t+o+1],a[t+1],a[t+o])}break;case"triangles":for(r=0,n=i.length;r<n;r+=3)d(e,s,i[r],i[r+1],i[r+2],a[r],a[r+1],a[r+2]);break;default:throw new Error("illegal figure")}}class u extends l{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,s){const i=Math.floor(this._bounds[0]),a=Math.floor(this._bounds[1]),r=Math.ceil(this._bounds[2])-i,n=Math.ceil(this._bounds[3])-a,o=Math.min(Math.ceil(Math.abs(r*e[0]*1.1)),3e3),l=Math.min(Math.ceil(Math.abs(n*e[1]*1.1)),3e3),c=r/o,d=n/l,u={coords:this._coords,colors:this._colors,offsetX:-i,offsetY:-a,scaleX:1/c,scaleY:1/d},p=o+4,g=l+4,f=s.getCanvas("mesh",p,g,!1),m=f.context,_=m.createImageData(o,l);if(t){const e=_.data;for(let s=0,i=e.length;s<i;s+=4)e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=255}for(const e of this._figures)h(_,e,u);return m.putImageData(_,2,2),{canvas:f.canvas,offsetX:i-2*c,offsetY:a-2*d,scaleX:c,scaleY:d}}getPattern(e,t,s,r){let l;if(o(e,this._bbox),r===n.SHADING)l=i.Util.singularValueDecompose2dScale((0,a.getCurrentTransform)(e));else if(l=i.Util.singularValueDecompose2dScale(t.baseTransform),this.matrix){const e=i.Util.singularValueDecompose2dScale(this.matrix);l=[l[0]*e[0],l[1]*e[1]]}const c=this._createMeshCanvas(l,r===n.SHADING?null:this._background,t.cachedCanvases);return r!==n.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(c.offsetX,c.offsetY),e.scale(c.scaleX,c.scaleY),e.createPattern(c.canvas,"no-repeat")}}class p extends l{getPattern(){return"hotpink"}}const g=1,f=2;class m{static get MAX_PATTERN_SIZE(){return(0,i.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(e,t,s,i,a){this.operatorList=e[2],this.matrix=e[3]||[1,0,0,1,0,0],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=s,this.canvasGraphicsFactory=i,this.baseTransform=a}createPatternCanvas(e){const t=this.operatorList,s=this.bbox,r=this.xstep,n=this.ystep,o=this.paintType,l=this.tilingType,c=this.color,d=this.canvasGraphicsFactory;(0,i.info)("TilingType: "+l);const h=s[0],u=s[1],p=s[2],g=s[3],f=i.Util.singularValueDecompose2dScale(this.matrix),m=i.Util.singularValueDecompose2dScale(this.baseTransform),_=[f[0]*m[0],f[1]*m[1]],v=this.getSizeAndScale(r,this.ctx.canvas.width,_[0]),b=this.getSizeAndScale(n,this.ctx.canvas.height,_[1]),y=e.cachedCanvases.getCanvas("pattern",v.size,b.size,!0),A=y.context,P=d.createCanvasGraphics(A);P.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(P,o,c);let S=h,x=u,F=p,C=g;return h<0&&(S=0,F+=Math.abs(h)),u<0&&(x=0,C+=Math.abs(u)),A.translate(-v.scale*S,-b.scale*x),P.transform(v.scale,0,0,b.scale,0,0),A.save(),this.clipBbox(P,S,x,F,C),P.baseTransform=(0,a.getCurrentTransform)(P.ctx),P.executeOperatorList(t),P.endDrawing(),{canvas:y.canvas,scaleX:v.scale,scaleY:b.scale,offsetX:S,offsetY:x}}getSizeAndScale(e,t,s){e=Math.abs(e);const i=Math.max(m.MAX_PATTERN_SIZE,t);let a=Math.ceil(e*s);return a>=i?a=i:s=a/e,{scale:s,size:a}}clipBbox(e,t,s,i,r){const n=i-t,o=r-s;e.ctx.rect(t,s,n,o),e.current.updateRectMinMax((0,a.getCurrentTransform)(e.ctx),[t,s,i,r]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,s){const a=e.ctx,r=e.current;switch(t){case g:const e=this.ctx;a.fillStyle=e.fillStyle,a.strokeStyle=e.strokeStyle,r.fillColor=e.fillStyle,r.strokeColor=e.strokeStyle;break;case f:const n=i.Util.makeHexColor(s[0],s[1],s[2]);a.fillStyle=n,a.strokeStyle=n,r.fillColor=n,r.strokeColor=n;break;default:throw new i.FormatError(`Unsupported paint type: ${t}`)}}getPattern(e,t,s,a){let r=s;a!==n.SHADING&&(r=i.Util.transform(r,t.baseTransform),this.matrix&&(r=i.Util.transform(r,this.matrix)));const o=this.createPatternCanvas(t);let l=new DOMMatrix(r);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const c=e.createPattern(o.canvas,"repeat");try{c.setTransform(l)}catch(e){(0,i.warn)(`TilingPattern.getPattern: "${e?.message}".`)}return c}}t.TilingPattern=m},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applyMaskImageData=function({src:e,srcPos:t=0,dest:s,destPos:a=0,width:r,height:n,inverseDecode:o=!1}){const l=i.FeatureTest.isLittleEndian?4278190080:255,[c,d]=o?[0,l]:[l,0],h=r>>3,u=7&r,p=e.length;s=new Uint32Array(s.buffer);for(let i=0;i<n;i++){for(const i=t+h;t<i;t++){const i=t<p?e[t]:255;s[a++]=128&i?d:c,s[a++]=64&i?d:c,s[a++]=32&i?d:c,s[a++]=16&i?d:c,s[a++]=8&i?d:c,s[a++]=4&i?d:c,s[a++]=2&i?d:c,s[a++]=1&i?d:c}if(0===u)continue;const i=t<p?e[t++]:255;for(let e=0;e<u;e++)s[a++]=i&1<<7-e?d:c}return{srcPos:t,destPos:a}};var i=s(1)},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;const s=Object.create(null);t.GlobalWorkerOptions=s,s.workerPort=void 0===s.workerPort?null:s.workerPort,s.workerSrc=void 0===s.workerSrc?"":s.workerSrc},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var i=s(1);const a=1,r=2,n=1,o=2,l=3,c=4,d=5,h=6,u=7,p=8;function g(e){switch(e instanceof Error||"object"==typeof e&&null!==e||(0,i.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),e.name){case"AbortException":return new i.AbortException(e.message);case"MissingPDFException":return new i.MissingPDFException(e.message);case"PasswordException":return new i.PasswordException(e.message,e.code);case"UnexpectedResponseException":return new i.UnexpectedResponseException(e.message,e.status);case"UnknownErrorException":return new i.UnknownErrorException(e.message,e.details);default:return new i.UnknownErrorException(e.message,e.toString())}}t.MessageHandler=class{constructor(e,t,s){this.sourceName=e,this.targetName=t,this.comObj=s,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=e=>{const t=e.data;if(t.targetName!==this.sourceName)return;if(t.stream)return void this._processStreamMessage(t);if(t.callback){const e=t.callbackId,s=this.callbackCapabilities[e];if(!s)throw new Error(`Cannot resolve callback ${e}`);if(delete this.callbackCapabilities[e],t.callback===a)s.resolve(t.data);else{if(t.callback!==r)throw new Error("Unexpected callback case");s.reject(g(t.reason))}return}const i=this.actionHandler[t.action];if(!i)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const e=this.sourceName,n=t.sourceName;return void new Promise(function(e){e(i(t.data))}).then(function(i){s.postMessage({sourceName:e,targetName:n,callback:a,callbackId:t.callbackId,data:i})},function(i){s.postMessage({sourceName:e,targetName:n,callback:r,callbackId:t.callbackId,reason:g(i)})})}t.streamId?this._createStreamSink(t):i(t.data)},s.addEventListener("message",this._onComObjOnMessage)}on(e,t){const s=this.actionHandler;if(s[e])throw new Error(`There is already an actionName called "${e}"`);s[e]=t}send(e,t,s){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},s)}sendWithPromise(e,t,s){const a=this.callbackId++,r=(0,i.createPromiseCapability)();this.callbackCapabilities[a]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:a,data:t},s)}catch(e){r.reject(e)}return r.promise}sendWithStream(e,t,s,a){const r=this.streamId++,o=this.sourceName,l=this.targetName,c=this.comObj;return new ReadableStream({start:s=>{const n=(0,i.createPromiseCapability)();return this.streamControllers[r]={controller:s,startCall:n,pullCall:null,cancelCall:null,isClosed:!1},c.postMessage({sourceName:o,targetName:l,action:e,streamId:r,data:t,desiredSize:s.desiredSize},a),n.promise},pull:e=>{const t=(0,i.createPromiseCapability)();return this.streamControllers[r].pullCall=t,c.postMessage({sourceName:o,targetName:l,stream:h,streamId:r,desiredSize:e.desiredSize}),t.promise},cancel:e=>{(0,i.assert)(e instanceof Error,"cancel must have a valid reason");const t=(0,i.createPromiseCapability)();return this.streamControllers[r].cancelCall=t,this.streamControllers[r].isClosed=!0,c.postMessage({sourceName:o,targetName:l,stream:n,streamId:r,reason:g(e)}),t.promise}},s)}_createStreamSink(e){const t=e.streamId,s=this.sourceName,a=e.sourceName,r=this.comObj,n=this,o=this.actionHandler[e.action],h={enqueue(e,n=1,o){if(this.isCancelled)return;const l=this.desiredSize;this.desiredSize-=n,l>0&&this.desiredSize<=0&&(this.sinkCapability=(0,i.createPromiseCapability)(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:s,targetName:a,stream:c,streamId:t,chunk:e},o)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:a,stream:l,streamId:t}),delete n.streamSinks[t])},error(e){(0,i.assert)(e instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:s,targetName:a,stream:d,streamId:t,reason:g(e)}))},sinkCapability:(0,i.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,new Promise(function(t){t(o(e.data,h))}).then(function(){r.postMessage({sourceName:s,targetName:a,stream:p,streamId:t,success:!0})},function(e){r.postMessage({sourceName:s,targetName:a,stream:p,streamId:t,reason:g(e)})})}_processStreamMessage(e){const t=e.streamId,s=this.sourceName,a=e.sourceName,r=this.comObj,f=this.streamControllers[t],m=this.streamSinks[t];switch(e.stream){case p:e.success?f.startCall.resolve():f.startCall.reject(g(e.reason));break;case u:e.success?f.pullCall.resolve():f.pullCall.reject(g(e.reason));break;case h:if(!m){r.postMessage({sourceName:s,targetName:a,stream:u,streamId:t,success:!0});break}m.desiredSize<=0&&e.desiredSize>0&&m.sinkCapability.resolve(),m.desiredSize=e.desiredSize,new Promise(function(e){e(m.onPull&&m.onPull())}).then(function(){r.postMessage({sourceName:s,targetName:a,stream:u,streamId:t,success:!0})},function(e){r.postMessage({sourceName:s,targetName:a,stream:u,streamId:t,reason:g(e)})});break;case c:if((0,i.assert)(f,"enqueue should have stream controller"),f.isClosed)break;f.controller.enqueue(e.chunk);break;case l:if((0,i.assert)(f,"close should have stream controller"),f.isClosed)break;f.isClosed=!0,f.controller.close(),this._deleteStreamController(f,t);break;case d:(0,i.assert)(f,"error should have stream controller"),f.controller.error(g(e.reason)),this._deleteStreamController(f,t);break;case o:e.success?f.cancelCall.resolve():f.cancelCall.reject(g(e.reason)),this._deleteStreamController(f,t);break;case n:if(!m)break;new Promise(function(t){t(m.onCancel&&m.onCancel(g(e.reason)))}).then(function(){r.postMessage({sourceName:s,targetName:a,stream:o,streamId:t,success:!0})},function(e){r.postMessage({sourceName:s,targetName:a,stream:o,streamId:t,reason:g(e)})}),m.sinkCapability.reject(g(e.reason)),m.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(e,t){await Promise.allSettled([e.startCall&&e.startCall.promise,e.pullCall&&e.pullCall.promise,e.cancelCall&&e.cancelCall.promise]),delete this.streamControllers[t]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var i=s(1);t.Metadata=class{#A;#P;constructor({parsedData:e,rawData:t}){this.#A=e,this.#P=t}getRaw(){return this.#P}get(e){return this.#A.get(e)??null}getAll(){return(0,i.objectFromMap)(this.#A)}has(e){return this.#A.has(e)}}},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionalContentConfig=void 0;var i=s(1);const a=Symbol("INTERNAL");class r{#S=!0;constructor(e,t){this.name=e,this.intent=t}get visible(){return this.#S}_setVisible(e,t){e!==a&&(0,i.unreachable)("Internal method `_setVisible` called."),this.#S=t}}var n=_classPrivateFieldLooseKey("cachedHasInitialVisibility"),o=_classPrivateFieldLooseKey("groups"),l=_classPrivateFieldLooseKey("initialVisibility"),c=_classPrivateFieldLooseKey("order"),d=_classPrivateFieldLooseKey("evaluateVisibilityExpression");function h(e){const t=e.length;if(t<2)return!0;const s=e[0];for(let a=1;a<t;a++){const t=e[a];let r;if(Array.isArray(t))r=_classPrivateFieldLooseBase(this,d)[d](t);else{if(!_classPrivateFieldLooseBase(this,o)[o].has(t))return(0,i.warn)(`Optional content group not found: ${t}`),!0;r=_classPrivateFieldLooseBase(this,o)[o].get(t).visible}switch(s){case"And":if(!r)return!1;break;case"Or":if(r)return!0;break;case"Not":return!r;default:return!0}}return"And"===s}t.OptionalContentConfig=class{constructor(e){if(Object.defineProperty(this,d,{value:h}),Object.defineProperty(this,n,{writable:!0,value:!0}),Object.defineProperty(this,o,{writable:!0,value:new Map}),Object.defineProperty(this,l,{writable:!0,value:null}),Object.defineProperty(this,c,{writable:!0,value:null}),this.name=null,this.creator=null,null!==e){this.name=e.name,this.creator=e.creator,_classPrivateFieldLooseBase(this,c)[c]=e.order;for(const t of e.groups)_classPrivateFieldLooseBase(this,o)[o].set(t.id,new r(t.name,t.intent));if("OFF"===e.baseState)for(const e of _classPrivateFieldLooseBase(this,o)[o].values())e._setVisible(a,!1);for(const t of e.on)_classPrivateFieldLooseBase(this,o)[o].get(t)._setVisible(a,!0);for(const t of e.off)_classPrivateFieldLooseBase(this,o)[o].get(t)._setVisible(a,!1);_classPrivateFieldLooseBase(this,l)[l]=new Map;for(const[e,t]of _classPrivateFieldLooseBase(this,o)[o])_classPrivateFieldLooseBase(this,l)[l].set(e,t.visible)}}isVisible(e){if(0===_classPrivateFieldLooseBase(this,o)[o].size)return!0;if(!e)return(0,i.warn)("Optional content group not defined."),!0;if("OCG"===e.type)return _classPrivateFieldLooseBase(this,o)[o].has(e.id)?_classPrivateFieldLooseBase(this,o)[o].get(e.id).visible:((0,i.warn)(`Optional content group not found: ${e.id}`),!0);if("OCMD"===e.type){if(e.expression)return _classPrivateFieldLooseBase(this,d)[d](e.expression);if(!e.policy||"AnyOn"===e.policy){for(const t of e.ids){if(!_classPrivateFieldLooseBase(this,o)[o].has(t))return(0,i.warn)(`Optional content group not found: ${t}`),!0;if(_classPrivateFieldLooseBase(this,o)[o].get(t).visible)return!0}return!1}if("AllOn"===e.policy){for(const t of e.ids){if(!_classPrivateFieldLooseBase(this,o)[o].has(t))return(0,i.warn)(`Optional content group not found: ${t}`),!0;if(!_classPrivateFieldLooseBase(this,o)[o].get(t).visible)return!1}return!0}if("AnyOff"===e.policy){for(const t of e.ids){if(!_classPrivateFieldLooseBase(this,o)[o].has(t))return(0,i.warn)(`Optional content group not found: ${t}`),!0;if(!_classPrivateFieldLooseBase(this,o)[o].get(t).visible)return!0}return!1}if("AllOff"===e.policy){for(const t of e.ids){if(!_classPrivateFieldLooseBase(this,o)[o].has(t))return(0,i.warn)(`Optional content group not found: ${t}`),!0;if(_classPrivateFieldLooseBase(this,o)[o].get(t).visible)return!1}return!0}return(0,i.warn)(`Unknown optional content policy ${e.policy}.`),!0}return(0,i.warn)(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0){_classPrivateFieldLooseBase(this,o)[o].has(e)?(_classPrivateFieldLooseBase(this,o)[o].get(e)._setVisible(a,!!t),_classPrivateFieldLooseBase(this,n)[n]=null):(0,i.warn)(`Optional content group not found: ${e}`)}get hasInitialVisibility(){if(null!==_classPrivateFieldLooseBase(this,n)[n])return _classPrivateFieldLooseBase(this,n)[n];for(const[e,t]of _classPrivateFieldLooseBase(this,o)[o]){const s=_classPrivateFieldLooseBase(this,l)[l].get(e);if(t.visible!==s)return _classPrivateFieldLooseBase(this,n)[n]=!1}return _classPrivateFieldLooseBase(this,n)[n]=!0}getOrder(){return _classPrivateFieldLooseBase(this,o)[o].size?_classPrivateFieldLooseBase(this,c)[c]?_classPrivateFieldLooseBase(this,c)[c].slice():[..._classPrivateFieldLooseBase(this,o)[o].keys()]:null}getGroups(){return _classPrivateFieldLooseBase(this,o)[o].size>0?(0,i.objectFromMap)(_classPrivateFieldLooseBase(this,o)[o]):null}getGroup(e){return _classPrivateFieldLooseBase(this,o)[o].get(e)||null}}},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var i=s(1),a=s(8);t.PDFDataTransportStream=class{constructor(e,t){(0,i.assert)(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=e.progressiveDone||!1,this._contentDispositionFilename=e.contentDispositionFilename||null;const s=e.initialData;if(s?.length>0){const e=new Uint8Array(s).buffer;this._queuedChunks.push(e)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._contentLength=e.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((e,t)=>{this._onReceiveData({begin:e,chunk:t})}),this._pdfDataRangeTransport.addProgressListener((e,t)=>{this._onProgress({loaded:e,total:t})}),this._pdfDataRangeTransport.addProgressiveReadListener(e=>{this._onReceiveData({chunk:e})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(e){const t=new Uint8Array(e.chunk).buffer;if(void 0===e.begin)this._fullRequestReader?this._fullRequestReader._enqueue(t):this._queuedChunks.push(t);else{const s=this._rangeReaders.some(function(s){return s._begin===e.begin&&(s._enqueue(t),!0)});(0,i.assert)(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){if(void 0===e.total){const t=this._rangeReaders[0];t?.onProgress&&t.onProgress({loaded:e.loaded})}else{const t=this._fullRequestReader;t?.onProgress&&t.onProgress({loaded:e.loaded,total:e.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){(0,i.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new r(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new n(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader&&this._fullRequestReader.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}};class r{constructor(e,t,s=!1,i=null){this._stream=e,this._done=s||!1,this._filename=(0,a.isPdfFile)(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const e of this._queuedChunks)this._loaded+=e.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=(0,i.createPromiseCapability)();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class n{constructor(e,t,s){this._stream=e,this._begin=t,this._end=s,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(0===this._requests.length)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=(0,i.createPromiseCapability)();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaText=void 0;class s{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};return(function e(i){if(!i)return;let a=null;const r=i.name;if("#text"===r)a=i.value;else{if(!s.shouldBuildText(r))return;i?.attributes?.textContent?a=i.attributes.textContent:i.value&&(a=i.value)}if(null!==a&&t.push({str:a}),i.children)for(const t of i.children)e(t)})(e),i}static shouldBuildText(e){return!("textarea"===e||"input"===e||"option"===e||"select"===e)}}t.XfaText=s},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NodeStandardFontDataFactory=t.NodeCanvasFactory=t.NodeCMapReaderFactory=void 0;var i=s(9);const a=function(e){return new Promise((t,s)=>{require(_dependencyMap[2]).readFile(e,(e,i)=>{!e&&i?t(new Uint8Array(i)):s(new Error(e))})})};class r extends i.BaseCanvasFactory{_createCanvas(e,t){return require(_dependencyMap[3]).createCanvas(e,t)}}t.NodeCanvasFactory=r;class n extends i.BaseCMapReaderFactory{_fetchData(e,t){return a(e).then(e=>({cMapData:e,compressionType:t}))}}t.NodeCMapReaderFactory=n;class o extends i.BaseStandardFontDataFactory{_fetchData(e){return a(e)}}t.NodeStandardFontDataFactory=o},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditorLayer=void 0;var i=s(7),a=s(1),r=s(23),n=s(24),o=_classPrivateFieldLooseKey("accessibilityManager"),l=_classPrivateFieldLooseKey("allowClick"),c=_classPrivateFieldLooseKey("boundPointerup"),d=_classPrivateFieldLooseKey("boundPointerdown"),h=_classPrivateFieldLooseKey("editors"),u=_classPrivateFieldLooseKey("hadPointerDown"),p=_classPrivateFieldLooseKey("isCleaningUp"),g=_classPrivateFieldLooseKey("uiManager"),f=_classPrivateFieldLooseKey("changeParent"),m=_classPrivateFieldLooseKey("createNewEditor"),_=_classPrivateFieldLooseKey("createAndAddNewEditor"),v=_classPrivateFieldLooseKey("cleanup");class b{constructor(e){Object.defineProperty(this,v,{value:S}),Object.defineProperty(this,_,{value:P}),Object.defineProperty(this,m,{value:A}),Object.defineProperty(this,f,{value:y}),Object.defineProperty(this,o,{writable:!0,value:void 0}),Object.defineProperty(this,l,{writable:!0,value:!1}),Object.defineProperty(this,c,{writable:!0,value:this.pointerup.bind(this)}),Object.defineProperty(this,d,{writable:!0,value:this.pointerdown.bind(this)}),Object.defineProperty(this,h,{writable:!0,value:new Map}),Object.defineProperty(this,u,{writable:!0,value:!1}),Object.defineProperty(this,p,{writable:!0,value:!1}),Object.defineProperty(this,g,{writable:!0,value:void 0}),b._initialized||(b._initialized=!0,r.FreeTextEditor.initialize(e.l10n),n.InkEditor.initialize(e.l10n),e.uiManager.registerEditorTypes([r.FreeTextEditor,n.InkEditor])),_classPrivateFieldLooseBase(this,g)[g]=e.uiManager,this.annotationStorage=e.annotationStorage,this.pageIndex=e.pageIndex,this.div=e.div,_classPrivateFieldLooseBase(this,o)[o]=e.accessibilityManager,_classPrivateFieldLooseBase(this,g)[g].addLayer(this)}updateToolbar(e){_classPrivateFieldLooseBase(this,g)[g].updateToolbar(e)}updateMode(e=_classPrivateFieldLooseBase(this,g)[g].getMode()){_classPrivateFieldLooseBase(this,v)[v](),e===a.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),_classPrivateFieldLooseBase(this,g)[g].unselectAll()}addInkEditorIfNeeded(e){if(e||_classPrivateFieldLooseBase(this,g)[g].getMode()===a.AnnotationEditorType.INK){if(!e)for(const e of _classPrivateFieldLooseBase(this,h)[h].values())if(e.isEmpty())return void e.setInBackground();_classPrivateFieldLooseBase(this,_)[_]({offsetX:0,offsetY:0}).setInBackground()}}setEditingState(e){_classPrivateFieldLooseBase(this,g)[g].setEditingState(e)}addCommands(e){_classPrivateFieldLooseBase(this,g)[g].addCommands(e)}enable(){this.div.style.pointerEvents="auto";for(const e of _classPrivateFieldLooseBase(this,h)[h].values())e.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const e of _classPrivateFieldLooseBase(this,h)[h].values())e.disableEditing()}setActiveEditor(e){_classPrivateFieldLooseBase(this,g)[g].getActive()!==e&&_classPrivateFieldLooseBase(this,g)[g].setActiveEditor(e)}enableClick(){this.div.addEventListener("pointerdown",_classPrivateFieldLooseBase(this,d)[d]),this.div.addEventListener("pointerup",_classPrivateFieldLooseBase(this,c)[c])}disableClick(){this.div.removeEventListener("pointerdown",_classPrivateFieldLooseBase(this,d)[d]),this.div.removeEventListener("pointerup",_classPrivateFieldLooseBase(this,c)[c])}attach(e){_classPrivateFieldLooseBase(this,h)[h].set(e.id,e)}detach(e){_classPrivateFieldLooseBase(this,h)[h].delete(e.id),_classPrivateFieldLooseBase(this,o)[o]?.removePointerInTextLayer(e.contentDiv)}remove(e){_classPrivateFieldLooseBase(this,g)[g].removeEditor(e),this.detach(e),this.annotationStorage.remove(e.id),e.div.style.display="none",setTimeout(()=>{e.div.style.display="",e.div.remove(),e.isAttachedToDOM=!1,document.activeElement===document.body&&_classPrivateFieldLooseBase(this,g)[g].focusMainContainer()},0),_classPrivateFieldLooseBase(this,p)[p]||this.addInkEditorIfNeeded(!1)}add(e){if(_classPrivateFieldLooseBase(this,f)[f](e),_classPrivateFieldLooseBase(this,g)[g].addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}this.moveEditorInDOM(e),e.onceAdded(),this.addToAnnotationStorage(e)}moveEditorInDOM(e){_classPrivateFieldLooseBase(this,o)[o]?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addToAnnotationStorage(e){e.isEmpty()||this.annotationStorage.has(e.id)||this.annotationStorage.setValue(e.id,e)}addOrRebuild(e){e.needsToBeRebuilt()?e.rebuild():this.add(e)}addANewEditor(e){this.addCommands({cmd:()=>{this.addOrRebuild(e)},undo:()=>{e.remove()},mustExec:!0})}addUndoableEditor(e){this.addCommands({cmd:()=>{this.addOrRebuild(e)},undo:()=>{e.remove()},mustExec:!1})}getNextId(){return _classPrivateFieldLooseBase(this,g)[g].getId()}deserialize(e){switch(e.annotationType){case a.AnnotationEditorType.FREETEXT:return r.FreeTextEditor.deserialize(e,this);case a.AnnotationEditorType.INK:return n.InkEditor.deserialize(e,this)}return null}setSelected(e){_classPrivateFieldLooseBase(this,g)[g].setSelected(e)}toggleSelected(e){_classPrivateFieldLooseBase(this,g)[g].toggleSelected(e)}isSelected(e){return _classPrivateFieldLooseBase(this,g)[g].isSelected(e)}unselect(e){_classPrivateFieldLooseBase(this,g)[g].unselect(e)}pointerup(e){const t=i.KeyboardManager.platform.isMac;0!==e.button||e.ctrlKey&&t||e.target===this.div&&_classPrivateFieldLooseBase(this,u)[u]&&(_classPrivateFieldLooseBase(this,u)[u]=!1,_classPrivateFieldLooseBase(this,l)[l]?_classPrivateFieldLooseBase(this,_)[_](e):_classPrivateFieldLooseBase(this,l)[l]=!0)}pointerdown(e){const t=i.KeyboardManager.platform.isMac;if(0!==e.button||e.ctrlKey&&t)return;if(e.target!==this.div)return;_classPrivateFieldLooseBase(this,u)[u]=!0;const s=_classPrivateFieldLooseBase(this,g)[g].getActive();_classPrivateFieldLooseBase(this,l)[l]=!s||s.isEmpty()}drop(e){const t=e.dataTransfer.getData("text/plain"),s=_classPrivateFieldLooseBase(this,g)[g].getEditor(t);if(!s)return;e.preventDefault(),e.dataTransfer.dropEffect="move",_classPrivateFieldLooseBase(this,f)[f](s);const i=this.div.getBoundingClientRect(),a=e.clientX-i.x,r=e.clientY-i.y;s.translate(a-s.startX,r-s.startY),this.moveEditorInDOM(s),s.div.focus()}dragover(e){e.preventDefault()}destroy(){_classPrivateFieldLooseBase(this,g)[g].getActive()?.parent===this&&_classPrivateFieldLooseBase(this,g)[g].setActiveEditor(null);for(const e of _classPrivateFieldLooseBase(this,h)[h].values())_classPrivateFieldLooseBase(this,o)[o]?.removePointerInTextLayer(e.contentDiv),e.isAttachedToDOM=!1,e.div.remove(),e.parent=null;this.div=null,_classPrivateFieldLooseBase(this,h)[h].clear(),_classPrivateFieldLooseBase(this,g)[g].removeLayer(this)}render(e){this.viewport=e.viewport,(0,i.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();for(const e of _classPrivateFieldLooseBase(this,g)[g].getEditors(this.pageIndex))this.add(e);this.updateMode()}update(e){this.viewport=e.viewport,this.setDimensions(),this.updateMode()}get scaleFactor(){return this.viewport.scale}get pageDimensions(){const[e,t,s,i]=this.viewport.viewBox;return[s-e,i-t]}get viewportBaseDimensions(){const{width:e,height:t,rotation:s}=this.viewport;return s%180==0?[e,t]:[t,e]}setDimensions(){const{width:e,height:t,rotation:s}=this.viewport,i=s%180!=0,a=Math.floor(e)+"px",r=Math.floor(t)+"px";this.div.style.width=i?r:a,this.div.style.height=i?a:r,this.div.setAttribute("data-main-rotation",s)}}function y(e){e.parent!==this&&(this.attach(e),e.pageIndex=this.pageIndex,e.parent?.detach(e),e.parent=this,e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}function A(e){switch(_classPrivateFieldLooseBase(this,g)[g].getMode()){case a.AnnotationEditorType.FREETEXT:return new r.FreeTextEditor(e);case a.AnnotationEditorType.INK:return new n.InkEditor(e)}return null}function P(e){const t=this.getNextId(),s=_classPrivateFieldLooseBase(this,m)[m]({parent:this,id:t,x:e.offsetX,y:e.offsetY});return s&&this.add(s),s}function S(){_classPrivateFieldLooseBase(this,p)[p]=!0;for(const e of _classPrivateFieldLooseBase(this,h)[h].values())e.isEmpty()&&e.remove();_classPrivateFieldLooseBase(this,p)[p]=!1}b._initialized=!1,t.AnnotationEditorLayer=b},(e,t,s)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.FreeTextEditor=void 0;var a=s(1),r=s(7),n=s(6),o=_classPrivateFieldLooseKey("boundEditorDivBlur"),l=_classPrivateFieldLooseKey("boundEditorDivFocus"),c=_classPrivateFieldLooseKey("boundEditorDivKeydown"),d=_classPrivateFieldLooseKey("color"),h=_classPrivateFieldLooseKey("content"),u=_classPrivateFieldLooseKey("hasAlreadyBeenCommitted"),p=_classPrivateFieldLooseKey("fontSize"),g=_classPrivateFieldLooseKey("updateFontSize"),f=_classPrivateFieldLooseKey("updateColor"),m=_classPrivateFieldLooseKey("extractText"),_=_classPrivateFieldLooseKey("setEditorDimensions");class v extends n.AnnotationEditor{constructor(e){super(Object.assign({},e,{name:"freeTextEditor"})),Object.defineProperty(this,_,{value:P}),Object.defineProperty(this,m,{value:A}),Object.defineProperty(this,f,{value:y}),Object.defineProperty(this,g,{value:b}),Object.defineProperty(this,o,{writable:!0,value:this.editorDivBlur.bind(this)}),Object.defineProperty(this,l,{writable:!0,value:this.editorDivFocus.bind(this)}),Object.defineProperty(this,c,{writable:!0,value:this.editorDivKeydown.bind(this)}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,h,{writable:!0,value:""}),Object.defineProperty(this,u,{writable:!0,value:!1}),Object.defineProperty(this,p,{writable:!0,value:void 0}),_classPrivateFieldLooseBase(this,d)[d]=e.color||v._defaultColor||n.AnnotationEditor._defaultLineColor,_classPrivateFieldLooseBase(this,p)[p]=e.fontSize||v._defaultFontSize}static initialize(e){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map(t=>[t,e.get(t)]));const t=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(t.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case a.AnnotationEditorParamsType.FREETEXT_SIZE:v._defaultFontSize=t;break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:v._defaultColor=t}}updateParams(e,t){switch(e){case a.AnnotationEditorParamsType.FREETEXT_SIZE:_classPrivateFieldLooseBase(this,g)[g](t);break;case a.AnnotationEditorParamsType.FREETEXT_COLOR:_classPrivateFieldLooseBase(this,f)[f](t)}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,v._defaultFontSize],[a.AnnotationEditorParamsType.FREETEXT_COLOR,v._defaultColor||n.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.FREETEXT_SIZE,_classPrivateFieldLooseBase(this,p)[p]],[a.AnnotationEditorParamsType.FREETEXT_COLOR,_classPrivateFieldLooseBase(this,d)[d]]]}getInitialTranslation(){return[-v._internalPadding*this.parent.scaleFactor,-(v._internalPadding+_classPrivateFieldLooseBase(this,p)[p])*this.parent.scaleFactor]}rebuild(){super.rebuild(),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(a.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",_classPrivateFieldLooseBase(this,c)[c]),this.editorDiv.addEventListener("focus",_classPrivateFieldLooseBase(this,l)[l]),this.editorDiv.addEventListener("blur",_classPrivateFieldLooseBase(this,o)[o]))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",_classPrivateFieldLooseBase(this,c)[c]),this.editorDiv.removeEventListener("focus",_classPrivateFieldLooseBase(this,l)[l]),this.editorDiv.removeEventListener("blur",_classPrivateFieldLooseBase(this,o)[o]),this.div.focus(),this.isEditing=!1)}focusin(e){super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}remove(){this.isEditing=!1,this.parent.setEditingState(!0),super.remove()}commit(){super.commit(),_classPrivateFieldLooseBase(this,u)[u]||(_classPrivateFieldLooseBase(this,u)[u]=!0,this.parent.addUndoableEditor(this)),this.disableEditMode(),_classPrivateFieldLooseBase(this,h)[h]=_classPrivateFieldLooseBase(this,m)[m]().trimEnd(),_classPrivateFieldLooseBase(this,_)[_]()}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(e){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&"Enter"===e.key&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(e){v._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",`${this.id}-editor`),this.enableEditing(),v._l10nPromise.get("editor_free_text_aria_label").then(e=>this.editorDiv?.setAttribute("aria-label",e)),v._l10nPromise.get("free_text_default_content").then(e=>this.editorDiv?.setAttribute("default-content",e)),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${_classPrivateFieldLooseBase(this,p)[p]}px * var(--scale-factor))`,s.color=_classPrivateFieldLooseBase(this,d)[d],this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,r.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[s,i]=this.parent.viewportBaseDimensions;this.setAt(e*s,t*i,this.width*s,this.height*i);for(const e of _classPrivateFieldLooseBase(this,h)[h].split("\n")){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(e,t){const s=super.deserialize(e,t);return _classPrivateFieldLooseBase(s,p)[p]=e.fontSize,_classPrivateFieldLooseBase(s,d)[d]=a.Util.makeHexColor(...e.color),_classPrivateFieldLooseBase(s,h)[h]=e.value,s}serialize(){if(this.isEmpty())return null;const e=v._internalPadding*this.parent.scaleFactor,t=this.getRect(e,e),s=n.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:a.AnnotationEditorType.FREETEXT,color:s,fontSize:_classPrivateFieldLooseBase(this,p)[p],value:_classPrivateFieldLooseBase(this,h)[h],pageIndex:this.parent.pageIndex,rect:t,rotation:this.rotation}}}function b(e){const t=e=>{this.editorDiv.style.fontSize=`calc(${e}px * var(--scale-factor))`,this.translate(0,-(e-_classPrivateFieldLooseBase(this,p)[p])*this.parent.scaleFactor),_classPrivateFieldLooseBase(this,p)[p]=e,_classPrivateFieldLooseBase(this,_)[_]()},s=_classPrivateFieldLooseBase(this,p)[p];this.parent.addCommands({cmd:()=>{t(e)},undo:()=>{t(s)},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}function y(e){const t=_classPrivateFieldLooseBase(this,d)[d];this.parent.addCommands({cmd:()=>{_classPrivateFieldLooseBase(this,d)[d]=e,this.editorDiv.style.color=e},undo:()=>{_classPrivateFieldLooseBase(this,d)[d]=t,this.editorDiv.style.color=t},mustExec:!0,type:a.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function A(){const e=this.editorDiv.getElementsByTagName("div");if(0===e.length)return this.editorDiv.innerText;const t=[];for(let s=0,i=e.length;s<i;s++){const i=e[s].firstChild;"#text"===i?.nodeName?t.push(i.data):t.push("")}return t.join("\n")}function P(){const[e,t]=this.parent.viewportBaseDimensions,s=this.div.getBoundingClientRect();this.width=s.width/e,this.height=s.height/t}i=v,v._freeTextDefaultContent="",v._internalPadding=0,v._defaultColor=null,v._defaultFontSize=10,v._keyboardManager=new r.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],i.prototype.commitOrRemove]]),v._type="freetext",t.FreeTextEditor=v},(e,t,s)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.InkEditor=void 0,Object.defineProperty(t,"fitCurve",{enumerable:!0,get:function(){return n.fitCurve}});var a=s(1),r=s(6),n=s(25),o=s(7);const l=16;var c=_classPrivateFieldLooseKey("aspectRatio"),d=_classPrivateFieldLooseKey("baseHeight"),h=_classPrivateFieldLooseKey("baseWidth"),u=_classPrivateFieldLooseKey("boundCanvasPointermove"),p=_classPrivateFieldLooseKey("boundCanvasPointerleave"),g=_classPrivateFieldLooseKey("boundCanvasPointerup"),f=_classPrivateFieldLooseKey("boundCanvasPointerdown"),m=_classPrivateFieldLooseKey("disableEditing"),_=_classPrivateFieldLooseKey("isCanvasInitialized"),v=_classPrivateFieldLooseKey("lastPoint"),b=_classPrivateFieldLooseKey("observer"),y=_classPrivateFieldLooseKey("realWidth"),A=_classPrivateFieldLooseKey("realHeight"),P=_classPrivateFieldLooseKey("requestFrameCallback"),S=_classPrivateFieldLooseKey("updateThickness"),x=_classPrivateFieldLooseKey("updateColor"),F=_classPrivateFieldLooseKey("updateOpacity"),C=_classPrivateFieldLooseKey("getInitialBBox"),w=_classPrivateFieldLooseKey("setStroke"),E=_classPrivateFieldLooseKey("startDrawing"),L=_classPrivateFieldLooseKey("draw"),T=_classPrivateFieldLooseKey("stopDrawing"),k=_classPrivateFieldLooseKey("redraw"),M=_classPrivateFieldLooseKey("endDrawing"),R=_classPrivateFieldLooseKey("createCanvas"),O=_classPrivateFieldLooseKey("createObserver"),D=_classPrivateFieldLooseKey("setCanvasDims"),I=_classPrivateFieldLooseKey("setScaleFactor"),B=_classPrivateFieldLooseKey("updateTransform"),N=_classPrivateFieldLooseKey("buildPath2D"),j=_classPrivateFieldLooseKey("serializePaths"),U=_classPrivateFieldLooseKey("extractPointsOnBezier"),q=_classPrivateFieldLooseKey("isAlmostFlat"),W=_classPrivateFieldLooseKey("getBbox"),K=_classPrivateFieldLooseKey("getPadding"),G=_classPrivateFieldLooseKey("fitToContent"),H=_classPrivateFieldLooseKey("setMinDims");class z extends r.AnnotationEditor{constructor(e){super(Object.assign({},e,{name:"inkEditor"})),Object.defineProperty(this,H,{value:ge}),Object.defineProperty(this,G,{value:pe}),Object.defineProperty(this,K,{value:ue}),Object.defineProperty(this,W,{value:he}),Object.defineProperty(this,q,{value:de}),Object.defineProperty(this,U,{value:ce}),Object.defineProperty(this,j,{value:le}),Object.defineProperty(this,B,{value:oe}),Object.defineProperty(this,I,{value:ne}),Object.defineProperty(this,D,{value:re}),Object.defineProperty(this,O,{value:ae}),Object.defineProperty(this,R,{value:ie}),Object.defineProperty(this,M,{value:se}),Object.defineProperty(this,k,{value:te}),Object.defineProperty(this,T,{value:ee}),Object.defineProperty(this,L,{value:Z}),Object.defineProperty(this,E,{value:Q}),Object.defineProperty(this,w,{value:J}),Object.defineProperty(this,C,{value:Y}),Object.defineProperty(this,F,{value:$}),Object.defineProperty(this,x,{value:X}),Object.defineProperty(this,S,{value:V}),Object.defineProperty(this,c,{writable:!0,value:0}),Object.defineProperty(this,d,{writable:!0,value:0}),Object.defineProperty(this,h,{writable:!0,value:0}),Object.defineProperty(this,u,{writable:!0,value:this.canvasPointermove.bind(this)}),Object.defineProperty(this,p,{writable:!0,value:this.canvasPointerleave.bind(this)}),Object.defineProperty(this,g,{writable:!0,value:this.canvasPointerup.bind(this)}),Object.defineProperty(this,f,{writable:!0,value:this.canvasPointerdown.bind(this)}),Object.defineProperty(this,m,{writable:!0,value:!1}),Object.defineProperty(this,_,{writable:!0,value:!1}),Object.defineProperty(this,v,{writable:!0,value:null}),Object.defineProperty(this,b,{writable:!0,value:null}),Object.defineProperty(this,y,{writable:!0,value:0}),Object.defineProperty(this,A,{writable:!0,value:0}),Object.defineProperty(this,P,{writable:!0,value:null}),this.color=e.color||null,this.thickness=e.thickness||null,this.opacity=e.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(e){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map(t=>[t,e.get(t)]))}static updateDefaultParams(e,t){switch(e){case a.AnnotationEditorParamsType.INK_THICKNESS:z._defaultThickness=t;break;case a.AnnotationEditorParamsType.INK_COLOR:z._defaultColor=t;break;case a.AnnotationEditorParamsType.INK_OPACITY:z._defaultOpacity=t/100}}updateParams(e,t){switch(e){case a.AnnotationEditorParamsType.INK_THICKNESS:_classPrivateFieldLooseBase(this,S)[S](t);break;case a.AnnotationEditorParamsType.INK_COLOR:_classPrivateFieldLooseBase(this,x)[x](t);break;case a.AnnotationEditorParamsType.INK_OPACITY:_classPrivateFieldLooseBase(this,F)[F](t)}}static get defaultPropertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,z._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,z._defaultColor||r.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*z._defaultOpacity)]]}get propertiesToUpdate(){return[[a.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||z._defaultThickness],[a.AnnotationEditorParamsType.INK_COLOR,this.color||z._defaultColor||r.AnnotationEditor._defaultLineColor],[a.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??z._defaultOpacity))]]}rebuild(){super.rebuild(),null!==this.div&&(this.canvas||(_classPrivateFieldLooseBase(this,R)[R](),_classPrivateFieldLooseBase(this,O)[O]()),this.isAttachedToDOM||(this.parent.add(this),_classPrivateFieldLooseBase(this,D)[D]()),_classPrivateFieldLooseBase(this,G)[G]())}remove(){null!==this.canvas&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,_classPrivateFieldLooseBase(this,b)[b].disconnect(),_classPrivateFieldLooseBase(this,b)[b]=null,super.remove())}enableEditMode(){_classPrivateFieldLooseBase(this,m)[m]||null===this.canvas||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",_classPrivateFieldLooseBase(this,f)[f]),this.canvas.addEventListener("pointerup",_classPrivateFieldLooseBase(this,g)[g]))}disableEditMode(){this.isInEditMode()&&null!==this.canvas&&(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",_classPrivateFieldLooseBase(this,f)[f]),this.canvas.removeEventListener("pointerup",_classPrivateFieldLooseBase(this,g)[g]))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return 0===this.paths.length||1===this.paths.length&&0===this.paths[0].length}commit(){_classPrivateFieldLooseBase(this,m)[m]||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),_classPrivateFieldLooseBase(this,m)[m]=!0,this.div.classList.add("disabled"),_classPrivateFieldLooseBase(this,G)[G](!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}focusin(e){super.focusin(e),this.enableEditMode()}canvasPointerdown(e){0===e.button&&this.isInEditMode()&&!_classPrivateFieldLooseBase(this,m)[m]&&(this.setInForeground(),"mouse"!==e.type&&this.div.focus(),e.stopPropagation(),this.canvas.addEventListener("pointerleave",_classPrivateFieldLooseBase(this,p)[p]),this.canvas.addEventListener("pointermove",_classPrivateFieldLooseBase(this,u)[u]),_classPrivateFieldLooseBase(this,E)[E](e.offsetX,e.offsetY))}canvasPointermove(e){e.stopPropagation(),_classPrivateFieldLooseBase(this,L)[L](e.offsetX,e.offsetY)}canvasPointerup(e){0===e.button&&this.isInEditMode()&&0!==this.currentPath.length&&(e.stopPropagation(),_classPrivateFieldLooseBase(this,M)[M](e),this.setInBackground())}canvasPointerleave(e){_classPrivateFieldLooseBase(this,M)[M](e),this.setInBackground()}render(){if(this.div)return this.div;let e,t;this.width&&(e=this.x,t=this.y),super.render(),z._l10nPromise.get("editor_ink_aria_label").then(e=>this.div?.setAttribute("aria-label",e));const[s,i,a,r]=_classPrivateFieldLooseBase(this,C)[C]();if(this.setAt(s,i,0,0),this.setDims(a,r),_classPrivateFieldLooseBase(this,R)[R](),this.width){const[s,i]=this.parent.viewportBaseDimensions;this.setAt(e*s,t*i,this.width*s,this.height*i),_classPrivateFieldLooseBase(this,_)[_]=!0,_classPrivateFieldLooseBase(this,D)[D](),this.setDims(this.width*s,this.height*i),_classPrivateFieldLooseBase(this,k)[k](),_classPrivateFieldLooseBase(this,H)[H](),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return _classPrivateFieldLooseBase(this,O)[O](),this.div}setDimensions(e,t){const s=Math.round(e),i=Math.round(t);if(_classPrivateFieldLooseBase(this,y)[y]===s&&_classPrivateFieldLooseBase(this,A)[A]===i)return;_classPrivateFieldLooseBase(this,y)[y]=s,_classPrivateFieldLooseBase(this,A)[A]=i,this.canvas.style.visibility="hidden",_classPrivateFieldLooseBase(this,c)[c]&&Math.abs(_classPrivateFieldLooseBase(this,c)[c]-e/t)>.01&&(t=Math.ceil(e/_classPrivateFieldLooseBase(this,c)[c]),this.setDims(e,t));const[a,r]=this.parent.viewportBaseDimensions;this.width=e/a,this.height=t/r,_classPrivateFieldLooseBase(this,m)[m]&&_classPrivateFieldLooseBase(this,I)[I](e,t),_classPrivateFieldLooseBase(this,D)[D](),_classPrivateFieldLooseBase(this,k)[k](),this.canvas.style.visibility="visible"}static deserialize(e,t){const s=super.deserialize(e,t);s.thickness=e.thickness,s.color=a.Util.makeHexColor(...e.color),s.opacity=e.opacity;const[i,r]=t.pageDimensions,n=s.width*i,o=s.height*r,u=t.scaleFactor,p=e.thickness/2;_classPrivateFieldLooseBase(s,c)[c]=n/o,_classPrivateFieldLooseBase(s,m)[m]=!0,_classPrivateFieldLooseBase(s,y)[y]=Math.round(n),_classPrivateFieldLooseBase(s,A)[A]=Math.round(o);for(const{bezier:t}of e.paths){const e=[];s.paths.push(e);let i=u*(t[0]-p),a=u*(o-t[1]-p);for(let s=2,r=t.length;s<r;s+=6){const r=u*(t[s]-p),n=u*(o-t[s+1]-p),l=u*(t[s+2]-p),c=u*(o-t[s+3]-p),d=u*(t[s+4]-p),h=u*(o-t[s+5]-p);e.push([[i,a],[r,n],[l,c],[d,h]]),i=d,a=h}const r=_classPrivateFieldLooseBase(this,N)[N](e);s.bezierPath2D.push(r)}const g=_classPrivateFieldLooseBase(s,W)[W]();return _classPrivateFieldLooseBase(s,h)[h]=Math.max(l,g[2]-g[0]),_classPrivateFieldLooseBase(s,d)[d]=Math.max(l,g[3]-g[1]),_classPrivateFieldLooseBase(s,I)[I](n,o),s}serialize(){if(this.isEmpty())return null;const e=this.getRect(0,0),t=this.rotation%180==0?e[3]-e[1]:e[2]-e[0],s=r.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:a.AnnotationEditorType.INK,color:s,thickness:this.thickness,opacity:this.opacity,paths:_classPrivateFieldLooseBase(this,j)[j](this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,t),pageIndex:this.parent.pageIndex,rect:e,rotation:this.rotation}}}function V(e){const t=this.thickness;this.parent.addCommands({cmd:()=>{this.thickness=e,_classPrivateFieldLooseBase(this,G)[G]()},undo:()=>{this.thickness=t,_classPrivateFieldLooseBase(this,G)[G]()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}function X(e){const t=this.color;this.parent.addCommands({cmd:()=>{this.color=e,_classPrivateFieldLooseBase(this,k)[k]()},undo:()=>{this.color=t,_classPrivateFieldLooseBase(this,k)[k]()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function $(e){e/=100;const t=this.opacity;this.parent.addCommands({cmd:()=>{this.opacity=e,_classPrivateFieldLooseBase(this,k)[k]()},undo:()=>{this.opacity=t,_classPrivateFieldLooseBase(this,k)[k]()},mustExec:!0,type:a.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}function Y(){const{width:e,height:t,rotation:s}=this.parent.viewport;switch(s){case 90:return[0,e,e,t];case 180:return[e,t,e,t];case 270:return[t,0,e,t];default:return[0,0,e,t]}}function J(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle=`${this.color}${(0,o.opacityToHex)(this.opacity)}`}function Q(e,t){this.isEditing=!0,_classPrivateFieldLooseBase(this,_)[_]||(_classPrivateFieldLooseBase(this,_)[_]=!0,_classPrivateFieldLooseBase(this,D)[D](),this.thickness||=i._defaultThickness,this.color||=i._defaultColor||r.AnnotationEditor._defaultLineColor,this.opacity??=i._defaultOpacity),this.currentPath.push([e,t]),_classPrivateFieldLooseBase(this,v)[v]=null,_classPrivateFieldLooseBase(this,w)[w](),this.ctx.beginPath(),this.ctx.moveTo(e,t),_classPrivateFieldLooseBase(this,P)[P]=()=>{_classPrivateFieldLooseBase(this,P)[P]&&(_classPrivateFieldLooseBase(this,v)[v]&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):_classPrivateFieldLooseBase(this,k)[k](),this.ctx.lineTo(..._classPrivateFieldLooseBase(this,v)[v]),_classPrivateFieldLooseBase(this,v)[v]=null,this.ctx.stroke()),window.requestAnimationFrame(_classPrivateFieldLooseBase(this,P)[P]))},window.requestAnimationFrame(_classPrivateFieldLooseBase(this,P)[P])}function Z(e,t){const[s,i]=this.currentPath.at(-1);e===s&&t===i||(this.currentPath.push([e,t]),_classPrivateFieldLooseBase(this,v)[v]=[e,t])}function ee(e,t){this.ctx.closePath(),_classPrivateFieldLooseBase(this,P)[P]=null,e=Math.min(Math.max(e,0),this.canvas.width),t=Math.min(Math.max(t,0),this.canvas.height);const[s,a]=this.currentPath.at(-1);let r;if(e===s&&t===a||this.currentPath.push([e,t]),1!==this.currentPath.length)r=(0,n.fitCurve)(this.currentPath,30,null);else{const s=[e,t];r=[[s,s.slice(),s.slice(),s]]}const o=_classPrivateFieldLooseBase(i,N)[N](r);this.currentPath.length=0,this.parent.addCommands({cmd:()=>{this.paths.push(r),this.bezierPath2D.push(o),this.rebuild()},undo:()=>{this.paths.pop(),this.bezierPath2D.pop(),0===this.paths.length?this.remove():(this.canvas||(_classPrivateFieldLooseBase(this,R)[R](),_classPrivateFieldLooseBase(this,O)[O]()),_classPrivateFieldLooseBase(this,G)[G]())},mustExec:!0})}function te(){if(this.isEmpty())return void _classPrivateFieldLooseBase(this,B)[B]();_classPrivateFieldLooseBase(this,w)[w]();const{canvas:e,ctx:t}=this;t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height),_classPrivateFieldLooseBase(this,B)[B]();for(const e of this.bezierPath2D)t.stroke(e)}function se(e){_classPrivateFieldLooseBase(this,T)[T](e.offsetX,e.offsetY),this.canvas.removeEventListener("pointerleave",_classPrivateFieldLooseBase(this,p)[p]),this.canvas.removeEventListener("pointermove",_classPrivateFieldLooseBase(this,u)[u]),this.parent.addToAnnotationStorage(this)}function ie(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",i._l10nPromise.get("editor_ink_canvas_aria_label").then(e=>this.canvas?.setAttribute("aria-label",e)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}function ae(){_classPrivateFieldLooseBase(this,b)[b]=new ResizeObserver(e=>{const t=e[0].contentRect;t.width&&t.height&&this.setDimensions(t.width,t.height)}),_classPrivateFieldLooseBase(this,b)[b].observe(this.div)}function re(){if(!_classPrivateFieldLooseBase(this,_)[_])return;const[e,t]=this.parent.viewportBaseDimensions;this.canvas.width=Math.ceil(this.width*e),this.canvas.height=Math.ceil(this.height*t),_classPrivateFieldLooseBase(this,B)[B]()}function ne(e,t){const s=_classPrivateFieldLooseBase(this,K)[K](),i=(e-s)/_classPrivateFieldLooseBase(this,h)[h],a=(t-s)/_classPrivateFieldLooseBase(this,d)[d];this.scaleFactor=Math.min(i,a)}function oe(){const e=_classPrivateFieldLooseBase(this,K)[K]()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+e,this.translationY*this.scaleFactor+e)}function le(e,t,s,i){const a=[],r=this.thickness/2;let n,o;for(const l of this.paths){n=[],o=[];for(let a=0,c=l.length;a<c;a++){const[c,d,h,u]=l[a],p=e*(c[0]+t)+r,g=i-e*(c[1]+s)-r,f=e*(d[0]+t)+r,m=i-e*(d[1]+s)-r,_=e*(h[0]+t)+r,v=i-e*(h[1]+s)-r,b=e*(u[0]+t)+r,y=i-e*(u[1]+s)-r;0===a&&(n.push(p,g),o.push(p,g)),n.push(f,m,_,v,b,y),_classPrivateFieldLooseBase(this,U)[U](p,g,f,m,_,v,b,y,4,o)}a.push({bezier:n,points:o})}return a}function ce(e,t,s,i,a,r,n,o,l,c){if(_classPrivateFieldLooseBase(this,q)[q](e,t,s,i,a,r,n,o))c.push(n,o);else{for(let d=1;d<l-1;d++){const h=d/l,u=1-h;let p=h*e+u*s,g=h*t+u*i,f=h*s+u*a,m=h*i+u*r;p=h*p+u*f,g=h*g+u*m,f=h*f+u*(h*a+u*n),m=h*m+u*(h*r+u*o),p=h*p+u*f,g=h*g+u*m,c.push(p,g)}c.push(n,o)}}function de(e,t,s,i,a,r,n,o){const l=(3*s-2*e-n)**2,c=(3*i-2*t-o)**2,d=(3*a-e-2*n)**2,h=(3*r-t-2*o)**2;return Math.max(l,d)+Math.max(c,h)<=10}function he(){let e=1/0,t=-1/0,s=1/0,i=-1/0;for(const r of this.paths)for(const[n,o,l,c]of r){const r=a.Util.bezierBoundingBox(...n,...o,...l,...c);e=Math.min(e,r[0]),s=Math.min(s,r[1]),t=Math.max(t,r[2]),i=Math.max(i,r[3])}return[e,s,t,i]}function ue(){return _classPrivateFieldLooseBase(this,m)[m]?Math.ceil(this.thickness*this.parent.scaleFactor):0}function pe(e=!1){if(this.isEmpty())return;if(!_classPrivateFieldLooseBase(this,m)[m])return void _classPrivateFieldLooseBase(this,k)[k]();const t=_classPrivateFieldLooseBase(this,W)[W](),s=_classPrivateFieldLooseBase(this,K)[K]();_classPrivateFieldLooseBase(this,h)[h]=Math.max(l,t[2]-t[0]),_classPrivateFieldLooseBase(this,d)[d]=Math.max(l,t[3]-t[1]);const i=Math.ceil(s+_classPrivateFieldLooseBase(this,h)[h]*this.scaleFactor),a=Math.ceil(s+_classPrivateFieldLooseBase(this,d)[d]*this.scaleFactor),[r,n]=this.parent.viewportBaseDimensions;this.width=i/r,this.height=a/n,_classPrivateFieldLooseBase(this,c)[c]=i/a,_classPrivateFieldLooseBase(this,H)[H]();const o=this.translationX,u=this.translationY;this.translationX=-t[0],this.translationY=-t[1],_classPrivateFieldLooseBase(this,D)[D](),_classPrivateFieldLooseBase(this,k)[k](),_classPrivateFieldLooseBase(this,y)[y]=i,_classPrivateFieldLooseBase(this,A)[A]=a,this.setDims(i,a);const p=e?s/this.scaleFactor/2:0;this.translate(o-this.translationX-p,u-this.translationY-p)}function ge(){const{style:e}=this.div;_classPrivateFieldLooseBase(this,c)[c]>=1?(e.minHeight="16px",e.minWidth=`${Math.round(_classPrivateFieldLooseBase(this,c)[c]*l)}px`):(e.minWidth="16px",e.minHeight=`${Math.round(l/_classPrivateFieldLooseBase(this,c)[c])}px`)}i=z,Object.defineProperty(z,N,{value:function(e){const t=new Path2D;for(let s=0,i=e.length;s<i;s++){const[i,a,r,n]=e[s];0===s&&t.moveTo(...i),t.bezierCurveTo(a[0],a[1],r[0],r[1],n[0],n[1])}return t}}),z._defaultColor=null,z._defaultOpacity=1,z._defaultThickness=1,z._type="ink",t.InkEditor=z},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.fitCurve=void 0;const i=s(26);t.fitCurve=i},e=>{function t(e,i,r,o,l){var c,d,u,p,g,f,m,_,v,b,y,A,P;if(2===e.length)return A=h.vectorLen(h.subtract(e[0],e[1]))/3,[c=[e[0],h.addArrays(e[0],h.mulItems(i,A)),h.addArrays(e[1],h.mulItems(r,A)),e[1]]];if(d=n(e),[c,p,f]=s(e,d,d,i,r,l),0===p||p<o)return[c];if(p<o*o)for(u=d,g=p,m=f,P=0;P<20;P++){if(u=a(c,e,u),[c,p,f]=s(e,d,u,i,r,l),p<o)return[c];if(f===m){let e=p/g;if(e>.9999&&e<1.0001)break}g=p,m=f}return y=[],(_=h.subtract(e[f-1],e[f+1])).every(e=>0===e)&&(_=h.subtract(e[f-1],e[f]),[_[0],_[1]]=[-_[1],_[0]]),v=h.normalize(_),b=h.mulItems(v,-1),y=(y=y.concat(t(e.slice(0,f+1),i,v,o,l))).concat(t(e.slice(f),b,r,o,l))}function s(e,t,s,a,r,n){var l,c,d;return l=i(e,s,a,r),[c,d]=o(e,l,t),n&&n({bez:l,points:e,params:t,maxErr:c,maxPoint:d}),[l,c,d]}function i(e,t,s,i){var a,r,n,o,l,c,d,p,g,f,m,_,v,b,y,A,P,S=e[0],x=e[e.length-1];for(a=[S,null,null,x],r=h.zeros_Xx2x2(t.length),v=0,b=t.length;v<b;v++)P=1-(A=t[v]),(n=r[v])[0]=h.mulItems(s,3*A*(P*P)),n[1]=h.mulItems(i,3*P*(A*A));for(o=[[0,0],[0,0]],l=[0,0],v=0,b=e.length;v<b;v++)A=t[v],n=r[v],o[0][0]+=h.dot(n[0],n[0]),o[0][1]+=h.dot(n[0],n[1]),o[1][0]+=h.dot(n[0],n[1]),o[1][1]+=h.dot(n[1],n[1]),y=h.subtract(e[v],u.q([S,S,x,x],A)),l[0]+=h.dot(n[0],y),l[1]+=h.dot(n[1],y);return c=o[0][0]*o[1][1]-o[1][0]*o[0][1],d=o[0][0]*l[1]-o[1][0]*l[0],p=l[0]*o[1][1]-l[1]*o[0][1],f=0===c?0:d/c,(g=0===c?0:p/c)<(m=1e-6*(_=h.vectorLen(h.subtract(S,x))))||f<m?(a[1]=h.addArrays(S,h.mulItems(s,_/3)),a[2]=h.addArrays(x,h.mulItems(i,_/3))):(a[1]=h.addArrays(S,h.mulItems(s,g)),a[2]=h.addArrays(x,h.mulItems(i,f))),a}function a(e,t,s){return s.map((s,i)=>r(e,t[i],s))}function r(e,t,s){var i=h.subtract(u.q(e,s),t),a=u.qprime(e,s),r=h.mulMatrix(i,a),n=h.sum(h.squareItems(a))+2*h.mulMatrix(i,u.qprimeprime(e,s));return 0===n?s:s-r/n}function n(e){var t,s,i,a=[];return e.forEach((e,r)=>{t=r?s+h.vectorLen(h.subtract(e,i)):0,a.push(t),s=t,i=e}),a=a.map(e=>e/s)}function o(e,t,s){var i,a,r,n,o,d,p,g;a=0,r=Math.floor(e.length/2);const f=l(t,10);for(o=0,d=e.length;o<d;o++)p=e[o],g=c(0,s[o],f,10),(i=(n=h.subtract(u.q(t,g),p))[0]*n[0]+n[1]*n[1])>a&&(a=i,r=o);return[a,r]}var l=function(e,t){for(var s,i=[0],a=e[0],r=0,n=1;n<=t;n++)s=u.q(e,n/t),r+=h.vectorLen(h.subtract(s,a)),i.push(r),a=s;return i=i.map(e=>e/r)};function c(e,t,s,i){if(t<0)return 0;if(t>1)return 1;for(var a,r,n,o,l=1;l<=i;l++)if(t<=s[l]){n=(l-1)/i,r=l/i,o=(t-(a=s[l-1]))/(s[l]-a)*(r-n)+n;break}return o}function d(e,t){return h.normalize(h.subtract(e,t))}class h{static zeros_Xx2x2(e){for(var t=[];e--;)t.push([0,0]);return t}static mulItems(e,t){return e.map(e=>e*t)}static mulMatrix(e,t){return e.reduce((e,s,i)=>e+s*t[i],0)}static subtract(e,t){return e.map((e,s)=>e-t[s])}static addArrays(e,t){return e.map((e,s)=>e+t[s])}static addItems(e,t){return e.map(e=>e+t)}static sum(e){return e.reduce((e,t)=>e+t)}static dot(e,t){return h.mulMatrix(e,t)}static vectorLen(e){return Math.hypot(...e)}static divItems(e,t){return e.map(e=>e/t)}static squareItems(e){return e.map(e=>e*e)}static normalize(e){return this.divItems(e,this.vectorLen(e))}}class u{static q(e,t){var s=1-t,i=h.mulItems(e[0],s*s*s),a=h.mulItems(e[1],3*s*s*t),r=h.mulItems(e[2],3*s*t*t),n=h.mulItems(e[3],t*t*t);return h.addArrays(h.addArrays(i,a),h.addArrays(r,n))}static qprime(e,t){var s=1-t,i=h.mulItems(h.subtract(e[1],e[0]),3*s*s),a=h.mulItems(h.subtract(e[2],e[1]),6*s*t),r=h.mulItems(h.subtract(e[3],e[2]),3*t*t);return h.addArrays(h.addArrays(i,a),r)}static qprimeprime(e,t){return h.addArrays(h.mulItems(h.addArrays(h.subtract(e[2],h.mulItems(e[1],2)),e[0]),6*(1-t)),h.mulItems(h.addArrays(h.subtract(e[3],h.mulItems(e[2],2)),e[1]),6*t))}}e.exports=function(e,s,i){if(!Array.isArray(e))throw new TypeError("First argument should be an array");if(e.forEach(t=>{if(!Array.isArray(t)||t.some(e=>'number'!=typeof e)||t.length!==e[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),(e=e.filter((t,s)=>0===s||!t.every((t,i)=>t===e[s-1][i]))).length<2)return[];const a=e.length,r=d(e[1],e[0]),n=d(e[a-2],e[a-1]);return t(e,r,n,s,i)},e.exports.fitCubic=t,e.exports.createTangent=d},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationLayer=void 0;var i=s(1),a=s(8),r=s(5),n=s(28),o=s(29);const l=1e3,c=new WeakSet;function d(e){return{width:e[2]-e[0],height:e[3]-e[1]}}class h{static create(e){switch(e.data.annotationType){case i.AnnotationType.LINK:return new p(e);case i.AnnotationType.TEXT:return new g(e);case i.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new m(e);case"Btn":return e.data.radioButton?new v(e):e.data.checkBox?new _(e):new b(e);case"Ch":return new y(e)}return new f(e);case i.AnnotationType.POPUP:return new A(e);case i.AnnotationType.FREETEXT:return new S(e);case i.AnnotationType.LINE:return new x(e);case i.AnnotationType.SQUARE:return new F(e);case i.AnnotationType.CIRCLE:return new C(e);case i.AnnotationType.POLYLINE:return new w(e);case i.AnnotationType.CARET:return new L(e);case i.AnnotationType.INK:return new T(e);case i.AnnotationType.POLYGON:return new E(e);case i.AnnotationType.HIGHLIGHT:return new k(e);case i.AnnotationType.UNDERLINE:return new M(e);case i.AnnotationType.SQUIGGLY:return new R(e);case i.AnnotationType.STRIKEOUT:return new O(e);case i.AnnotationType.STAMP:return new D(e);case i.AnnotationType.FILEATTACHMENT:return new I(e);default:return new u(e)}}}class u{constructor(e,{isRenderable:t=!1,ignoreBorder:s=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.page=e.page,this.viewport=e.viewport,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this._mouseState=e.mouseState,t&&(this.container=this._createContainer(s)),i&&(this.quadrilaterals=this._createQuadrilaterals(s))}_createContainer(e=!1){const t=this.data,s=this.page,a=this.viewport,r=document.createElement("section"),{width:n,height:o}=d(t.rect),[l,c,h,u]=a.viewBox,p=h-l,g=u-c;r.setAttribute("data-annotation-id",t.id);const f=i.Util.normalizeRect([t.rect[0],s.view[3]-t.rect[1]+s.view[1],t.rect[2],s.view[3]-t.rect[3]+s.view[1]]);if(!e&&t.borderStyle.width>0){r.style.borderWidth=`${t.borderStyle.width}px`;const e=t.borderStyle.horizontalCornerRadius,s=t.borderStyle.verticalCornerRadius;if(e>0||s>0){const t=`calc(${e}px * var(--scale-factor)) / calc(${s}px * var(--scale-factor))`;r.style.borderRadius=t}else if(this instanceof v){const e=`calc(${n}px * var(--scale-factor)) / calc(${o}px * var(--scale-factor))`;r.style.borderRadius=e}switch(t.borderStyle.style){case i.AnnotationBorderStyleType.SOLID:r.style.borderStyle="solid";break;case i.AnnotationBorderStyleType.DASHED:r.style.borderStyle="dashed";break;case i.AnnotationBorderStyleType.BEVELED:(0,i.warn)("Unimplemented border style: beveled");break;case i.AnnotationBorderStyleType.INSET:(0,i.warn)("Unimplemented border style: inset");break;case i.AnnotationBorderStyleType.UNDERLINE:r.style.borderBottomStyle="solid"}const a=t.borderColor||null;a?r.style.borderColor=i.Util.makeHexColor(0|a[0],0|a[1],0|a[2]):r.style.borderWidth=0}r.style.left=100*(f[0]-l)/p+"%",r.style.top=100*(f[1]-c)/g+"%";const{rotation:m}=t;return t.hasOwnCanvas||0===m?(r.style.width=100*n/p+"%",r.style.height=100*o/g+"%"):this.setRotation(m,r),r}setRotation(e,t=this.container){const[s,i,a,r]=this.viewport.viewBox,n=a-s,o=r-i,{width:l,height:c}=d(this.data.rect);let h,u;e%180==0?(h=100*l/n,u=100*c/o):(h=100*c/n,u=100*l/o),t.style.width=`${h}%`,t.style.height=`${u}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(e,t,s)=>{const i=s.detail[e];s.target.style[t]=n.ColorConverters[`${i[0]}_HTML`](i.slice(1))};return(0,i.shadow)(this,"_commonActions",{display:e=>{const t=e.detail.display%2==1;this.container.style.visibility=t?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:t,print:0===e.detail.display||3===e.detail.display})},print:e=>{this.annotationStorage.setValue(this.data.id,{print:e.detail.print})},hidden:e=>{this.container.style.visibility=e.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:e.detail.hidden})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.detail.readonly?e.target.setAttribute("readonly",""):e.target.removeAttribute("readonly")},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:e=>{const t=e.detail.rotation;this.setRotation(t),this.annotationStorage.setValue(this.data.id,{rotation:t})}})}_dispatchEventFromSandbox(e,t){const s=this._commonActions;for(const i of Object.keys(t.detail)){const a=e[i]||s[i];a&&a(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const s=this._commonActions;for(const[i,a]of Object.entries(t)){const r=s[i];r&&(r({detail:{[i]:a},target:e}),delete t[i])}}_createQuadrilaterals(e=!1){if(!this.data.quadPoints)return null;const t=[],s=this.data.rect;for(const s of this.data.quadPoints)this.data.rect=[s[2].x,s[2].y,s[1].x,s[1].y],t.push(this._createContainer(e));return this.data.rect=s,t}_createPopup(e,t){let s=this.container;this.quadrilaterals&&(e=e||this.quadrilaterals,s=this.quadrilaterals[0]),e||((e=document.createElement("div")).className="popupTriggerArea",s.append(e));const i=new P({container:s,trigger:e,color:t.color,titleObj:t.titleObj,modificationDate:t.modificationDate,contentsObj:t.contentsObj,richText:t.richText,hideWrapper:!0}).render();i.style.left="100%",s.append(i)}_renderQuadrilaterals(e){for(const t of this.quadrilaterals)t.className=e;return this.quadrilaterals}render(){(0,i.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const s=[];if(this._fieldObjects){const a=this._fieldObjects[e];if(a)for(const{page:e,id:r,exportValues:n}of a){if(-1===e)continue;if(r===t)continue;const a="string"==typeof n?n:null,o=document.querySelector(`[data-element-id="${r}"]`);!o||c.has(o)?s.push({id:r,exportValue:a,domElement:o}):(0,i.warn)(`_getElementsByName - element not allowed: ${r}`)}return s}for(const i of document.getElementsByName(e)){const{id:e,exportValue:a}=i;e!==t&&c.has(i)&&s.push({id:e,exportValue:a,domElement:i})}return s}static get platform(){const e="undefined"!=typeof navigator?navigator.platform:"";return(0,i.shadow)(this,"platform",{isWin:e.includes("Win"),isMac:e.includes("Mac")})}}class p extends u{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,s=document.createElement("a");s.setAttribute("data-element-id",e.id);let i=!1;return e.url?(t.addLinkAttributes(s,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(s,e.action),i=!0):e.dest?(this._bindLink(s,e.dest),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,e),i=!0),e.resetForm?(this._bindResetFormAction(s,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(s,""),i=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((e,t)=>{const i=0===t?s:s.cloneNode();return e.append(i),e}):(this.container.className="linkAnnotation",i&&this.container.append(s),this.container)}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||""===t)&&(e.className="internalLink")}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),e.className="internalLink"}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(t.actions)){const a=s.get(i);a&&(e[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:i}}),!1))}e.onclick||(e.onclick=()=>!1),e.className="internalLink"}_bindResetFormAction(e,t){const s=e.onclick;if(s||(e.href=this.linkService.getAnchorUrl("")),e.className="internalLink",!this._fieldObjects)return(0,i.warn)("_bindResetFormAction - \"resetForm\" action not supported, ensure that the `fieldObjects` parameter is provided."),void(s||(e.onclick=()=>!1));e.onclick=()=>{s&&s();const{fields:e,refs:a,include:r}=t,n=[];if(0!==e.length||0!==a.length){const t=new Set(a);for(const s of e){const e=this._fieldObjects[s]||[];for(const{id:s}of e)t.add(s)}for(const e of Object.values(this._fieldObjects))for(const s of e)t.has(s.id)===r&&n.push(s)}else for(const e of Object.values(this._fieldObjects))n.push(...e);const o=this.annotationStorage,l=[];for(const e of n){const{id:t}=e;switch(l.push(t),e.type){case"text":{const s=e.defaultValue||"";o.setValue(t,{value:s});break}case"checkbox":case"radiobutton":{const s=e.defaultValue===e.exportValues;o.setValue(t,{value:s});break}case"combobox":case"listbox":{const s=e.defaultValue||"";o.setValue(t,{value:s});break}default:continue}const s=document.querySelector(`[data-element-id="${t}"]`);s&&(c.has(s)?s.dispatchEvent(new Event("resetform")):(0,i.warn)(`_bindResetFormAction - element not allowed: ${t}`))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:l,name:"ResetForm"}}),!1}}}class g extends u{constructor(e){super(e,{isRenderable:!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str)})}render(){this.container.className="textAnnotation";const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(e,this.data),this.container.append(e),this.container}}class f extends u{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(e){const{isWin:t,isMac:s}=u.platform;return t&&e.ctrlKey||s&&e.metaKey}_setEventListener(e,t,s,i){t.includes("mouse")?e.addEventListener(t,e=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:i(e),shift:e.shiftKey,modifier:this._getKeyModifier(e)}})}):e.addEventListener(t,e=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:i(e)}})})}_setEventListeners(e,t,s){for(const[i,a]of t)("Action"===a||this.data.actions?.[a])&&this._setEventListener(e,i,a,s)}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=null===t?"transparent":i.Util.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:s}=this.data.defaultAppearanceData,a=this.data.defaultAppearanceData.fontSize||9,r=e.style;let n;if(this.data.multiLine){const e=Math.abs(this.data.rect[3]-this.data.rect[1]),t=e/(Math.round(e/(i.LINE_FACTOR*a))||1);n=Math.min(a,Math.round(t/i.LINE_FACTOR))}else{const e=Math.abs(this.data.rect[3]-this.data.rect[1]);n=Math.min(a,Math.round(e/i.LINE_FACTOR))}r.fontSize=`calc(${n}px * var(--scale-factor))`,r.color=i.Util.makeHexColor(s[0],s[1],s[2]),null!==this.data.textAlignment&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class m extends f{constructor(e){super(e,{isRenderable:e.renderForms||!e.data.hasAppearance&&!!e.data.fieldValue})}setPropertyOnSiblings(e,t,s,i){const a=this.annotationStorage;for(const r of this._getElementsByName(e.name,e.id))r.domElement&&(r.domElement[t]=s),a.setValue(r.id,{[i]:s})}render(){const e=this.annotationStorage,t=this.data.id;this.container.className="textWidgetAnnotation";let s=null;if(this.renderForms){const i=e.getValue(t,{value:this.data.fieldValue});let a=i.formattedValue||i.value||"";const r=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;r&&a.length>r&&(a=a.slice(0,r));const n={userValue:a,formattedValue:null,valueOnFocus:""};this.data.multiLine?(s=document.createElement("textarea"),s.textContent=a,this.data.doNotScroll&&(s.style.overflowY="hidden")):(s=document.createElement("input"),s.type="text",s.setAttribute("value",a),this.data.doNotScroll&&(s.style.overflowX="hidden")),c.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,s.name=this.data.fieldName,s.tabIndex=l,this._setRequired(s,this.data.required),r&&(s.maxLength=r),s.addEventListener("input",i=>{e.setValue(t,{value:i.target.value}),this.setPropertyOnSiblings(s,"value",i.target.value,"value")}),s.addEventListener("resetform",e=>{const t=this.data.defaultFieldValue??"";s.value=n.userValue=t,n.formattedValue=null});let o=e=>{const{formattedValue:t}=n;null!=t&&(e.target.value=t),e.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){s.addEventListener("focus",e=>{n.userValue&&(e.target.value=n.userValue),n.valueOnFocus=e.target.value}),s.addEventListener("updatefromsandbox",s=>{const i={value(s){n.userValue=s.detail.value??"",e.setValue(t,{value:n.userValue.toString()}),s.target.value=n.userValue},formattedValue(s){const{formattedValue:i}=s.detail;n.formattedValue=i,null!=i&&s.target!==document.activeElement&&(s.target.value=i),e.setValue(t,{formattedValue:i})},selRange(e){e.target.setSelectionRange(...e.detail.selRange)},charLimit:s=>{const{charLimit:i}=s.detail,{target:a}=s;if(0===i)return void a.removeAttribute("maxLength");a.setAttribute("maxLength",i);let r=n.userValue;!r||r.length<=i||(r=r.slice(0,i),a.value=n.userValue=r,e.setValue(t,{value:r}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:r,willCommit:!0,commitKey:1,selStart:a.selectionStart,selEnd:a.selectionEnd}}))}};this._dispatchEventFromSandbox(i,s)}),s.addEventListener("keydown",e=>{let s=-1;if("Escape"===e.key?s=0:"Enter"===e.key?s=2:"Tab"===e.key&&(s=3),-1===s)return;const{value:i}=e.target;n.valueOnFocus!==i&&(n.userValue=i,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:i,willCommit:!0,commitKey:s,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}))});const i=o;o=null,s.addEventListener("blur",e=>{const{value:s}=e.target;n.userValue=s,this._mouseState.isDown&&n.valueOnFocus!==s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:s,willCommit:!0,commitKey:1,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}),i(e)}),this.data.actions?.Keystroke&&s.addEventListener("beforeinput",e=>{const{data:s,target:i}=e,{value:a,selectionStart:r,selectionEnd:n}=i;let o=r,l=n;switch(e.inputType){case"deleteWordBackward":{const e=a.substring(0,r).match(/\w*[^\w]*$/);e&&(o-=e[0].length);break}case"deleteWordForward":{const e=a.substring(r).match(/^[^\w]*\w*/);e&&(l+=e[0].length);break}case"deleteContentBackward":r===n&&(o-=1);break;case"deleteContentForward":r===n&&(l+=1)}e.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:a,change:s||"",willCommit:!1,selStart:o,selEnd:l}})}),this._setEventListeners(s,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.value)}if(o&&s.addEventListener("blur",o),this.data.comb){const e=(this.data.rect[2]-this.data.rect[0])/r;s.classList.add("comb"),s.style.letterSpacing=`calc(${e}px * var(--scale-factor) - 1ch)`}}else s=document.createElement("div"),s.textContent=this.data.fieldValue,s.style.verticalAlign="middle",s.style.display="table-cell";return this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class _ extends f{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.exportValue===t.fieldValue}).value;"string"==typeof i&&(i="Off"!==i,e.setValue(s,{value:i})),this.container.className="buttonWidgetAnnotation checkBox";const a=document.createElement("input");return c.add(a),a.setAttribute("data-element-id",s),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=t.fieldName,i&&a.setAttribute("checked",!0),a.setAttribute("exportValue",t.exportValue),a.tabIndex=l,a.addEventListener("change",i=>{const{name:a,checked:r}=i.target;for(const i of this._getElementsByName(a,s)){const s=r&&i.exportValue===t.exportValue;i.domElement&&(i.domElement.checked=s),e.setValue(i.id,{value:s})}e.setValue(s,{value:r})}),a.addEventListener("resetform",e=>{const s=t.defaultFieldValue||"Off";e.target.checked=s===t.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",t=>{const i={value(t){t.target.checked="Off"!==t.detail.value,e.setValue(s,{value:t.target.checked})}};this._dispatchEventFromSandbox(i,t)}),this._setEventListeners(a,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class v extends f{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const e=this.annotationStorage,t=this.data,s=t.id;let i=e.getValue(s,{value:t.fieldValue===t.buttonValue}).value;"string"==typeof i&&(i=i!==t.buttonValue,e.setValue(s,{value:i}));const a=document.createElement("input");if(c.add(a),a.setAttribute("data-element-id",s),a.disabled=t.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=t.fieldName,i&&a.setAttribute("checked",!0),a.tabIndex=l,a.addEventListener("change",t=>{const{name:i,checked:a}=t.target;for(const t of this._getElementsByName(i,s))e.setValue(t.id,{value:!1});e.setValue(s,{value:a})}),a.addEventListener("resetform",e=>{const s=t.defaultFieldValue;e.target.checked=null!=s&&s===t.buttonValue}),this.enableScripting&&this.hasJSActions){const i=t.buttonValue;a.addEventListener("updatefromsandbox",t=>{const a={value:t=>{const a=i===t.detail.value;for(const i of this._getElementsByName(t.target.name)){const t=a&&i.id===s;i.domElement&&(i.domElement.checked=t),e.setValue(i.id,{value:t})}}};this._dispatchEventFromSandbox(a,t)}),this._setEventListeners(a,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],e=>e.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class b extends p{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(e.title=this.data.alternativeText);const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",e=>{this._dispatchEventFromSandbox({},e)})),e}}class y extends f{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const e=this.annotationStorage,t=this.data.id,s=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");c.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=l;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",e=>{const t=this.data.defaultFieldValue;for(const e of i.options)e.selected=e.value===t});for(const e of this.data.options){const t=document.createElement("option");t.textContent=e.displayValue,t.value=e.exportValue,s.value.includes(e.exportValue)&&(t.setAttribute("selected",!0),a=!1),i.append(t)}let r=null;if(a){const e=document.createElement("option");e.value=" ",e.setAttribute("hidden",!0),e.setAttribute("selected",!0),i.prepend(e),r=()=>{e.remove(),i.removeEventListener("input",r),r=null},i.addEventListener("input",r)}const n=(e,t)=>{const s=t?"value":"textContent",i=e.target.options;return e.target.multiple?Array.prototype.filter.call(i,e=>e.selected).map(e=>e[s]):-1===i.selectedIndex?null:i[i.selectedIndex][s]},o=e=>{const t=e.target.options;return Array.prototype.map.call(t,e=>({displayValue:e.textContent,exportValue:e.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",s=>{const a={value(s){r?.();const a=s.detail.value,o=new Set(Array.isArray(a)?a:[a]);for(const e of i.options)e.selected=o.has(e.value);e.setValue(t,{value:n(s,!0)})},multipleSelection(e){i.multiple=!0},remove(s){const a=i.options,r=s.detail.remove;a[r].selected=!1,i.remove(r),a.length>0&&-1===Array.prototype.findIndex.call(a,e=>e.selected)&&(a[0].selected=!0),e.setValue(t,{value:n(s,!0),items:o(s)})},clear(s){for(;0!==i.length;)i.remove(0);e.setValue(t,{value:null,items:[]})},insert(s){const{index:a,displayValue:r,exportValue:l}=s.detail.insert,c=i.children[a],d=document.createElement("option");d.textContent=r,d.value=l,c?c.before(d):i.append(d),e.setValue(t,{value:n(s,!0),items:o(s)})},items(s){const{items:a}=s.detail;for(;0!==i.length;)i.remove(0);for(const e of a){const{displayValue:t,exportValue:s}=e,a=document.createElement("option");a.textContent=t,a.value=s,i.append(a)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:n(s,!0),items:o(s)})},indices(s){const i=new Set(s.detail.indices);for(const e of s.target.options)e.selected=i.has(e.index);e.setValue(t,{value:n(s,!0)})},editable(e){e.target.disabled=!e.detail.editable}};this._dispatchEventFromSandbox(a,s)}),i.addEventListener("input",s=>{const i=n(s,!0),a=n(s,!1);e.setValue(t,{value:i}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:a,changeEx:i,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],e=>e.target.checked)):i.addEventListener("input",function(s){e.setValue(t,{value:n(s,!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class A extends u{constructor(e){super(e,{isRenderable:!!(e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str)})}render(){if(this.container.className="popupAnnotation",["Line","Square","Circle","PolyLine","Polygon","Ink"].includes(this.data.parentType))return this.container;const e=`[data-annotation-id="${this.data.parentId}"]`,t=this.layer.querySelectorAll(e);if(0===t.length)return this.container;const s=new P({container:this.container,trigger:Array.from(t),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),a=this.page,r=i.Util.normalizeRect([this.data.parentRect[0],a.view[3]-this.data.parentRect[1]+a.view[1],this.data.parentRect[2],a.view[3]-this.data.parentRect[3]+a.view[1]]),n=r[0]+this.data.parentRect[2]-this.data.parentRect[0],o=r[1],[l,c,d,h]=this.viewport.viewBox,u=d-l,p=h-c;return this.container.style.left=100*(n-l)/u+"%",this.container.style.top=100*(o-c)/p+"%",this.container.append(s.render()),this.container}}class P{constructor(e){this.container=e.container,this.trigger=e.trigger,this.color=e.color,this.titleObj=e.titleObj,this.modificationDate=e.modificationDate,this.contentsObj=e.contentsObj,this.richText=e.richText,this.hideWrapper=e.hideWrapper||!1,this.pinned=!1}render(){const e=document.createElement("div");e.className="popupWrapper",this.hideElement=this.hideWrapper?e:this.container,this.hideElement.hidden=!0;const t=document.createElement("div");t.className="popup";const s=this.color;if(s){const e=.7*(255-s[0])+s[0],a=.7*(255-s[1])+s[1],r=.7*(255-s[2])+s[2];t.style.backgroundColor=i.Util.makeHexColor(0|e,0|a,0|r)}const r=document.createElement("h1");r.dir=this.titleObj.dir,r.textContent=this.titleObj.str,t.append(r);const n=a.PDFDateString.toDateObject(this.modificationDate);if(n){const e=document.createElement("span");e.className="popupDate",e.textContent="{{date}}, {{time}}",e.dataset.l10nId="annotation_date_string",e.dataset.l10nArgs=JSON.stringify({date:n.toLocaleDateString(),time:n.toLocaleTimeString()}),t.append(e)}if(!this.richText?.str||this.contentsObj?.str&&this.contentsObj.str!==this.richText.str){const e=this._formatContents(this.contentsObj);t.append(e)}else o.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:t}),t.lastChild.className="richText popupContent";Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const e of this.trigger)e.addEventListener("click",this._toggle.bind(this)),e.addEventListener("mouseover",this._show.bind(this,!1)),e.addEventListener("mouseout",this._hide.bind(this,!1));return t.addEventListener("click",this._hide.bind(this,!0)),e.append(t),e}_formatContents({str:e,dir:t}){const s=document.createElement("p");s.className="popupContent",s.dir=t;const i=e.split(/(?:\r\n?|\n)/);for(let e=0,t=i.length;e<t;++e){const a=i[e];s.append(document.createTextNode(a)),e<t-1&&s.append(document.createElement("br"))}return s}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(e=!1){e&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(e=!0){e&&(this.pinned=!1),this.hideElement.hidden||this.pinned||(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class S extends u{constructor(e){super(e,{isRenderable:!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str),ignoreBorder:!0}),this.textContent=e.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const e=document.createElement("div");e.className="annotationTextContent",e.setAttribute("role","comment");for(const t of this.textContent){const s=document.createElement("span");s.textContent=t,e.append(s)}this.container.append(e)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class x extends u{constructor(e){super(e,{isRenderable:!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str),ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const e=this.data,{width:t,height:s}=d(e.rect),i=this.svgFactory.create(t,s,!0),a=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),a.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),a.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),a.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),this._createPopup(a,e),this.container}}class F extends u{constructor(e){super(e,{isRenderable:!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str),ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const e=this.data,{width:t,height:s}=d(e.rect),i=this.svgFactory.create(t,s,!0),a=e.borderStyle.width,r=this.svgFactory.createElement("svg:rect");return r.setAttribute("x",a/2),r.setAttribute("y",a/2),r.setAttribute("width",t-a),r.setAttribute("height",s-a),r.setAttribute("stroke-width",a||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),this._createPopup(r,e),this.container}}class C extends u{constructor(e){super(e,{isRenderable:!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str),ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const e=this.data,{width:t,height:s}=d(e.rect),i=this.svgFactory.create(t,s,!0),a=e.borderStyle.width,r=this.svgFactory.createElement("svg:ellipse");return r.setAttribute("cx",t/2),r.setAttribute("cy",s/2),r.setAttribute("rx",t/2-a/2),r.setAttribute("ry",s/2-a/2),r.setAttribute("stroke-width",a||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),this._createPopup(r,e),this.container}}class w extends u{constructor(e){super(e,{isRenderable:!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str),ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const e=this.data,{width:t,height:s}=d(e.rect),i=this.svgFactory.create(t,s,!0);let a=[];for(const t of e.vertices){const s=t.x-e.rect[0],i=e.rect[3]-t.y;a.push(s+","+i)}a=a.join(" ");const r=this.svgFactory.createElement(this.svgElementName);return r.setAttribute("points",a),r.setAttribute("stroke-width",e.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","transparent"),i.append(r),this.container.append(i),this._createPopup(r,e),this.container}}class E extends w{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class L extends u{constructor(e){super(e,{isRenderable:!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str),ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class T extends u{constructor(e){super(e,{isRenderable:!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str),ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const e=this.data,{width:t,height:s}=d(e.rect),i=this.svgFactory.create(t,s,!0);for(const t of e.inkLists){let s=[];for(const i of t){const t=i.x-e.rect[0],a=e.rect[3]-i.y;s.push(`${t},${a}`)}s=s.join(" ");const a=this.svgFactory.createElement(this.svgElementName);a.setAttribute("points",s),a.setAttribute("stroke-width",e.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),this._createPopup(a,e),i.append(a)}return this.container.append(i),this.container}}class k extends u{constructor(e){super(e,{isRenderable:!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class M extends u{constructor(e){super(e,{isRenderable:!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class R extends u{constructor(e){super(e,{isRenderable:!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class O extends u{constructor(e){super(e,{isRenderable:!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str),ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class D extends u{constructor(e){super(e,{isRenderable:!!(e.data.hasPopup||e.data.titleObj?.str||e.data.contentsObj?.str||e.data.richText?.str),ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class I extends u{constructor(e){super(e,{isRenderable:!0});const{filename:t,content:s}=this.data.file;this.filename=(0,a.getFilenameFromUrl)(t),this.content=s,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:t,content:s})}render(){this.container.className="fileAttachmentAnnotation";const e=document.createElement("div");return e.className="popupTriggerArea",e.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(this.data.titleObj?.str||this.data.contentsObj?.str||this.data.richText)&&this._createPopup(e,this.data),this.container.append(e),this.container}_download(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}var B=_classPrivateFieldLooseKey("appendElement"),N=_classPrivateFieldLooseKey("setDimensions"),j=_classPrivateFieldLooseKey("setAnnotationCanvasMap");class U{static render(e){const{annotations:t,div:s,viewport:n,accessibilityManager:o}=e;_classPrivateFieldLooseBase(this,N)[N](s,n);let l=0;for(const c of t){if(c.annotationType!==i.AnnotationType.POPUP){const{width:e,height:t}=d(c.rect);if(e<=0||t<=0)continue}const t=h.create({data:c,layer:s,page:e.page,viewport:n,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:!1!==e.renderForms,svgFactory:new a.DOMSVGFactory,annotationStorage:e.annotationStorage||new r.AnnotationStorage,enableScripting:e.enableScripting,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,mouseState:e.mouseState||{isDown:!1}});if(t.isRenderable){const e=t.render();if(c.hidden&&(e.style.visibility="hidden"),Array.isArray(e))for(const t of e)t.style.zIndex=l++,_classPrivateFieldLooseBase(U,B)[B](t,c.id,s,o);else e.style.zIndex=l++,t instanceof A?s.prepend(e):_classPrivateFieldLooseBase(U,B)[B](e,c.id,s,o)}}_classPrivateFieldLooseBase(this,j)[j](s,e.annotationCanvasMap)}static update(e){const{annotationCanvasMap:t,div:s,viewport:i}=e;_classPrivateFieldLooseBase(this,N)[N](s,i),_classPrivateFieldLooseBase(this,j)[j](s,t),s.hidden=!1}}Object.defineProperty(U,j,{value:function(e,t){if(t){for(const[s,i]of t){const t=e.querySelector(`[data-annotation-id="${s}"]`);if(!t)continue;const{firstChild:a}=t;a?"CANVAS"===a.nodeName?a.replaceWith(i):a.before(i):t.append(i)}t.clear()}}}),Object.defineProperty(U,N,{value:function(e,{width:t,height:s,rotation:i}){const{style:a}=e,r=i%180!=0,n=Math.floor(t)+"px",o=Math.floor(s)+"px";a.width=r?o:n,a.height=r?n:o,e.setAttribute("data-main-rotation",i)}}),Object.defineProperty(U,B,{value:function(e,t,s,i){const r=e.firstChild||e;r.id=`${a.AnnotationPrefix}${t}`,s.append(e),i?.moveElementInDOM(s,e,r,!1)}}),t.AnnotationLayer=U},(e,t)=>{function s(e){return Math.floor(255*Math.max(0,Math.min(1,e))).toString(16).padStart(2,"0")}Object.defineProperty(t,"__esModule",{value:!0}),t.ColorConverters=void 0,t.ColorConverters=class{static CMYK_G([e,t,s,i]){return["G",1-Math.min(1,.3*e+.59*s+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_HTML([e]){const t=s(e);return`#${t}${t}${t}`}static RGB_G([e,t,s]){return["G",.3*e+.59*t+.11*s]}static RGB_HTML([e,t,i]){return`#${s(e)}${s(t)}${s(i)}`}static T_HTML(){return"#00000000"}static CMYK_RGB([e,t,s,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,s+i),1-Math.min(1,t+i)]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,s]){const i=1-e,a=1-t,r=1-s;return["CMYK",i,a,r,Math.min(i,a,r)]}}},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaLayer=void 0;var i=s(20);t.XfaLayer=class{static setupStorage(e,t,s,i,a){const r=i.getValue(t,{value:null});switch(s.name){case"textarea":if(null!==r.value&&(e.textContent=r.value),"print"===a)break;e.addEventListener("input",e=>{i.setValue(t,{value:e.target.value})});break;case"input":if("radio"===s.attributes.type||"checkbox"===s.attributes.type){if(r.value===s.attributes.xfaOn?e.setAttribute("checked",!0):r.value===s.attributes.xfaOff&&e.removeAttribute("checked"),"print"===a)break;e.addEventListener("change",e=>{i.setValue(t,{value:e.target.checked?e.target.getAttribute("xfaOn"):e.target.getAttribute("xfaOff")})})}else{if(null!==r.value&&e.setAttribute("value",r.value),"print"===a)break;e.addEventListener("input",e=>{i.setValue(t,{value:e.target.value})})}break;case"select":if(null!==r.value)for(const e of s.children)e.attributes.value===r.value&&(e.attributes.selected=!0);e.addEventListener("input",e=>{const s=e.target.options,a=-1===s.selectedIndex?"":s[s.selectedIndex].value;i.setValue(t,{value:a})})}}static setAttributes({html:e,element:t,storage:s=null,intent:i,linkService:a}){const{attributes:r}=t,n=e instanceof HTMLAnchorElement;"radio"===r.type&&(r.name=`${r.name}-${i}`);for(const[t,s]of Object.entries(r))if(null!=s)switch(t){case"class":s.length&&e.setAttribute(t,s.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",s);break;case"style":Object.assign(e.style,s);break;case"textContent":e.textContent=s;break;default:(!n||"href"!==t&&"newWindow"!==t)&&e.setAttribute(t,s)}n&&a.addLinkAttributes(e,r.href,r.newWindow),s&&r.dataId&&this.setupStorage(e,r.dataId,t,s)}static render(e){const t=e.annotationStorage,s=e.linkService,a=e.xfaHtml,r=e.intent||"display",n=document.createElement(a.name);a.attributes&&this.setAttributes({html:n,element:a,intent:r,linkService:s});const o=[[a,-1,n]],l=e.div;if(l.append(n),e.viewport){const t=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=t}"richText"!==r&&l.setAttribute("class","xfaLayer xfaFont");const c=[];for(;o.length>0;){const[e,a,n]=o.at(-1);if(a+1===e.children.length){o.pop();continue}const l=e.children[++o.at(-1)[1]];if(null===l)continue;const{name:d}=l;if("#text"===d){const e=document.createTextNode(l.value);c.push(e),n.append(e);continue}let h;if(h=l?.attributes?.xmlns?document.createElementNS(l.attributes.xmlns,d):document.createElement(d),n.append(h),l.attributes&&this.setAttributes({html:h,element:l,storage:t,intent:r,linkService:s}),l.children&&l.children.length>0)o.push([l,-1,h]);else if(l.value){const e=document.createTextNode(l.value);i.XfaText.shouldBuildText(d)&&c.push(e),h.append(e)}}for(const e of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))e.setAttribute("readOnly",!0);return{textDivs:c}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextLayerRenderTask=void 0,t.renderTextLayer=function(e){const t=new f({textContent:e.textContent,textContentStream:e.textContentStream,container:e.container,viewport:e.viewport,textDivs:e.textDivs,textContentItemsStr:e.textContentItemsStr,enhanceTextSelection:e.enhanceTextSelection});return t._render(e.timeout),t};var i=s(1),a=s(8);const r=30,n=new Map,o=/^\s+$/g;function l(e,t){const s=n.get(e);if(s)return s;t.save(),t.font=`30px ${e}`;const i=t.measureText("");let a=i.fontBoundingBoxAscent,o=Math.abs(i.fontBoundingBoxDescent);if(a){t.restore();const s=a/(a+o);return n.set(e,s),s}t.strokeStyle="red",t.clearRect(0,0,r,r),t.strokeText("g",0,0);let l=t.getImageData(0,0,r,r).data;o=0;for(let e=l.length-1-3;e>=0;e-=4)if(l[e]>0){o=Math.ceil(e/4/r);break}t.clearRect(0,0,r,r),t.strokeText("A",0,r),l=t.getImageData(0,0,r,r).data,a=0;for(let e=0,t=l.length;e<t;e+=4)if(l[e]>0){a=r-Math.floor(e/4/r);break}if(t.restore(),a){const t=a/(a+o);return n.set(e,t),t}return n.set(e,.8),.8}function c(e,t,s,a){const r=document.createElement("span"),n=e._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:""!==t.str,hasEOL:t.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:""!==t.str,hasEOL:t.hasEOL,fontSize:0};e._textDivs.push(r);const c=i.Util.transform(e._viewport.transform,t.transform);let d=Math.atan2(c[1],c[0]);const h=s[t.fontName];h.vertical&&(d+=Math.PI/2);const u=Math.hypot(c[2],c[3]),p=u*l(h.fontFamily,a);let g,f;0===d?(g=c[4],f=c[5]-p):(g=c[4]+p*Math.sin(d),f=c[5]-p*Math.cos(d)),r.style.left=`${g}px`,r.style.top=`${f}px`,r.style.fontSize=`${u}px`,r.style.fontFamily=h.fontFamily,n.fontSize=u,r.setAttribute("role","presentation"),r.textContent=t.str,r.dir=t.dir,e._fontInspectorEnabled&&(r.dataset.fontName=t.fontName),0!==d&&(n.angle=d*(180/Math.PI));let m=!1;if(t.str.length>1||e._enhanceTextSelection&&o.test(t.str))m=!0;else if(" "!==t.str&&t.transform[0]!==t.transform[3]){const e=Math.abs(t.transform[0]),s=Math.abs(t.transform[3]);e!==s&&Math.max(e,s)/Math.min(e,s)>1.5&&(m=!0)}if(m&&(h.vertical?n.canvasWidth=t.height*e._viewport.scale:n.canvasWidth=t.width*e._viewport.scale),e._textDivProperties.set(r,n),e._textContentStream&&e._layoutText(r),e._enhanceTextSelection&&n.hasText){let s=1,a=0;0!==d&&(s=Math.cos(d),a=Math.sin(d));const n=(h.vertical?t.height:t.width)*e._viewport.scale,o=u;let l,c;0!==d?(l=[s,a,-a,s,g,f],c=i.Util.getAxialAlignedBoundingBox([0,0,n,o],l)):c=[g,f,g+n,f+o],e._bounds.push({left:c[0],top:c[1],right:c[2],bottom:c[3],div:r,size:[n,o],m:l})}}function d(e){if(e._canceled)return;const t=e._textDivs,s=e._capability,i=t.length;if(i>1e5)return e._renderingDone=!0,void s.resolve();if(!e._textContentStream)for(let s=0;s<i;s++)e._layoutText(t[s]);e._renderingDone=!0,s.resolve()}function h(e,t,s){let i=0;for(let a=0;a<s;a++){const s=e[t++];s>0&&(i=i?Math.min(s,i):s)}return i}function u(e){const t=e._bounds,s=e._viewport,a=p(s.width,s.height,t);for(let s=0;s<a.length;s++){const r=t[s].div,n=e._textDivProperties.get(r);if(0===n.angle){n.paddingLeft=t[s].left-a[s].left,n.paddingTop=t[s].top-a[s].top,n.paddingRight=a[s].right-t[s].right,n.paddingBottom=a[s].bottom-t[s].bottom,e._textDivProperties.set(r,n);continue}const o=a[s],l=t[s],c=l.m,d=c[0],u=c[1],p=[[0,0],[0,l.size[1]],[l.size[0],0],l.size],g=new Float64Array(64);for(let e=0,t=p.length;e<t;e++){const t=i.Util.applyTransform(p[e],c);g[e+0]=d&&(o.left-t[0])/d,g[e+4]=u&&(o.top-t[1])/u,g[e+8]=d&&(o.right-t[0])/d,g[e+12]=u&&(o.bottom-t[1])/u,g[e+16]=u&&(o.left-t[0])/-u,g[e+20]=d&&(o.top-t[1])/d,g[e+24]=u&&(o.right-t[0])/-u,g[e+28]=d&&(o.bottom-t[1])/d,g[e+32]=d&&(o.left-t[0])/-d,g[e+36]=u&&(o.top-t[1])/-u,g[e+40]=d&&(o.right-t[0])/-d,g[e+44]=u&&(o.bottom-t[1])/-u,g[e+48]=u&&(o.left-t[0])/u,g[e+52]=d&&(o.top-t[1])/-d,g[e+56]=u&&(o.right-t[0])/u,g[e+60]=d&&(o.bottom-t[1])/-d}const f=1+Math.min(Math.abs(d),Math.abs(u));n.paddingLeft=h(g,32,16)/f,n.paddingTop=h(g,48,16)/f,n.paddingRight=h(g,0,16)/f,n.paddingBottom=h(g,16,16)/f,e._textDivProperties.set(r,n)}}function p(e,t,s){const i=s.map(function(e,t){return{x1:e.left,y1:e.top,x2:e.right,y2:e.bottom,index:t,x1New:void 0,x2New:void 0}});g(e,i);const a=new Array(s.length);for(const e of i){const t=e.index;a[t]={left:e.x1New,top:0,right:e.x2New,bottom:0}}s.map(function(t,s){const r=a[s],n=i[s];n.x1=t.top,n.y1=e-r.right,n.x2=t.bottom,n.y2=e-r.left,n.index=s,n.x1New=void 0,n.x2New=void 0}),g(t,i);for(const e of i){const t=e.index;a[t].top=e.x1New,a[t].bottom=e.x2New}return a}function g(e,t){t.sort(function(e,t){return e.x1-t.x1||e.index-t.index});const s=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const e of t){let t=0;for(;t<s.length&&s[t].end<=e.y1;)t++;let i,a,r=s.length-1;for(;r>=0&&s[r].start>=e.y2;)r--;let n,o,l=-1/0;for(n=t;n<=r;n++){let t;i=s[n],a=i.boundary,t=a.x2>e.x1?a.index>e.index?a.x1New:e.x1:void 0===a.x2New?(a.x2+e.x1)/2:a.x2New,t>l&&(l=t)}for(e.x1New=l,n=t;n<=r;n++)i=s[n],a=i.boundary,void 0===a.x2New?a.x2>e.x1?a.index>e.index&&(a.x2New=a.x2):a.x2New=l:a.x2New>l&&(a.x2New=Math.max(l,a.x2));const c=[];let d=null;for(n=t;n<=r;n++){i=s[n],a=i.boundary;const t=a.x2>e.x2?a:e;d===t?c.at(-1).end=i.end:(c.push({start:i.start,end:i.end,boundary:t}),d=t)}for(s[t].start<e.y1&&(c[0].start=e.y1,c.unshift({start:s[t].start,end:e.y1,boundary:s[t].boundary})),e.y2<s[r].end&&(c.at(-1).end=e.y2,c.push({start:e.y2,end:s[r].end,boundary:s[r].boundary})),n=t;n<=r;n++){if(i=s[n],a=i.boundary,void 0!==a.x2New)continue;let e=!1;for(o=t-1;!e&&o>=0&&s[o].start>=a.y1;o--)e=s[o].boundary===a;for(o=r+1;!e&&o<s.length&&s[o].end<=a.y2;o++)e=s[o].boundary===a;for(o=0;!e&&o<c.length;o++)e=c[o].boundary===a;e||(a.x2New=l)}Array.prototype.splice.apply(s,[t,r-t+1,...c])}for(const t of s){const s=t.boundary;void 0===s.x2New&&(s.x2New=Math.max(e,s.x2))}}class f{constructor({textContent:e,textContentStream:t,container:s,viewport:r,textDivs:n,textContentItemsStr:o,enhanceTextSelection:l}){l&&(0,a.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=e,this._textContentStream=t,this._container=s,this._document=s.ownerDocument,this._viewport=r,this._textDivs=n||[],this._textContentItemsStr=o||[],this._enhanceTextSelection=!!l,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,i.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new i.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),null!==this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(e,t){for(let s=0,i=e.length;s<i;s++)if(void 0!==e[s].str)this._textContentItemsStr.push(e[s].str),c(this,e[s],t,this._layoutTextCtx);else if("beginMarkedContentProps"===e[s].type||"beginMarkedContent"===e[s].type){const t=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),null!==e[s].id&&this._container.setAttribute("id",`${e[s].id}`),t.append(this._container)}else"endMarkedContent"===e[s].type&&(this._container=this._container.parentNode)}_layoutText(e){const t=this._textDivProperties.get(e);let s="";if(0!==t.canvasWidth&&t.hasText){const{fontFamily:i}=e.style,{fontSize:a}=t;a===this._layoutTextLastFontSize&&i===this._layoutTextLastFontFamily||(this._layoutTextCtx.font=`${a*this._devicePixelRatio}px ${i}`,this._layoutTextLastFontSize=a,this._layoutTextLastFontFamily=i);const{width:r}=this._layoutTextCtx.measureText(e.textContent);if(r>0){const e=this._devicePixelRatio*t.canvasWidth/r;this._enhanceTextSelection&&(t.scale=e),s=`scaleX(${e})`}}if(0!==t.angle&&(s=`rotate(${t.angle}deg) ${s}`),s.length>0&&(this._enhanceTextSelection&&(t.originalTransform=s),e.style.transform=s),t.hasText&&this._container.append(e),t.hasEOL){const e=document.createElement("br");e.setAttribute("role","presentation"),this._container.append(e)}}_render(e=0){const t=(0,i.createPromiseCapability)();let s=Object.create(null);const a=this._document.createElement("canvas");if(a.height=a.width=r,this._layoutTextCtx=a.getContext("2d",{alpha:!1}),this._textContent){const e=this._textContent.items,s=this._textContent.styles;this._processItems(e,s),t.resolve()}else{if(!this._textContentStream)throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');{const e=()=>{this._reader.read().then(({value:i,done:a})=>{a?t.resolve():(Object.assign(s,i.styles),this._processItems(i.items,s),e())},t.reject)};this._reader=this._textContentStream.getReader(),e()}}t.promise.then(()=>{s=null,e?this._renderTimer=setTimeout(()=>{d(this),this._renderTimer=null},e):d(this)},this._capability.reject)}expandTextDivs(e=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;null!==this._bounds&&(u(this),this._bounds=null);const t=[],s=[];for(let i=0,a=this._textDivs.length;i<a;i++){const a=this._textDivs[i],r=this._textDivProperties.get(a);r.hasText&&(e?(t.length=0,s.length=0,r.originalTransform&&t.push(r.originalTransform),r.paddingTop>0?(s.push(`${r.paddingTop}px`),t.push(`translateY(${-r.paddingTop}px)`)):s.push(0),r.paddingRight>0?s.push(r.paddingRight/r.scale+"px"):s.push(0),r.paddingBottom>0?s.push(`${r.paddingBottom}px`):s.push(0),r.paddingLeft>0?(s.push(r.paddingLeft/r.scale+"px"),t.push(`translateX(${-r.paddingLeft/r.scale}px)`)):s.push(0),a.style.padding=s.join(" "),t.length&&(a.style.transform=t.join(" "))):(a.style.padding=null,a.style.transform=r.originalTransform))}}}t.TextLayerRenderTask=f},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SVGGraphics=void 0;var i=s(8),a=s(1),r=s(3);let n=class{constructor(){(0,a.unreachable)("Not implemented: SVGGraphics")}};t.SVGGraphics=n;{const o={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},l="http://www.w3.org/XML/1998/namespace",c="http://www.w3.org/1999/xlink",d=["butt","round","square"],h=["miter","round","bevel"],u=function(e,t="",s=!1){if(URL.createObjectURL&&"undefined"!=typeof Blob&&!s)return URL.createObjectURL(new Blob([e],{type:t}));const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let a=`data:${t};base64,`;for(let t=0,s=e.length;t<s;t+=3){const r=255&e[t],n=255&e[t+1],o=255&e[t+2];a+=i[r>>2]+i[(3&r)<<4|n>>4]+i[t+1<s?(15&n)<<2|o>>6:64]+i[t+2<s?63&o:64]}return a},p=(function(){const e=new Uint8Array([137,80,78,71,13,10,26,10]),t=new Int32Array(256);for(let e=0;e<256;e++){let s=e;for(let e=0;e<8;e++)s=1&s?3988292384^s>>1&2147483647:s>>1&2147483647;t[e]=s}function s(e,s,i){let a=-1;for(let r=s;r<i;r++){const s=255&(a^e[r]);a=a>>>8^t[s]}return-1^a}function i(e,t,i,a){let r=a;const n=t.length;i[r]=n>>24&255,i[r+1]=n>>16&255,i[r+2]=n>>8&255,i[r+3]=255&n,r+=4,i[r]=255&e.charCodeAt(0),i[r+1]=255&e.charCodeAt(1),i[r+2]=255&e.charCodeAt(2),i[r+3]=255&e.charCodeAt(3),r+=4,i.set(t,r),r+=t.length;const o=s(i,a+4,r);i[r]=o>>24&255,i[r+1]=o>>16&255,i[r+2]=o>>8&255,i[r+3]=255&o}function n(e,t,s){let i=1,a=0;for(let r=t;r<s;++r)i=(i+(255&e[r]))%65521,a=(a+i)%65521;return a<<16|i}function o(e){if(!r.isNodeJS)return l(e);try{let t;t=parseInt(process.versions.node)>=8?e:Buffer.from(e);const s=require(_dependencyMap[4],"zlib").deflateSync(t,{level:9});return s instanceof Uint8Array?s:new Uint8Array(s)}catch(e){(0,a.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+e)}return l(e)}function l(e){let t=e.length;const s=65535,i=Math.ceil(t/s),a=new Uint8Array(2+t+5*i+4);let r=0;a[r++]=120,a[r++]=156;let o=0;for(;t>s;)a[r++]=0,a[r++]=255,a[r++]=255,a[r++]=0,a[r++]=0,a.set(e.subarray(o,o+s),r),r+=s,o+=s,t-=s;a[r++]=1,a[r++]=255&t,a[r++]=t>>8&255,a[r++]=255&~t,a[r++]=(65535&~t)>>8&255,a.set(e.subarray(o),r),r+=e.length-o;const l=n(e,0,e.length);return a[r++]=l>>24&255,a[r++]=l>>16&255,a[r++]=l>>8&255,a[r++]=255&l,a}function c(t,s,r,n){const l=t.width,c=t.height;let d,h,p;const g=t.data;switch(s){case a.ImageKind.GRAYSCALE_1BPP:h=0,d=1,p=l+7>>3;break;case a.ImageKind.RGB_24BPP:h=2,d=8,p=3*l;break;case a.ImageKind.RGBA_32BPP:h=6,d=8,p=4*l;break;default:throw new Error("invalid format")}const f=new Uint8Array((1+p)*c);let m=0,_=0;for(let e=0;e<c;++e)f[m++]=0,f.set(g.subarray(_,_+p),m),_+=p,m+=p;if(s===a.ImageKind.GRAYSCALE_1BPP&&n){m=0;for(let e=0;e<c;e++){m++;for(let e=0;e<p;e++)f[m++]^=255}}const v=new Uint8Array([l>>24&255,l>>16&255,l>>8&255,255&l,c>>24&255,c>>16&255,c>>8&255,255&c,d,h,0,0,0]),b=o(f),y=e.length+36+v.length+b.length,A=new Uint8Array(y);let P=0;return A.set(e,P),P+=e.length,i("IHDR",v,A,P),P+=12+v.length,i("IDATA",b,A,P),P+=12+b.length,i("IEND",new Uint8Array(0),A,P),u(A,"image/png",r)}return function(e,t,s){return c(e,void 0===e.kind?a.ImageKind.GRAYSCALE_1BPP:e.kind,t,s)}})();class g{constructor(){this.fontSizeScale=1,this.fontWeight=o.fontWeight,this.fontSize=0,this.textMatrix=a.IDENTITY_MATRIX,this.fontMatrix=a.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=a.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=o.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(e,t){this.x=e,this.y=t}}function f(e){let t=[];const s=[];for(const i of e)"save"!==i.fn?"restore"===i.fn?t=s.pop():t.push(i):(t.push({fnId:92,fn:"group",items:[]}),s.push(t),t=t.at(-1).items);return t}function m(e){if(Number.isInteger(e))return e.toString();const t=e.toFixed(10);let s=t.length-1;if("0"!==t[s])return t;do{s--}while("0"===t[s]);return t.substring(0,"."===t[s]?s:s+1)}function _(e){if(0===e[4]&&0===e[5]){if(0===e[1]&&0===e[2])return 1===e[0]&&1===e[3]?"":`scale(${m(e[0])} ${m(e[3])})`;if(e[0]===e[3]&&e[1]===-e[2])return`rotate(${m(180*Math.acos(e[0])/Math.PI)})`}else if(1===e[0]&&0===e[1]&&0===e[2]&&1===e[3])return`translate(${m(e[4])} ${m(e[5])})`;return`matrix(${m(e[0])} ${m(e[1])} ${m(e[2])} ${m(e[3])} ${m(e[4])} ${m(e[5])})`}let v=0,b=0,y=0;t.SVGGraphics=n=class{constructor(e,t,s=!1){(0,i.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new i.DOMSVGFactory,this.current=new g,this.transformMatrix=a.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=t,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!s,this._operatorIdMapping=[];for(const e in a.OPS)this._operatorIdMapping[a.OPS[e]]=e}save(){this.transformStack.push(this.transformMatrix);const e=this.current;this.extraStack.push(e),this.current=e.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(e){this.save(),this.executeOpTree(e),this.restore()}loadDependencies(e){const t=e.fnArray,s=e.argsArray;for(let e=0,i=t.length;e<i;e++)if(t[e]===a.OPS.dependency)for(const t of s[e]){const e=t.startsWith("g_")?this.commonObjs:this.objs,s=new Promise(s=>{e.get(t,s)});this.current.dependencies.push(s)}return Promise.all(this.current.dependencies)}transform(e,t,s,i,r,n){const o=[e,t,s,i,r,n];this.transformMatrix=a.Util.transform(this.transformMatrix,o),this.tgrp=null}getSVG(e,t){this.viewport=t;const s=this._initialize(t);return this.loadDependencies(e).then(()=>(this.transformMatrix=a.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(e)),s))}convertOpList(e){const t=this._operatorIdMapping,s=e.argsArray,i=e.fnArray,a=[];for(let e=0,r=i.length;e<r;e++){const r=i[e];a.push({fnId:r,fn:t[r],args:s[e]})}return f(a)}executeOpTree(e){for(const t of e){const e=t.fn,s=t.fnId,i=t.args;switch(0|s){case a.OPS.beginText:this.beginText();break;case a.OPS.dependency:break;case a.OPS.setLeading:this.setLeading(i);break;case a.OPS.setLeadingMoveText:this.setLeadingMoveText(i[0],i[1]);break;case a.OPS.setFont:this.setFont(i);break;case a.OPS.showText:case a.OPS.showSpacedText:this.showText(i[0]);break;case a.OPS.endText:this.endText();break;case a.OPS.moveText:this.moveText(i[0],i[1]);break;case a.OPS.setCharSpacing:this.setCharSpacing(i[0]);break;case a.OPS.setWordSpacing:this.setWordSpacing(i[0]);break;case a.OPS.setHScale:this.setHScale(i[0]);break;case a.OPS.setTextMatrix:this.setTextMatrix(i[0],i[1],i[2],i[3],i[4],i[5]);break;case a.OPS.setTextRise:this.setTextRise(i[0]);break;case a.OPS.setTextRenderingMode:this.setTextRenderingMode(i[0]);break;case a.OPS.setLineWidth:this.setLineWidth(i[0]);break;case a.OPS.setLineJoin:this.setLineJoin(i[0]);break;case a.OPS.setLineCap:this.setLineCap(i[0]);break;case a.OPS.setMiterLimit:this.setMiterLimit(i[0]);break;case a.OPS.setFillRGBColor:this.setFillRGBColor(i[0],i[1],i[2]);break;case a.OPS.setStrokeRGBColor:this.setStrokeRGBColor(i[0],i[1],i[2]);break;case a.OPS.setStrokeColorN:this.setStrokeColorN(i);break;case a.OPS.setFillColorN:this.setFillColorN(i);break;case a.OPS.shadingFill:this.shadingFill(i[0]);break;case a.OPS.setDash:this.setDash(i[0],i[1]);break;case a.OPS.setRenderingIntent:this.setRenderingIntent(i[0]);break;case a.OPS.setFlatness:this.setFlatness(i[0]);break;case a.OPS.setGState:this.setGState(i[0]);break;case a.OPS.fill:this.fill();break;case a.OPS.eoFill:this.eoFill();break;case a.OPS.stroke:this.stroke();break;case a.OPS.fillStroke:this.fillStroke();break;case a.OPS.eoFillStroke:this.eoFillStroke();break;case a.OPS.clip:this.clip("nonzero");break;case a.OPS.eoClip:this.clip("evenodd");break;case a.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case a.OPS.paintImageXObject:this.paintImageXObject(i[0]);break;case a.OPS.paintInlineImageXObject:this.paintInlineImageXObject(i[0]);break;case a.OPS.paintImageMaskXObject:this.paintImageMaskXObject(i[0]);break;case a.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(i[0],i[1]);break;case a.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case a.OPS.closePath:this.closePath();break;case a.OPS.closeStroke:this.closeStroke();break;case a.OPS.closeFillStroke:this.closeFillStroke();break;case a.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case a.OPS.nextLine:this.nextLine();break;case a.OPS.transform:this.transform(i[0],i[1],i[2],i[3],i[4],i[5]);break;case a.OPS.constructPath:this.constructPath(i[0],i[1]);break;case a.OPS.endPath:this.endPath();break;case 92:this.group(t.items);break;default:(0,a.warn)(`Unimplemented operator ${e}`)}}}setWordSpacing(e){this.current.wordSpacing=e}setCharSpacing(e){this.current.charSpacing=e}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(e,t,s,i,a,r){const n=this.current;n.textMatrix=n.lineMatrix=[e,t,s,i,a,r],n.textMatrixScale=Math.hypot(e,t),n.x=n.lineX=0,n.y=n.lineY=0,n.xcoords=[],n.ycoords=[],n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size",`${m(n.fontSize)}px`),n.tspan.setAttributeNS(null,"y",m(-n.y)),n.txtElement=this.svgFactory.createElement("svg:text"),n.txtElement.append(n.tspan)}beginText(){const e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=a.IDENTITY_MATRIX,e.lineMatrix=a.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[],e.ycoords=[]}moveText(e,t){const s=this.current;s.x=s.lineX+=e,s.y=s.lineY+=t,s.xcoords=[],s.ycoords=[],s.tspan=this.svgFactory.createElement("svg:tspan"),s.tspan.setAttributeNS(null,"font-family",s.fontFamily),s.tspan.setAttributeNS(null,"font-size",`${m(s.fontSize)}px`),s.tspan.setAttributeNS(null,"y",m(-s.y))}showText(e){const t=this.current,s=t.font,i=t.fontSize;if(0===i)return;const r=t.fontSizeScale,n=t.charSpacing,c=t.wordSpacing,d=t.fontDirection,h=t.textHScale*d,u=s.vertical,p=u?1:-1,g=s.defaultVMetrics,f=i*t.fontMatrix[0];let v=0;for(const a of e){if(null===a){v+=d*c;continue}if("number"==typeof a){v+=p*a*i/1e3;continue}const e=(a.isSpace?c:0)+n,o=a.fontChar;let l,h,m,_=a.width;if(u){let e;const t=a.vmetric||g;e=a.vmetric?t[1]:.5*_,e=-e*f;const s=t[2]*f;_=t?-t[0]:_,l=e/r,h=(v+s)/r}else l=v/r,h=0;(a.isInFont||s.missingFile)&&(t.xcoords.push(t.x+l),u&&t.ycoords.push(-t.y+h),t.tspan.textContent+=o),m=u?_*f-e*d:_*f+e*d,v+=m}t.tspan.setAttributeNS(null,"x",t.xcoords.map(m).join(" ")),u?t.tspan.setAttributeNS(null,"y",t.ycoords.map(m).join(" ")):t.tspan.setAttributeNS(null,"y",m(-t.y)),u?t.y-=v:t.x+=v*h,t.tspan.setAttributeNS(null,"font-family",t.fontFamily),t.tspan.setAttributeNS(null,"font-size",`${m(t.fontSize)}px`),t.fontStyle!==o.fontStyle&&t.tspan.setAttributeNS(null,"font-style",t.fontStyle),t.fontWeight!==o.fontWeight&&t.tspan.setAttributeNS(null,"font-weight",t.fontWeight);const b=t.textRenderingMode&a.TextRenderingMode.FILL_STROKE_MASK;if(b===a.TextRenderingMode.FILL||b===a.TextRenderingMode.FILL_STROKE?(t.fillColor!==o.fillColor&&t.tspan.setAttributeNS(null,"fill",t.fillColor),t.fillAlpha<1&&t.tspan.setAttributeNS(null,"fill-opacity",t.fillAlpha)):t.textRenderingMode===a.TextRenderingMode.ADD_TO_PATH?t.tspan.setAttributeNS(null,"fill","transparent"):t.tspan.setAttributeNS(null,"fill","none"),b===a.TextRenderingMode.STROKE||b===a.TextRenderingMode.FILL_STROKE){const e=1/(t.textMatrixScale||1);this._setStrokeAttributes(t.tspan,e)}let y=t.textMatrix;0!==t.textRise&&(y=y.slice(),y[5]+=t.textRise),t.txtElement.setAttributeNS(null,"transform",`${_(y)} scale(${m(h)}, -1)`),t.txtElement.setAttributeNS(l,"xml:space","preserve"),t.txtElement.append(t.tspan),t.txtgrp.append(t.txtElement),this._ensureTransformGroup().append(t.txtElement)}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}addFontStyle(e){if(!e.data)throw new Error("addFontStyle: No font data available, ensure that the \"fontExtraProperties\" API parameter is set.");this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const t=u(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${e.loadedName}"; src: url(${t}); }\n`}setFont(e){const t=this.current,s=this.commonObjs.get(e[0]);let i=e[1];t.font=s,!this.embedFonts||s.missingFile||this.embeddedFonts[s.loadedName]||(this.addFontStyle(s),this.embeddedFonts[s.loadedName]=s),t.fontMatrix=s.fontMatrix||a.FONT_IDENTITY_MATRIX;let r="normal";s.black?r="900":s.bold&&(r="bold");const n=s.italic?"italic":"normal";i<0?(i=-i,t.fontDirection=-1):t.fontDirection=1,t.fontSize=i,t.fontFamily=s.loadedName,t.fontWeight=r,t.fontStyle=n,t.tspan=this.svgFactory.createElement("svg:tspan"),t.tspan.setAttributeNS(null,"y",m(-t.y)),t.xcoords=[],t.ycoords=[]}endText(){const e=this.current;e.textRenderingMode&a.TextRenderingMode.ADD_TO_PATH_FLAG&&e.txtElement?.hasChildNodes()&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(e){e>0&&(this.current.lineWidth=e)}setLineCap(e){this.current.lineCap=d[e]}setLineJoin(e){this.current.lineJoin=h[e]}setMiterLimit(e){this.current.miterLimit=e}setStrokeAlpha(e){this.current.strokeAlpha=e}setStrokeRGBColor(e,t,s){this.current.strokeColor=a.Util.makeHexColor(e,t,s)}setFillAlpha(e){this.current.fillAlpha=e}setFillRGBColor(e,t,s){this.current.fillColor=a.Util.makeHexColor(e,t,s),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(e){this.current.strokeColor=this._makeColorN_Pattern(e)}setFillColorN(e){this.current.fillColor=this._makeColorN_Pattern(e)}shadingFill(e){const t=this.viewport.width,s=this.viewport.height,i=a.Util.inverseTransform(this.transformMatrix),r=a.Util.applyTransform([0,0],i),n=a.Util.applyTransform([0,s],i),o=a.Util.applyTransform([t,0],i),l=a.Util.applyTransform([t,s],i),c=Math.min(r[0],n[0],o[0],l[0]),d=Math.min(r[1],n[1],o[1],l[1]),h=Math.max(r[0],n[0],o[0],l[0]),u=Math.max(r[1],n[1],o[1],l[1]),p=this.svgFactory.createElement("svg:rect");p.setAttributeNS(null,"x",c),p.setAttributeNS(null,"y",d),p.setAttributeNS(null,"width",h-c),p.setAttributeNS(null,"height",u-d),p.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this.current.fillAlpha<1&&p.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(p)}_makeColorN_Pattern(e){return"TilingPattern"===e[0]?this._makeTilingPattern(e):this._makeShadingPattern(e)}_makeTilingPattern(e){const t=e[1],s=e[2],i=e[3]||a.IDENTITY_MATRIX,[r,n,o,l]=e[4],c=e[5],d=e[6],h=e[7],u="shading"+y++,[p,g,f,m]=a.Util.normalizeRect([...a.Util.applyTransform([r,n],i),...a.Util.applyTransform([o,l],i)]),[_,v]=a.Util.singularValueDecompose2dScale(i),b=c*_,A=d*v,P=this.svgFactory.createElement("svg:pattern");P.setAttributeNS(null,"id",u),P.setAttributeNS(null,"patternUnits","userSpaceOnUse"),P.setAttributeNS(null,"width",b),P.setAttributeNS(null,"height",A),P.setAttributeNS(null,"x",`${p}`),P.setAttributeNS(null,"y",`${g}`);const S=this.svg,x=this.transformMatrix,F=this.current.fillColor,C=this.current.strokeColor,w=this.svgFactory.create(f-p,m-g);if(this.svg=w,this.transformMatrix=i,2===h){const e=a.Util.makeHexColor(...t);this.current.fillColor=e,this.current.strokeColor=e}return this.executeOpTree(this.convertOpList(s)),this.svg=S,this.transformMatrix=x,this.current.fillColor=F,this.current.strokeColor=C,P.append(w.childNodes[0]),this.defs.append(P),`url(#${u})`}_makeShadingPattern(e){switch("string"==typeof e&&(e=this.objs.get(e)),e[0]){case"RadialAxial":const t="shading"+y++,s=e[3];let i;switch(e[1]){case"axial":const s=e[4],a=e[5];i=this.svgFactory.createElement("svg:linearGradient"),i.setAttributeNS(null,"id",t),i.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),i.setAttributeNS(null,"x1",s[0]),i.setAttributeNS(null,"y1",s[1]),i.setAttributeNS(null,"x2",a[0]),i.setAttributeNS(null,"y2",a[1]);break;case"radial":const r=e[4],n=e[5],o=e[6],l=e[7];i=this.svgFactory.createElement("svg:radialGradient"),i.setAttributeNS(null,"id",t),i.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),i.setAttributeNS(null,"cx",n[0]),i.setAttributeNS(null,"cy",n[1]),i.setAttributeNS(null,"r",l),i.setAttributeNS(null,"fx",r[0]),i.setAttributeNS(null,"fy",r[1]),i.setAttributeNS(null,"fr",o);break;default:throw new Error(`Unknown RadialAxial type: ${e[1]}`)}for(const e of s){const t=this.svgFactory.createElement("svg:stop");t.setAttributeNS(null,"offset",e[0]),t.setAttributeNS(null,"stop-color",e[1]),i.append(t)}return this.defs.append(i),`url(#${t})`;case"Mesh":return(0,a.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${e[0]}`)}}setDash(e,t){this.current.dashArray=e,this.current.dashPhase=t}constructPath(e,t){const s=this.current;let i=s.x,r=s.y,n=[],o=0;for(const s of e)switch(0|s){case a.OPS.rectangle:i=t[o++],r=t[o++];const e=i+t[o++],s=r+t[o++];n.push("M",m(i),m(r),"L",m(e),m(r),"L",m(e),m(s),"L",m(i),m(s),"Z");break;case a.OPS.moveTo:i=t[o++],r=t[o++],n.push("M",m(i),m(r));break;case a.OPS.lineTo:i=t[o++],r=t[o++],n.push("L",m(i),m(r));break;case a.OPS.curveTo:i=t[o+4],r=t[o+5],n.push("C",m(t[o]),m(t[o+1]),m(t[o+2]),m(t[o+3]),m(i),m(r)),o+=6;break;case a.OPS.curveTo2:n.push("C",m(i),m(r),m(t[o]),m(t[o+1]),m(t[o+2]),m(t[o+3])),i=t[o+2],r=t[o+3],o+=4;break;case a.OPS.curveTo3:i=t[o+2],r=t[o+3],n.push("C",m(t[o]),m(t[o+1]),m(i),m(r),m(i),m(r)),o+=4;break;case a.OPS.closePath:n.push("Z")}n=n.join(" "),s.path&&e.length>0&&e[0]!==a.OPS.rectangle&&e[0]!==a.OPS.moveTo?n=s.path.getAttributeNS(null,"d")+n:(s.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(s.path)),s.path.setAttributeNS(null,"d",n),s.path.setAttributeNS(null,"fill","none"),s.element=s.path,s.setCurrentPoint(i,r)}endPath(){const e=this.current;if(e.path=null,!this.pendingClip)return;if(!e.element)return void(this.pendingClip=null);const t="clippath"+v++,s=this.svgFactory.createElement("svg:clipPath");s.setAttributeNS(null,"id",t),s.setAttributeNS(null,"transform",_(this.transformMatrix));const i=e.element.cloneNode(!0);if("evenodd"===this.pendingClip?i.setAttributeNS(null,"clip-rule","evenodd"):i.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,s.append(i),this.defs.append(s),e.activeClipUrl){e.clipGroup=null;for(const e of this.extraStack)e.clipGroup=null;s.setAttributeNS(null,"clip-path",e.activeClipUrl)}e.activeClipUrl=`url(#${t})`,this.tgrp=null}clip(e){this.pendingClip=e}closePath(){const e=this.current;if(e.path){const t=`${e.path.getAttributeNS(null,"d")}Z`;e.path.setAttributeNS(null,"d",t)}}setLeading(e){this.current.leading=-e}setTextRise(e){this.current.textRise=e}setTextRenderingMode(e){this.current.textRenderingMode=e}setHScale(e){this.current.textHScale=e/100}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,s]of e)switch(t){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s);break;case"CA":this.setStrokeAlpha(s);break;case"ca":this.setFillAlpha(s);break;default:(0,a.warn)(`Unimplemented graphic state operator ${t}`)}}fill(){const e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}stroke(){const e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(e,t=1){const s=this.current;let i=s.dashArray;1!==t&&i.length>0&&(i=i.map(function(e){return t*e})),e.setAttributeNS(null,"stroke",s.strokeColor),e.setAttributeNS(null,"stroke-opacity",s.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",m(s.miterLimit)),e.setAttributeNS(null,"stroke-linecap",s.lineCap),e.setAttributeNS(null,"stroke-linejoin",s.lineJoin),e.setAttributeNS(null,"stroke-width",m(t*s.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",i.map(m).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",m(t*s.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(e)}paintImageXObject(e){const t=e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e);t?this.paintInlineImageXObject(t):(0,a.warn)(`Dependent image with object ID ${e} is not ready yet`)}paintInlineImageXObject(e,t){const s=e.width,i=e.height,a=p(e,this.forceDataSchema,!!t),r=this.svgFactory.createElement("svg:rect");r.setAttributeNS(null,"x","0"),r.setAttributeNS(null,"y","0"),r.setAttributeNS(null,"width",m(s)),r.setAttributeNS(null,"height",m(i)),this.current.element=r,this.clip("nonzero");const n=this.svgFactory.createElement("svg:image");n.setAttributeNS(c,"xlink:href",a),n.setAttributeNS(null,"x","0"),n.setAttributeNS(null,"y",m(-i)),n.setAttributeNS(null,"width",m(s)+"px"),n.setAttributeNS(null,"height",m(i)+"px"),n.setAttributeNS(null,"transform",`scale(${m(1/s)} ${m(-1/i)})`),t?t.append(n):this._ensureTransformGroup().append(n)}paintImageMaskXObject(e){const t=this.current,s=e.width,i=e.height,a=t.fillColor;t.maskId="mask"+b++;const r=this.svgFactory.createElement("svg:mask");r.setAttributeNS(null,"id",t.maskId);const n=this.svgFactory.createElement("svg:rect");n.setAttributeNS(null,"x","0"),n.setAttributeNS(null,"y","0"),n.setAttributeNS(null,"width",m(s)),n.setAttributeNS(null,"height",m(i)),n.setAttributeNS(null,"fill",a),n.setAttributeNS(null,"mask",`url(#${t.maskId})`),this.defs.append(r),this._ensureTransformGroup().append(n),this.paintInlineImageXObject(e,r)}paintFormXObjectBegin(e,t){if(Array.isArray(e)&&6===e.length&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t){const e=t[2]-t[0],s=t[3]-t[1],i=this.svgFactory.createElement("svg:rect");i.setAttributeNS(null,"x",t[0]),i.setAttributeNS(null,"y",t[1]),i.setAttributeNS(null,"width",m(e)),i.setAttributeNS(null,"height",m(s)),this.current.element=i,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(e){const t=this.svgFactory.create(e.width,e.height),s=this.svgFactory.createElement("svg:defs");t.append(s),this.defs=s;const i=this.svgFactory.createElement("svg:g");return i.setAttributeNS(null,"transform",_(e.transform)),t.append(i),this.svg=i,t}_ensureClipGroup(){if(!this.current.clipGroup){const e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(e),this.current.clipGroup=e}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",_(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var i=s(1),a=s(33);const r=require(_dependencyMap[2]),n=require(_dependencyMap[5]),o=require(_dependencyMap[6]),l=require(_dependencyMap[7]),c=/^file:\/\/\/[a-zA-Z]:\//;function d(e){const t=l.parse(e);return"file:"===t.protocol||t.host?t:/^[a-z]:[/\\]/i.test(e)?l.parse(`file:///${e}`):(t.host||(t.protocol="file:"),t)}t.PDFNodeStream=class{constructor(e){this.source=e,this.url=d(e.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new m(this):new g(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=this.isFsUrl?new _(this,e,t):new f(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader&&this._fullRequestReader.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}};class h{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=(0,i.createPromiseCapability)(),this._headersCapability=(0,i.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return null===e?(this._readCapability=(0,i.createPromiseCapability)(),this.read()):(this._loaded+=e.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new i.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class u{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,i.createPromiseCapability)();const t=e.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return null===e?(this._readCapability=(0,i.createPromiseCapability)(),this.read()):(this._loaded+=e.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function p(e,t){return{protocol:e.protocol,auth:e.auth,host:e.hostname,port:e.port,path:e.path,method:"GET",headers:t}}class g extends h{constructor(e){super(e);const t=t=>{if(404===t.statusCode){const e=new i.MissingPDFException(`Missing PDF "${this._url}".`);return this._storedError=e,void this._headersCapability.reject(e)}this._headersCapability.resolve(),this._setReadableStream(t);const s=e=>this._readableStream.headers[e.toLowerCase()],{allowRangeRequests:r,suggestedLength:n}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:s,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=r,this._contentLength=n||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(s)};this._request=null,"http:"===this._url.protocol?this._request=n.request(p(this._url,e.httpHeaders),t):this._request=o.request(p(this._url,e.httpHeaders),t),this._request.on("error",e=>{this._storedError=e,this._headersCapability.reject(e)}),this._request.end()}}class f extends u{constructor(e,t,s){super(e),this._httpHeaders={};for(const t in e.httpHeaders){const s=e.httpHeaders[t];void 0!==s&&(this._httpHeaders[t]=s)}this._httpHeaders.Range=`bytes=${t}-${s-1}`;const a=e=>{if(404===e.statusCode){const e=new i.MissingPDFException(`Missing PDF "${this._url}".`);return void(this._storedError=e)}this._setReadableStream(e)};this._request=null,"http:"===this._url.protocol?this._request=n.request(p(this._url,this._httpHeaders),a):this._request=o.request(p(this._url,this._httpHeaders),a),this._request.on("error",e=>{this._storedError=e}),this._request.end()}}class m extends h{constructor(e){super(e);let t=decodeURIComponent(this._url.path);c.test(this._url.href)&&(t=t.replace(/^\//,"")),r.lstat(t,(e,s)=>{if(e)return"ENOENT"===e.code&&(e=new i.MissingPDFException(`Missing PDF "${t}".`)),this._storedError=e,void this._headersCapability.reject(e);this._contentLength=s.size,this._setReadableStream(r.createReadStream(t)),this._headersCapability.resolve()})}}class _ extends u{constructor(e,t,s){super(e);let i=decodeURIComponent(this._url.path);c.test(this._url.href)&&(i=i.replace(/^\//,"")),this._setReadableStream(r.createReadStream(i,{start:t,end:s-1}))}}},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=function(e,t){return 404===e||0===e&&t.startsWith("file:")?new i.MissingPDFException('Missing PDF "'+t+'".'):new i.UnexpectedResponseException(`Unexpected server response (${e}) while retrieving PDF "${t}".`,e)},t.extractFilenameFromHeader=function(e){const t=e("Content-Disposition");if(t){let e=(0,a.getFilenameFromContentDispositionHeader)(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch(e){}if((0,r.isPdfFile)(e))return e}return null},t.validateRangeRequestCapabilities=function({getResponseHeader:e,isHttp:t,rangeChunkSize:s,disableRange:i}){const a={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(e("Content-Length"),10);return Number.isInteger(r)?(a.suggestedLength=r,r<=2*s||i||!t||"bytes"!==e("Accept-Ranges")||"identity"!==(e("Content-Encoding")||"identity")||(a.allowRangeRequests=!0),a):a},t.validateResponseStatus=function(e){return 200===e||206===e};var i=s(1),a=s(34),r=s(8)},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=function(e){let t=!0,s=a("filename\\*","i").exec(e);if(s){s=s[1];let e=o(s);return e=unescape(e),e=l(e),e=c(e),n(e)}if(s=(function(e){const t=[];let s;const i=a("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(s=i.exec(e));){let[,e,i,a]=s;if(e=parseInt(e,10),e in t){if(0===e)break}else t[e]=[i,a]}const r=[];for(let e=0;e<t.length&&e in t;++e){let[s,i]=t[e];i=o(i),s&&(i=unescape(i),0===e&&(i=l(i))),r.push(i)}return r.join("")})(e),s)return n(c(s));if(s=a("filename","i").exec(e),s){s=s[1];let e=o(s);return e=c(e),n(e)}function a(e,t){return new RegExp("(?:^|;)\\s*"+e+"\\s*=\\s*([^\";\\s][^;\\s]*|\"(?:[^\"\\\\]|\\\\\"?)+\"?)",t)}function r(e,s){if(e){if(!/^[\x00-\xFF]+$/.test(s))return s;try{const a=new TextDecoder(e,{fatal:!0}),r=(0,i.stringToBytes)(s);s=a.decode(r),t=!1}catch(e){}}return s}function n(e){return t&&/[\x80-\xff]/.test(e)&&(e=r("utf-8",e),t&&(e=r("iso-8859-1",e))),e}function o(e){if(e.startsWith('"')){const t=e.slice(1).split('\\"');for(let e=0;e<t.length;++e){const s=t[e].indexOf('"');-1!==s&&(t[e]=t[e].slice(0,s),t.length=e+1),t[e]=t[e].replace(/\\(.)/g,"$1")}e=t.join('"')}return e}function l(e){const t=e.indexOf("'");return-1===t?e:r(e.slice(0,t),e.slice(t+1).replace(/^[^']*'/,""))}function c(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(e,t,s,i){if("q"===s||"Q"===s)return r(t,i=(i=i.replace(/_/g," ")).replace(/=([0-9a-fA-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))}));try{i=atob(i)}catch(e){}return r(t,i)})}return""};var i=s(1)},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=void 0;var i=s(1),a=s(33);function r(e){const t=e.response;return"string"!=typeof t?t:(0,i.stringToBytes)(t).buffer}class n{constructor(e,t={}){this.url=e,this.isHttp=/^https?:/i.test(e),this.httpHeaders=this.isHttp&&t.httpHeaders||Object.create(null),this.withCredentials=t.withCredentials||!1,this.getXhr=t.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,s){const i={begin:e,end:t};for(const e in s)i[e]=s[e];return this.request(i)}requestFull(e){return this.request(e)}request(e){const t=this.getXhr(),s=this.currXhrId++,i=this.pendingRequests[s]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const e in this.httpHeaders){const s=this.httpHeaders[e];void 0!==s&&t.setRequestHeader(e,s)}return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=206):i.expectedStatus=200,t.responseType="arraybuffer",e.onError&&(t.onerror=function(s){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,s),t.onprogress=this.onProgress.bind(this,s),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),s}onProgress(e,t){const s=this.pendingRequests[e];s&&s.onProgress?.(t)}onStateChange(e,t){const s=this.pendingRequests[e];if(!s)return;const i=s.xhr;if(i.readyState>=2&&s.onHeadersReceived&&(s.onHeadersReceived(),delete s.onHeadersReceived),4!==i.readyState)return;if(!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],0===i.status&&this.isHttp)return void s.onError?.(i.status);const a=i.status||200;if((200!==a||206!==s.expectedStatus)&&a!==s.expectedStatus)return void s.onError?.(i.status);const n=r(i);if(206===a){const e=i.getResponseHeader("Content-Range"),t=/bytes (\d+)-(\d+)\/(\d+)/.exec(e);s.onDone({begin:parseInt(t[1],10),chunk:n})}else n?s.onDone({begin:0,chunk:n}):s.onError?.(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}t.PDFNetworkStream=class{constructor(e){this._source=e,this._manager=new n(e.url,{httpHeaders:e.httpHeaders,withCredentials:e.withCredentials}),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new o(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const s=new l(this._manager,e,t);return s.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}};class o{constructor(e,t){this._manager=e;const s={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(s),this._headersReceivedCapability=(0,i.createPromiseCapability)(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e),s=e=>t.getResponseHeader(e),{allowRangeRequests:i,suggestedLength:r}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=r||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersReceivedCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=(0,a.createResponseStatusError)(e,this._url),this._headersReceivedCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=(0,i.createPromiseCapability)();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersReceivedCapability.reject(e);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class l{constructor(e,t,s){this._manager=e;const i={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=e.url,this._requestId=e.requestRange(t,s,i),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError=(0,a.createResponseStatusError)(e,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(null!==this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=(0,i.createPromiseCapability)();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(e,t,s)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var i=s(1),a=s(33);function r(e,t,s){return{method:"GET",headers:e,signal:s.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function n(e){const t=new Headers;for(const s in e){const i=e[s];void 0!==i&&t.append(s,i)}return t}t.PDFFetchStream=class{constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new o(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const s=new l(this,e,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(e){this._fullRequestReader&&this._fullRequestReader.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}};class o{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=(0,i.createPromiseCapability)(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._headers=n(this._stream.httpHeaders);const s=t.url;fetch(s,r(this._headers,this._withCredentials,this._abortController)).then(e=>{if(!(0,a.validateResponseStatus)(e.status))throw(0,a.createResponseStatusError)(e.status,s);this._reader=e.body.getReader(),this._headersCapability.resolve();const t=t=>e.headers.get(t),{allowRangeRequests:r,suggestedLength:n}=(0,a.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=r,this._contentLength=n||this._contentLength,this._filename=(0,a.extractFilenameFromHeader)(t),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new i.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){this._reader&&this._reader.cancel(e),this._abortController.abort()}}class l{constructor(e,t,s){this._stream=e,this._reader=null,this._loaded=0;const o=e.source;this._withCredentials=o.withCredentials||!1,this._readCapability=(0,i.createPromiseCapability)(),this._isStreamingSupported=!o.disableStream,this._abortController=new AbortController,this._headers=n(this._stream.httpHeaders),this._headers.append("Range",`bytes=${t}-${s-1}`);const l=o.url;fetch(l,r(this._headers,this._withCredentials,this._abortController)).then(e=>{if(!(0,a.validateResponseStatus)(e.status))throw(0,a.createResponseStatusError)(e.status,l);this._readCapability.resolve(),this._reader=e.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){this._reader&&this._reader.cancel(e),this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var s=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](s,s.exports,__w_pdfjs_require__),s.exports}var __webpack_exports__={};return(()=>{var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AnnotationEditorLayer",{enumerable:!0,get:function(){return a.AnnotationEditorLayer}}),Object.defineProperty(e,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return t.AnnotationEditorParamsType}}),Object.defineProperty(e,"AnnotationEditorType",{enumerable:!0,get:function(){return t.AnnotationEditorType}}),Object.defineProperty(e,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return r.AnnotationEditorUIManager}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return n.AnnotationLayer}}),Object.defineProperty(e,"AnnotationMode",{enumerable:!0,get:function(){return t.AnnotationMode}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return t.CMapCompressionType}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return o.GlobalWorkerOptions}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return t.InvalidPDFException}}),Object.defineProperty(e,"LoopbackPort",{enumerable:!0,get:function(){return s.LoopbackPort}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return t.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return t.OPS}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return s.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return i.PDFDateString}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return s.PDFWorker}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return t.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return t.PermissionFlag}}),Object.defineProperty(e,"PixelsPerInch",{enumerable:!0,get:function(){return i.PixelsPerInch}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return i.RenderingCancelledException}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return d.SVGGraphics}}),Object.defineProperty(e,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return t.UNSUPPORTED_FEATURES}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return t.UnexpectedResponseException}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return t.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return t.VerbosityLevel}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return h.XfaLayer}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return s.build}}),Object.defineProperty(e,"createPromiseCapability",{enumerable:!0,get:function(){return t.createPromiseCapability}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return t.createValidAbsoluteUrl}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return s.getDocument}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return i.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return i.getPdfFilenameFromUrl}}),Object.defineProperty(e,"getXfaPageViewport",{enumerable:!0,get:function(){return i.getXfaPageViewport}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return i.isPdfFile}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return i.loadScript}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return c.renderTextLayer}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return t.shadow}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return s.version}});var t=__w_pdfjs_require__(1),s=__w_pdfjs_require__(4),i=__w_pdfjs_require__(8),a=__w_pdfjs_require__(22),r=__w_pdfjs_require__(7),n=__w_pdfjs_require__(27),o=__w_pdfjs_require__(15),l=__w_pdfjs_require__(3),c=__w_pdfjs_require__(30),d=__w_pdfjs_require__(31),h=__w_pdfjs_require__(29);if(l.isNodeJS){const{PDFNodeStream:e}=__w_pdfjs_require__(32);(0,s.setPDFNetworkStreamFactory)(t=>new e(t))}else{const{PDFNetworkStream:e}=__w_pdfjs_require__(35),{PDFFetchStream:t}=__w_pdfjs_require__(36);(0,s.setPDFNetworkStreamFactory)(s=>(0,i.isValidFetchUrl)(s.url)?new t(s):new e(s))}})(),__webpack_exports__})(),'object'==typeof exports&&'object'==typeof module?module.exports=factory():'function'==typeof define&&define.amd?define("pdfjs-dist/build/pdf",[],factory):'object'==typeof exports?exports["pdfjs-dist/build/pdf"]=factory():root["pdfjs-dist/build/pdf"]=root.pdfjsLib=factory()},3049,[3219,3220,3221,3221,3221,3221,3221,3221]);
__d(function(g,r,i,a,m,_e,d){m.exports=function(e,t){if(!{}.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e},m.exports.__esModule=!0,m.exports.default=m.exports},3219,[]);
__d(function(g,r,i,a,m,_e,d){var e=0;m.exports=function(t){return"__private_"+e+++"_"+t},m.exports.__esModule=!0,m.exports.default=m.exports},3220,[]);
__d(function(g,r,i,a,m,e,d){},3221,[]);